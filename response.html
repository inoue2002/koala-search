<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- WebOPACシステムパスをパラメタから取得 -->
<html lang="ja">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Cache-Control" content="no-cache">
		<meta http-equiv="Expires" content="Thu, 01 Dec 1994 16:00:00 GMT">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<title>WebOPAC Local書誌詳細</title>
		
		<link rel="stylesheet" href='/webopac/css/style_blue.css' type="text/css">
		<link rel="stylesheet" href='/webopac/css/print.css' type="text/css" media="print">
		<link rel="stylesheet" href='/webopac/css/opac_responsive_ufi.css' type="text/css">
		<script src="/webopac/jsp/script/opac_popup_common.js"></script>
		<script src="/webopac/jsp/script/opac_responsive.js"></script>
	</head>
	<body class="body">
		




























<link rel="stylesheet" type="text/css" href="https://www.lib.kansai-u.ac.jp/webopac/css/jquery-ui.min.css" />
<script type="text/javascript" src="https://www.lib.kansai-u.ac.jp/webopac/jsp/script/jquery-3.5.1.min.js">;</script>
<script type="text/javascript" src="https://www.lib.kansai-u.ac.jp/webopac/jsp/script/jquery_cookie.js">;</script>
<script type="text/javascript" src="https://www.lib.kansai-u.ac.jp/webopac/jsp/script/jquery-ui.min.js" >;</script>




	<script class="nc_script" type="text/javascript">
	//<!--
	if("jQuery" in window){
		jQuery(document).ready(
			function($){
				// ここでは、$はjQueryとして使えます。
				jQuery(function() {
					//テキストフィールドで、name="words"に対して、サジェストを設定。
					jQuery("*[name=words]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					//テキストフィールドで、name="valclm1～valclm4"に対して、サジェストを設定。
					jQuery("*[name=valclm1]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					jQuery("*[name=valclm2]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					jQuery("*[name=valclm3]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					jQuery("*[name=valclm4]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					//横断検索用サジェスト設定（keywd,title,auth,pub）
					jQuery("*[name=keywd]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					jQuery("*[name=title]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					jQuery("*[name=auth]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
					jQuery("*[name=pub]:text").autocomplete({
						minLength:2,
						source: function(req, resp){
							jQuery.ajax({
								url: "https://www.lib.kansai-u.ac.jp/webopac/suggest_words.do?target=words&q="+encodeURI(this.term)+"&jquery_var_351="+$.fn.jquery,
								type: "get",
								cache: false
							})
							.done(function(data) {
								if(data){
									resp(data.split(/[\n]/));
								}else{
									resp(data);
								}
							})
						}
					});
				});
			}
		);
	}
	//-->
	</script>


<template id="popupDialogTmpl">
	<div style="width: 100vw; height: 100vh;
				background: rgba(204,204,204,.2);
				position: absolute; top: 0px; left: 0px; z-index: 9000;">
		<table id="popupDialog" class="opac_popup" style="margin-left: auto; margin-right: auto;">
			<tr><td style="padding:20px;">
				<div id="popupDialogContents" style="overflow-y: auto; max-height: 280px;"></div>
			</td></tr>
		</table>
	</div>
</template>
<template id="popupDialogTmplmap">
	<div style="width: 100vw; height: 100vh;
				background: rgba(204,204,204,.2);
				position: absolute; top: 0px; left: 0px; z-index: 9000;">
		<table id="popupDialog" class="opac_popup" style="margin-left: auto; margin-right: auto;">
			<tr><td style="padding:20px;">
				<div id="popupDialogContents"></div>
			</td></tr>
		</table>
	</div>
</template>
<template id="loadingTmpl">
	<div id="loadingArea" style="width: 100vw; height: 100vh;
		position: absolute; top: 0px; left: 0px; z-index: 9999;">
		<div id="loadingImgWrapper" style="position: relative; text-align: center;">
			<img text="loading" alt="loading" src="https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif"/ style="margin-left: auto; margin-right: auto;">
		</div>
	</div>
</template>
<div id="popupDialogArea"></div>

<script type="text/javascript">
	
	function sendPopupView(event, params, popupParams, showCloseLink) {
		$.ajax({
			type: "POST",
			url: popupParams.request_url,
			dataType: "html",
			data: params,
			cache: false,
			beforeSend: function () {
				closePopupDialog();
				showPopupLoading();
			}
		}).done(function (data, textStatus, jqXHR) {
			if (jqXHR.status === 200) {
				showResultsToPopup(data, showCloseLink)
			} else {
				showErrors(jqXHR.status, textStatus);
			}
		}).fail(function (jqXHR, textStatus, errorThrown) {
			showErrors(jqXHR.status, errorThrown);
		}).always(function (jqXHR, textStatus) {
			hidePopupLoading();
		});
	}

	function closePopupDialog() {
		$('#popupDialogArea').empty();
	}

	function showResultsToPopup(data, showCloseLink) {
		let popupDialogTmplClone = $($('#popupDialogTmpl').html());
		popupDialogTmplClone.height($(document).height());
		popupDialogTmplClone.width($(document).width());
		// 閉じるリンクがある場合
		if(typeof(data) == "string" && data.indexOf("opac_garnish_link_area") != -1){
			let closeLink = $(data).find('.opac_garnish_link_area');
			// 閉じるリンクの場所変更
			$('#popupDialog', popupDialogTmplClone).append(closeLink);
			// データ元から閉じるリンク削除
			data = data.replace(closeLink[0].outerHTML,"");
		}
		$('#popupDialogContents', popupDialogTmplClone).append(data);
		
		if(showCloseLink){
			let closeElm = document.createElement('div');
			closeElm.className = "opac_garnish_link_area";
			closeElm.innerHTML = '<a href="#" onclick="PopUpClose();return false;" class="close_link">'
				+'このウインドウを閉じる</a>';
			$('#popupDialog', popupDialogTmplClone).append(closeElm);;
		}
		if ($('header', popupDialogTmplClone).length) {
			$('header', popupDialogTmplClone).hide();
		}
		if ($('footer', popupDialogTmplClone).length) {
			$('footer', popupDialogTmplClone).hide();
		}
		$('#popupDialogArea').append(popupDialogTmplClone);

		let clientHeight = document.body.clientHeight;
		let elementHeight = $('#popupDialog').outerHeight();
		let marginHeight = clientHeight - elementHeight;
		let scrollTop = $(window).scrollTop();
		if (marginHeight > 0) {
			$('#popupDialog').css("margin-top", (marginHeight / 2) + scrollTop);
		}
	}

	function showErrors(status, message) {
		alert("Error:" + status + ":" + message);
	}

	function showPopupLoading() {
		let loadingArea = $($('#loadingTmpl').html());
		loadingArea.height($(document).height());
		loadingArea.width($(document).width());
		$('#popupDialogArea').append(loadingArea);

		let clientHeight = document.body.clientHeight;
		let elementHeight = $('#loadingImgWrapper').outerHeight();
		let marginHeight = clientHeight - elementHeight;
		let scrollTop = $(window).scrollTop();
		if (marginHeight > 0) {
			$('#loadingImgWrapper').css("margin-top", (marginHeight / 2) + scrollTop);
		}
    }

    function hidePopupLoading() {
		$('#popupDialogArea').find('#loadingArea').remove();
    }

	function chkScriptErrorLocalSre(){
		// 簡易検索時(Local・Elib)にJavascriptが展開されていることのチェックを実施
		// １つでもの展開されていなかった場合はメッセージを表示して処理を中断する
		var msg = "現在処理が混みあっているため、検索を一時的に中断いたしました。恐れ入りますが、時間をおいて再度ご利用ください。";
		if(typeof opacSreReset !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof clearSearchPage !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof sendOpacSearch !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof convertSimple2Detail !== "function"){
			window.alert(msg);
			return false;
		}
		return true;
	}
	
	function chkScriptErrorLocalSrd(){
		// 詳細検索時(Local・Elib)にJavascriptが展開されていることのチェックを実施
		// １つでもの展開されていなかった場合はメッセージを表示して処理を中断する
		var msg = "現在処理が混みあっているため、検索を一時的に中断いたしました。恐れ入りますが、時間をおいて再度ご利用ください。";
		if(typeof opacSrdReset !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof clearSearchPage !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof sendOpacSearch !== "function"){
			window.alert(msg);
			return false;
		}
		return true;
	}
	
	function chkScriptErrorNiiSre(){
		// 簡易検索時(NII)にJavascriptが展開されていることのチェックを実施
		// １つでもの展開されていなかった場合はメッセージを表示して処理を中断する
		var msg = "現在処理が混みあっているため、検索を一時的に中断いたしました。恐れ入りますが、時間をおいて再度ご利用ください。";
		if(typeof niiSreReset !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof clearSearchPage !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof sendNiiSearch !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof convertSimple2Detail !== "function"){
			window.alert(msg);
			return false;
		}
		return true;
	}
	

	function chkScriptErrorNiiSrd(){
		// 詳細検索時(NII)にJavascriptが展開されていることのチェックを実施
		// １つでもの展開されていなかった場合はメッセージを表示して処理を中断する
		var msg = "現在処理が混みあっているため、検索を一時的に中断いたしました。恐れ入りますが、時間をおいて再度ご利用ください。";
		if(typeof niiSrdReset !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof clearSearchPage !== "function"){
			window.alert(msg);
			return false;
		}
		if(typeof sendNiiSearch !== "function"){
			window.alert(msg);
			return false;
		}
		return true;
	}
	  
	function opacCheckAll(form_id,name){
		var form = document.getElementById(form_id);
		// 自動絞込み機能が有効/無効で処理分岐
		// 自動絞込みが有効の場合
		
		// 通常動作
		
			form[name+"_flag"].checked = true;
		
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				form[name][i].checked = false;
			}
		}else{
			form[name].checked = false;
		}
	}
	
	function opacCheckEach(form_id,name){
		var form = document.getElementById(form_id);
		var cnt = 0;
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				if(form[name][i].checked){
					cnt++;
				}
			}
		}else{
			if(form[name].checked){
				cnt++;
			}
		}
		if(cnt > 0){
			form[name+"_flag"].checked = false;
		}else{
			// 自動絞込み機能が有効/無効で処理分岐
			// 自動絞込みが有効の場合
			
			// 通常動作
			
				form[name+"_flag"].checked = true;
			
		}
	}
	
	function opacCampusOpen(id){
		document.getElementById("opac_campus_open_button"+id).style.display = 'none';
		document.getElementById("opac_campus_close_button"+id).style.display = 'block';
		document.getElementById("opac_campus_table"+id).style.display = 'block';
	}
	
	function opacCampusClose(id){
		document.getElementById("opac_campus_open_button"+id).style.display = 'block';
		document.getElementById("opac_campus_close_button"+id).style.display = 'none';
		document.getElementById("opac_campus_table"+id).style.display = 'none';
	}
	
	function opacCampusCheckAll(form_id){
		var form = document.getElementById(form_id);
		
			form["holar_flag"].checked = true;
		
		var name = "holar";
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				form[name][i].checked = false;
			}
		}else{
			form[name].checked = false;
		}
		var name = "campus";
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				form[name][i].checked = false;
			}
		}else{
			form[name].checked = false;
		}
	}
	
	function opacCampusCheck(this_campus,id,form_id){
		if(this_campus.checked == true){
			var boxs = document.getElementById(id).getElementsByTagName('input');
			for(var i = 0; i < boxs.length; i++) {
				boxs[i].checked = false;
			}
		}
		
		var form = document.getElementById(form_id);
		var cnt = 0;
		var cntMax = 1;
		var name = "campus";
		if(form[name].length){
			cntMax = form[name].length;
			for(var i = 0; i < form[name].length; i++){
				if(form[name][i].checked){
					cnt++;
				}
			}
		}else{
			if(form[name].checked){
				cnt++;
			}
		}
		if(cnt == 0){
			opacCheckEach(form_id,'holar');
		}else{
			form["holar_flag"].checked = false;
		}
	}
	
	function opacCampusCheckEach(target_campus,id,form_id){
		var cnt = 0;
		var boxs = document.getElementById(id).getElementsByTagName('input');
		for(var i = 0; i < boxs.length; i++) {
			if(boxs[i].checked){
				cnt++;
			}
		}
		if(cnt == 0){
			opacCampusCheck(document.getElementById(target_campus),id,form_id)
		}else{
			var form = document.getElementById(form_id);
			form["holar_flag"].checked = false;
			document.getElementById(target_campus).checked = false;
		}
	}
	
	function opacSreReset(form_el,dsp_name){
		
			form_el.sortkey.value = "";
			form_el.sorttype.value = "";
			form_el.listcnt.value = "";
			form_el.startpos.value = "";
			form_el.fromDsp.value = dsp_name;
			form_el.searchDsp.value = dsp_name;
			form_el.initFlg.value = "_RESULT_SET";
			form_el.hitcnt.value = "";
			form_el.searchsql.value = "";
			if(form_el.combsearch != null){
				form_el.combsearch.value = "";
			}
			form_el.searchhis.value = "";
			
			form_el.fct_gcattp.value = "";
			form_el.fct_auth.value = "";
			form_el.fct_pub.value = "";
			form_el.fct_year.value = "";
			form_el.fct_cls.value = "";
			form_el.fct_sh.value = "";
			form_el.fct_lang.value = "";
			// 自動絞込み機能が有効の場合、初回検索フラグを設定
			
			
				form_el.fct_holar.value = "";
				form_el.fct_campus.value = "";
			
			form_el.fct_tag.value = "";
			form_el.fct_range_year.value = "";
			form_el.fct_stamp.value = "";
			form_el.fct_holstat.value = "";
			form_el.fct_target_name.value = "";
		
	}
	
	function opacSrdReset(form_el,dsp_name){
		// 「全て」フラグ
		var allflg = false;
		// キャンパスフラグ
		var camflg = false;
		// 所蔵館フラグ
		var holflg = false;
		// ファセットフラグ
		var facetflg = false;
		
		// holar_flag情報を取得
		var chkHolflg = document.getElementsByName("holar_flag");
		// チェックが付与されているかチェック
		// holar_flag情報をループしてチェック
		for(var i = 0; i < chkHolflg.length; i++){
			if(chkHolflg[i].checked == false){
				allflg = false;
			}else{
				// 1つでもチェックがあるとその時点でブレイク
				allflg = true;
				break;
			}
		}
		// ファセットの「全て」にチェックが入っていない場合
		// holar, campus情報をチェックする
		if(!allflg){
			// キャンパス利用していない場合
			
				var chkHol = document.getElementsByName("holar");
				for(var i = 0; i < chkHol.length; i++){
					if(chkHol[i].checked == false){
						holflg = false;
					}else{
						// 1つでもチェックがあるとその時点でブレイク
						holflg = true;
						break;
					}
				}
			
			// キャンパス利用している場合
			
		}
		// allflg,camflg,holflgのいずれかがtrueの場合、
		// 所蔵館にチェックが入っているとみなし、通常処理ロジックへ入る判定を行う。
		if(allflg){
			facetflg = true;
		}else{
			if(camflg || holflg){
				facetflg = true;
			}
		}
		
		// 検索ページTOP画面より検索する場合
		
		// 検索ページTOP画面より検索しない場合
		
			form_el.startpos.value = "";
			form_el.fromDsp.value = dsp_name;
			form_el.searchDsp.value = dsp_name;
			form_el.initFlg.value = "_RESULT_SET";
			form_el.hitcnt.value = "";
			
			form_el.fct_gcattp.value = "";
			form_el.fct_auth.value = "";
			form_el.fct_pub.value = "";
			form_el.fct_year.value = "";
			form_el.fct_cls.value = "";
			form_el.fct_sh.value = "";
			form_el.fct_lang.value = "";
			form_el.fct_target_name.value = "";
			// 所蔵館にチェックが入っているか判定
			if(facetflg){
				form_el.fct_holar.value = "";
				form_el.fct_campus.value = "";
			}else{
				// 自動絞込み機能が有効の場合、初回検索フラグを設定
				
				
					form_el.fct_holar.value = "";
					form_el.fct_campus.value = "";
				
			}
			form_el.fct_tag.value = "";
			form_el.fct_range_year.value = "";
			form_el.fct_stamp.value = "";
			form_el.fct_holstat.value = "";
		
	}
	
	function niiSreReset(form_el){
		
			form_el.sortkey.value = "";
			form_el.sorttype.value = "";
			form_el.listcnt.value = "";
			form_el.startpos.value = "";
			form_el.fromDsp.value = "catsre";
			form_el.searchDsp.value = "catsre";
			form_el.initFlg.value = "_RESULT_SET";
			form_el.hitcnt.value = "";
			form_el.searchsql.value = "";
			form_el.searchhis.value = "";
		
	}
	
	function niiSrdReset(form_el){
		
			form_el.startpos.value = "";
			form_el.fromDsp.value = "catsrd";
			form_el.searchDsp.value = "catsrd";
			form_el.initFlg.value = "_RESULT_SET";
			form_el.hitcnt.value = "";
		
	}
	
	function opacSelectHollc(form_id,hollc_id){
		var form = document.getElementById(form_id);
		var form_select = form.hollc;
		form_select.innerHTML = '';
		// 分岐フラグ
		var vFlg = true;
		// holar情報を取得
		var getHolar = form.holar;
		if(form["holar_flag"].checked){
			form_select.options[0] = new Option("所蔵館を選択してください", "");
		}
		else if(!form["holar_flag"].checked){
			// holar情報をループしてチェック
			for(var i = 0; i < getHolar.length; i++){
				if(getHolar[i].checked == false){
					vFlg = false;
				}else{
					// 1つでもチェックがあるとその時点でブレイク
					vFlg = true;
					break;
				}
			}
			// チェックフラグを判断
			if(!vFlg){
				// 館にチェックが入っていない場合
				form_select.options[0] = new Option("所蔵館を選択してください", "");
			}else{
				// 館チェックが実施されている場合
				form_select.options[0] = new Option("", "");
				var select = document.getElementById(hollc_id);
				
				var options = select.getElementsByTagName('option');
				
				var target_holar = new Array();
				
				var holar = form["holar"];
				if(holar.length){
					for(var i = 0; i < holar.length; i++) {
						if(holar[i].checked){
							target_holar.push(holar[i].value);
						}
					}
				}else{
					target_holar.push(holar.value);
				}
				
				var pattern = new RegExp("/.*");
				for(var i = 0; i < options.length; i++) {
					var opt_value = options[i].value;
					if(opt_value != ""){
						var opt_holar = opt_value.replace(pattern,"");
						if(target_holar.indexOf(opt_holar) != -1){
							form_select.appendChild(options[i].cloneNode(true));
						}
					}
				}
			}
		}
	}
	
	function opacSelectHollcCampus(form_id,hollc_id,tab_num){
		var form = document.getElementById(form_id);
		var form_select = form.hollc;
		form_select.innerHTML = '';
		if(form["holar_flag"].checked){
			form_select.appendChild(new Option("所蔵館を選択してください", ""));
		}else if(!form["holar_flag"].checked){
			// 分岐フラグ
			var vFlg = true;
			// holar情報を取得
			var getHolar = form.holar;
			// campus情報を取得
			var getcampus = form.campus;
			// 情報をループしてチェック
			for(var i = 0; i < getHolar.length; i++){
				if(getHolar[i].checked == false){
					for(var j = 0; j < getcampus.length; j++){
						if(getcampus[j].checked == false){
							//全てチェックなしと判断
							vFlg = false;
						}else{
							// 1つでもチェックがあるとその時点でブレイク
							vFlg = true;
							break;
						}
					}
				}else{
					// 1つでもチェックがあるとその時点でブレイク
					vFlg = true;
					break;
				}
			}
			// チェックフラグを判断
			if(!vFlg){
				// 館にチェックが入っていない場合
				form_select.appendChild(new Option("所蔵館を選択してください", ""));
			}else{
				form_select.appendChild(new Option("", ""));
				
				var select = document.getElementById(hollc_id);
				var options = select.getElementsByTagName('option');
				
				var target_holar = new Array();
				
				var campus = form["campus"];
				if(campus.length){
					for(var i = 0; i < campus.length; i++) {
						var target_campus = "campus"+campus[i].value+tab_num;
						var boxs = document.getElementById(target_campus).getElementsByTagName('input');
						if(campus[i].checked){
							for(var j = 0; j < boxs.length; j++) {
								target_holar.push(boxs[j].value);
							}
						}else{
							for(var j = 0; j < boxs.length; j++) {
								if(boxs[j].checked){
									target_holar.push(boxs[j].value);
								}
							}
						}
					}
				}else{
					if(campus.checked){
						var target_campus = "campus"+campus.value+tab_num;
						var boxs = document.getElementById(target_campus).getElementsByTagName('input');
						if(campus.checked){
							for(var i = 0; i < boxs.length; i++) {
								target_holar.push(boxs[i].value);
							}
						}else{
							for(var j = 0; j < boxs.length; j++) {
								if(boxs[j].checked){
									target_holar.push(boxs[j].value);
								}
							}
						}
					}
				}
				
				var pattern = new RegExp("/.*");
				for(var i = 0; i < options.length; i++) {
					var opt_value = options[i].value;
					if(opt_value != ""){
						var opt_holar = opt_value.replace(pattern,"");
						if(target_holar.indexOf(opt_holar) != -1){
							form_select.appendChild(options[i].cloneNode(true));
						}
					}
				}
			}
		}
	}
	
	function ssCatidTgl(tgl_el,catid,event){
		var ddArea = document.getElementById("ss_ddArea_"+catid);
		
		if(ddArea.style.display == "block"){
			tgl_el.innerHTML = tgl_el.innerHTML.replace("minus.png","plus.png");
			ddArea.style.display = "none";
		}else{
			tgl_el.innerHTML = tgl_el.innerHTML.replace("plus.png","minus.png");
			
			var cx = event.clientX + (document.body.scrollLeft || document.documentElement.scrollLeft);
			var cy = event.clientY + (document.body.scrollTop  || document.documentElement.scrollTop);
			ddArea.style.left = (cx + 6) + 'px';
			ddArea.style.top = (cy + 6) + 'px';
			ddArea.style.display = "block";
		}
		return false;
	}
	
	function ssOpenLink(select_el){
		if(select_el.value != ""){
			window.open(select_el.value);
		}
	}

                function EditCln(form_id) {
                        var form_el = document.getElementById(form_id);
                        var strCln = "";
                        var strCln1 = "";
                        var strCln2 = "";
                        var strCln3 = "";
                        var strCln4 = "";
                        strCln1 = form_el.cln1.value.replace("*","%");
                        strCln2 = form_el.cln2.value.replace("*","%");
                        strCln3 = form_el.cln3.value.replace("*","%");
                        strCln4 = form_el.cln4.value.replace("*","%");
                        strCln = strCln1 + "*" + strCln2 + "*" + strCln3 + "*" + strCln4;
                        

                        var strResCln = "";
                        var strResCln1 = "";
                        var strResCln2 = "";
                        var strResCln3 = "";
                        var strResCln4 = "";
                        strResCln1 = form_el.rescln1.value.replace("*","%");
                        strResCln2 = form_el.rescln2.value.replace("*","%");
                        strResCln3 = form_el.rescln3.value.replace("*","%");
                        strResCln4 = form_el.rescln4.value.replace("*","%");
                        strResCln = strResCln1 + "*" + strResCln2 + "*" + strResCln3 + "*" + strResCln4;

			if (strCln == "***") {
				strCln = "";
				if (strResCln == "***") {
					strResCln = "";
				}else{
					strCln = strResCln;
				}
			}
                        form_el.cln.value = strCln;
            }

	
	////Ufinityからの移植Script
	
	var id = id;
	var disp_num = 0;
	var search_mode = null;
	var disp_search_mode = null;
	var old_search_form = null;
	var opac_block_id = null;
	var historyCheck = null;
	var disp_act = null;
	var old_startpos = null;
	var hitcnt = null;
	var formList = Array();
	var hol_disp_flg = null;
	var search_lock = false;
	var func_always = null;
	var opac_base_url = "https://www.lib.kansai-u.ac.jp/webopac";
	var back_flg = false;
	
	
	window.addEventListener("pageshow" , function(e){
		if(e.persisted){
			window.location.reload();
		}
	});
	
	function showpage(obj){
		var tabs = document.getElementById('tab_area').getElementsByTagName('li');
		for(var num = 0 ; num < tabs.length ; num++) {
			if(tabs[num] === obj) break;
		}
		var forms = document.getElementById('div_area').getElementsByTagName('form');
		for(var i = 0 ; i < tabs.length ; i++) {
			if(i == num) {
				this.disp_num = num;
				
				if(document.getElementById('page'+num) != null){
					document.getElementById('page'+num).style.display = 'block';
				}
				if(document.getElementById('search_page'+num) != null){
					document.getElementById('search_page'+num).style.display = 'block';
				}
				if(document.getElementById('opt_page'+num) != null){
					document.getElementById('opt_page'+num).style.display = 'block';
				}
				
				search_mode = sessionStorage.getItem('search_mode');
				var search_form = null;
				if(search_mode != null && search_mode == "detail"){
					search_form = forms.item(num * 2 + 1);
					if(tabs[i].id == "eds"){
						search_form = forms.item(num * 2);
					}
				}else{
					search_form = forms.item(num * 2);
				}
				
				if(tabs[i].id == "sc"){
					var pattern = new RegExp("^[^0-9]+","g");
					var sc_num = search_form.id.replace(pattern,"");
					changeSearchMode('sc','',sc_num,search_mode);
				}else if(tabs[i].id == "eds"){
					var pattern = new RegExp(".*?"+id,"g");
					var eds_num = search_form.id.replace(pattern,"");
					changeSearchMode('eds','',eds_num,search_mode);
				}else{
					changeSearchMode(tabs[i].id,'',num,search_mode);
				}
				
				if(tabs[i].id == "sc"){
					tabs[i].className = 'sc_tab_present';
				}else if(tabs[i].id == "eds"){
					tabs[i].className = 'eds_tab_present';
				}else if(tabs[i].id == "summon"){
					tabs[i].className = 'summon_tab_present';
				}else if(i == 0){
					tabs[i].className = 'opac_tab_present zousyo_tab';
				}else{
					tabs[i].className = 'opac_tab_present';
				}
			}else{
				
				if(document.getElementById('page'+i) != null){
					document.getElementById('page'+i).style.display = 'none';
				}
				if(document.getElementById('search_page'+i) != null){
					document.getElementById('search_page'+i).style.display = 'none';
				}
				if(document.getElementById('opt_page'+i) != null){
					document.getElementById('opt_page'+i).style.display = 'none';
				}
				
				if(tabs[i].id == "sc"){
					tabs[i].className = 'sc_tab_off';
				}else if(tabs[i].id == "eds"){
					tabs[i].className = 'eds_tab_off';
				}else if(tabs[i].id == "summon"){
					tabs[i].className = 'summon_tab_off';
				}else if(i == 0){
					tabs[i].className = 'opac_tab_off zousyo_tab';
				}else{
					tabs[i].className = 'opac_tab_off';
				}

					
				if(tabs[i].id == "nii"){
					if(document.getElementById('customForHideList') != null){
						document.getElementById('customForHideList').style.display = 'none';
					}
				}
				

				var search_list = jQuery("#search_list"+i);
				if(search_list != null && search_list.length > 0){
					jQuery("#search_list"+i).remove();
				}
			}
			
		}
		
		// 画面サイズ変更後で、「その他のタグ」を表示する時、該当タグをフォーカスするために、
		// 「opac_responsive_ufi.css」で設定された画面サイズと打ち合わせて、ここで表示中タグは「その他のタグ」に設定する
		var screenwidth = window.innerWidth;
		if(screenwidth <= 1218){
			if(this.disp_num != 0){
				for(var i = 0 ; i < tabs.length ; i++) {
					if(tabs[i].id == "other_tab"){
						tabs[i].className = 'opac_tab_present';
					}
				}
			}
		}
	
		var old_form = sessionStorage.getItem('old_search_form');
		this.search_mode = sessionStorage.getItem('search_mode');
		var old_form_id = sessionStorage.getItem('old_search_form_id');
		var old_sc_form_id = sessionStorage.getItem('old_sc_form_id');
		var old_opac_form_id = sessionStorage.getItem('old_opac_form_id');

		if(old_form != null && document.getElementById("search_list"+num) == null){
			var search_form = null;
			var mode = '';
			var search_form_old = forms[old_form_id];
			if(search_form_old != null){
				var search_form_old_gcattp = search_form_old["dft_gp"];
				var search_form_old_holar = search_form_old["dft_hr"];
			}
			if(this.search_mode != null && this.search_mode != "undefined"){
				mode = this.search_mode;
			}else{
				mode = this.disp_search_mode;
			}
			
			if(mode != null && mode == "detail"){
				search_form = forms.item(num * 2 + 1);
				if(obj.id == "eds"){
					search_form = forms.item(num * 2);
				}
			}else{
				mode = "simple";
				search_form = forms.item(num * 2);
			}

			var formFlg = false;
			if (search_form.id == old_form_id) {
				formFlg = true;
			}
			
			var params = old_form.split("&");
			if(search_form != null){
				var search_form_gcattp = search_form["dft_gp"];
				var search_form_holar = search_form["dft_hr"];
			}
			search_form.reset();
			formConvert(old_form,search_form);
			var old_hollc = null;
			if(old_form.hollc != null){
				old_hollc = old_form.hollc.value;
			}
			opacHollcCreate(search_form,"",num,old_hollc);
			
			opacGmdSmdCreate(search_form);
	
			var form_id = search_form.id.replace(/_.*/,"");
			old_form_id = old_form_id.replace(/_.*/,"");
			
			var scTosc = false;
			if(form_id == old_form_id && form_id == "sc"){
				scTosc = true;
			}
			
			var opacToOpac = false;
			if(form_id == old_form_id && form_id == "opac"){
				opacToOpac = true;
			}
			
			if(form_id == "erms" || old_form_id == "erms"){
				return true;
			}
			
			if(form_id != old_form_id || formFlg || scTosc || opacToOpac){
				
				var words = "";
				if(old_form_id == "sc"){
					
					words = "keywd";
				}else{
					words = "words";
				}
				
				var sKeywdValue="";
				var sTitleValue="";
				var sAuthValue="";
				var sPubValue="";
				var sIsbn_issnValue="";
				var sSortkey="";
				var sSortkey2="";
				var sListcnt="";
				var sListcntRev="";
				var wordkey = "";
				var titlekey = "";
				var authkey = "";
				var pubkey = "";
				var sGcattp_flag = "";
				var sGcattp = "";
				var sHolar_flag = "";
				var sHolar = "";
				var sYear = "";
				var sYear2 = "";
				var sCode_type = "";
				var sCode = "";
				var sCntry = "";
				var sNcid = "";
				var sLang = "";
				var sCls = "";
				var sSrhclm1 = "";
				var sSrhclm2 = "";
				var sSrhclm3 = "";
				var sSrhclm4 = "";
				var sValclm1 = "";
				var sValclm2 = "";
				var sValclm3 = "";
				var sValclm4 = "";
				var sBibid = "";
				var sRgtn = "";
				var sHolph = "";
				var sLenid = "";
				var sHolsc = "";
				var sCln = "";
				var sHolstat = "";
				var sHollc = "";
				var sDispnum = "";
				
				for(var i = 0 ; i < params.length ; i++){
					param_sp = params[i].split("=");
					param_name = param_sp[0];
					if (param_name == "srhclm1") {
						if (sSrhclm1 == "") {
							sSrhclm1 = decodeURIComponent(param_sp[1]);
						}
						if (param_sp[1] == words) {
							wordkey = "valclm1";
						} else if (param_sp[1] == "title") {
							titlekey = "valclm1";
						} else if (param_sp[1] == "auth") {
							authkey = "valclm1";
						} else if (param_sp[1] == "pub") {
							pubkey = "valclm1";
						}
					} else if (param_name == "srhclm2") {
						if (sSrhclm2 == "") {
							sSrhclm2 = decodeURIComponent(param_sp[1]);
						}
						if (param_sp[1] == words) {
							wordkey = "valclm2";
						} else if (param_sp[1] == "title") {
							titlekey = "valclm2";
						} else if (param_sp[1] == "auth") {
							authkey = "valclm2";
						} else if (param_sp[1] == "pub") {
							pubkey = "valclm2";
						}
					} else if (param_name == "srhclm3") {
						if (sSrhclm3 == "") {
							sSrhclm3 = decodeURIComponent(param_sp[1]);
						}
						if (param_sp[1] == words) {
							wordkey = "valclm3";
						} else if (param_sp[1] == "title") {
							titlekey = "valclm3";
						} else if (param_sp[1] == "auth") {
							authkey = "valclm3";
						} else if (param_sp[1] == "pub") {
							pubkey = "valclm3";
						}
					} else if (param_name == "srhclm4") {
						if (sSrhclm4 == "") {
							sSrhclm4 = decodeURIComponent(param_sp[1]);
						}
						if (param_sp[1] == words) {
							wordkey = "valclm4";
						} else if (param_sp[1] == "title") {
							titlekey = "valclm4";
						} else if (param_sp[1] == "auth") {
							authkey = "valclm4";
						} else if (param_sp[1] == "pub") {
							pubkey = "valclm4";
						}
					} else if (param_name == "valclm1") {
						if (sValclm1 == "") {
							sValclm1 = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "valclm2") {
						if (sValclm2 == "") {
							sValclm2 = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "valclm3") {
						if (sValclm3 == "") {
							sValclm3 = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "valclm4") {
						if (sValclm4 == "") {
							sValclm4 = decodeURIComponent(param_sp[1]);
						}
					}
				}
				for(var i = 0 ; i < params.length ; i++){
					param_sp = params[i].split("=");
					param_name = param_sp[0];
					if (param_name == words || param_name == wordkey) {
						if (sKeywdValue == "") {
							sKeywdValue = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "title" || param_name == titlekey) {
						if (sTitleValue == "") {
							sTitleValue = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "auth" || param_name == authkey) {
						if (sAuthValue == "") {
							sAuthValue = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "pub" || param_name == pubkey) {
						if (sPubValue == "") {
							sPubValue = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "isbn_issn" || param_name == "isbn" || param_name == "isnn") {
						sIsbn_issnValue = decodeURIComponent(param_sp[1]);
					} else if (param_name == "sortkey") {
						if (sSortkey == "") {
							sSortkey = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "sortkey2") {
						if (sSortkey == "") {
							sSortkey2 = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "listcnt") {
						if (sListcnt == "") {
							sListcnt = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "listcntRev") {
						if (sListcntRev == "") {
							sListcntRev = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "gcattp") {
						if (search_form_old_gcattp == null && search_form_gcattp == null) {
							if (sGcattp == "") {
								sGcattp = decodeURIComponent(param_sp[1]);
							} else {
								sGcattp = sGcattp + "," + decodeURIComponent(param_sp[1]);
							}
						}
					} else if (param_name == "gcattp_flag") {
						if (search_form_old_gcattp == null && search_form_gcattp == null) {
							if (sGcattp_flag == "") {
								sGcattp_flag = decodeURIComponent(param_sp[1]);
							}
						}
					} else if (param_name == "holar") {
						if (search_form_old_holar == null && search_form_holar == null) {
							if (sHolar == "") {
								sHolar = decodeURIComponent(param_sp[1]);
							} else {
								sHolar = sHolar + "," + decodeURIComponent(param_sp[1]);
							}
						}
					} else if (param_name == "holar_flag") {
						if (search_form_old_holar == null && search_form_holar == null) {
							if (sHolar_flag == "") {
								sHolar_flag = decodeURIComponent(param_sp[1]);
							}
						}
					} else if (param_name == "year") {
						if (sYear == "") {
							sYear = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "year2") {
						if (sYear2 == "") {
							sYear2 = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "code_type") {
						if (sCode_type == "") {
							sCode_type = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "code") {
						if (sCode == "") {
							sCode = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "cntry") {
						if (sCntry == "") {
							sCntry = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "ncid") {
						if (sNcid == "") {
							sNcid = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "lang") {
						if (sLang == "") {
							sLang = decodeURIComponent(param_sp[1]);
						}
					} else if (param_name == "cls") {
						if (sCls == "") {
							sCls = decodeURIComponent(param_sp[1]);
						}
					}else if (param_name == "bibid") {
						if (sBibid == "") {
							sBibid = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "rgtn") {
						if (sRgtn == "") {
							sRgtn = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "holph") {
						if (sHolph == "") {
							sHolph = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "lenid") {
						if (sLenid == "") {
							sLenid = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "holsc"){
						if (sHolsc == "") {
							sHolsc = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "cln"){
						if (sCln == "") {
							sCln = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "holstat"){
						if (sHolstat == "") {
							sHolstat = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "hollc"){
						if (sHollc == "") {
							sHollc = decodeURIComponent(param_sp[1]);
						}
					}else if(param_name == "dispnum"){
						if (sDispnum == "") {
							sDispnum = decodeURIComponent(param_sp[1]);
						}
					}
				}
				
				if(form_id == "eds"){
					var query = "";
					
					if(old_form_id == "sc"){
						if(mode == "simple"){
							query = sKeywdValue;
						}else{
							query = sTitleValue;
						}
					}else if(old_form_id == "opac"){
						if(mode == "simple"){
							query = sKeywdValue;
						}else{
							query = sValclm1;
						}
					}else{
						query = sKeywdValue;
					}
					search_form.words.value = query;
				}else if(old_form_id == "eds"){
					var query = sKeywdValue;
					
					if(form_id == "sc"){
						if(mode == "simple"){
							search_form.keywd.value = query;
						}else{
							search_form.title.value = query;
						}
					}else if(form_id == "smn"){
						search_form.words.value = query;
					}else{
						if(mode == "simple"){
							search_form.words.value = query;
						}else{
							if(search_form.valclm1 == null){
								search_form.title.value = query;
							}else{
								search_form.valclm1.value = query;
							}
						}
					}
				}else if(form_id == "smn"){
					if(mode == "simple"){
						search_form.words.value = sKeywdValue;
					}else{
						
						search_form.words.value = sKeywdValue;
						search_form.title.value = sTitleValue;
						search_form.auth.value = sAuthValue;
						search_form.pub.value = sPubValue;
						search_form.isbn_issn.value = sIsbn_issnValue;
						search_form.sortkey.value = sSortkey;
						search_form.listcnt.value = sListcnt;
						search_form.sortkey2.value = sSortkey2;
						if(sDispnum == ""){
							formValueSet(params,search_form,"listcntRev",sListcnt);
						}else{
							formValueSet(params,search_form,"listcntRev",sDispnum);
						}
					}
				}else if(old_form_id == "smn"){
					if(mode == "simple"){
						if(form_id == "sc"){
							search_form.keywd.value = sKeywdValue;
						}else{
							if(search_form.words != null){
								search_form.words.value = sKeywdValue;
							}
						}
					}else{
						if(form_id == "sc"){
							search_form.title.value = sTitleValue;
							if(search_form.title.value == ""){
								search_form.title.value = sKeywdValue;
							}
							search_form.auth.value = sAuthValue;
							search_form.pub.value = sPubValue;
							search_form.isbn.value = sIsbn_issnValue;
						}else{
							
							if(search_form.valclm1 != null){
								search_form.valclm1.value = sKeywdValue;
							}
							if(search_form.valclm2 != null){
								search_form.valclm2.value = sTitleValue;
							}
							if(search_form.valclm3 != null){
								search_form.valclm3.value = sAuthValue;
							}
							if(search_form.valclm4.value != null){
								search_form.valclm4.value = sPubValue;
							}
							if(search_form.isbn_issn != null){
								search_form.isbn_issn.value = sIsbn_issnValue;
							}
							if(search_form.listcnt != null){
								formValueSet(params,search_form,"listcnt",sListcntRev);
							}
						}
					}
				}else if(form_id == "sc"){
					if(mode == "simple"){
						search_form.keywd.value = sKeywdValue;
					}else{
						if(sTitleValue != ""){
							search_form.title.value = sTitleValue;
						}else{
							search_form.title.value = sKeywdValue;
						}
						search_form.auth.value = sAuthValue;
						search_form.pub.value = sPubValue;
						search_form.isbn.value = sIsbn_issnValue;
						search_form.year.value = sYear;
						search_form.sort.value = sSortkey;
						formValueSet(params,search_form,"dispnum",sListcnt);
					}
				}else if(old_form_id == "sc"){
					if(mode == "simple"){
						search_form.words.value = sKeywdValue;
					}else{
						if(search_form.words != null){
							search_form.words.value = sKeywdValue;
						}
						if(search_form.valclm2 != null){
							search_form.valclm2.value = sTitleValue;
						}
						if(search_form.valclm3 != null){
							search_form.valclm3.value = sAuthValue;
						}
						if(search_form.valclm4.value != null){
							search_form.valclm4.value = sPubValue;
						}
						if(search_form.year != null){
							search_form.year.value = sYear;
						}
						if(search_form.year2 != null){
							search_form.year2.value = sYear;
						}
						if(search_form.isbn_issn != null){
							search_form.isbn_issn.value = sIsbn_issnValue;
						}
						if(search_form.sortkey != null){
							search_form.sortkey.value = sSortkey;
						}
						if(search_form.listcnt != null){
							formValueSet(params,search_form,"listcnt",sDispnum);
						}
					}
				}else if(form_id == "opac" || form_id == "other"){
					
					if(mode == "simple"){
						search_form.words.value = sKeywdValue;
					}else{
						if(old_form_id == "elib"){
							search_form.sortkey.value = sSortkey;
							search_form.bibid.value = sBibid;
						}
						if(old_form_id == "opac"){
							if(search_form.sortkey != null){
								search_form.sortkey.value = sSortkey;
							}
							if(search_form.bibid != null){
								search_form.bibid.value = sBibid;
							}
							if(search_form.rgtn != null){
								search_form.rgtn.value = sRgtn;
							}
							if(search_form.holph != null){
								formValueSet(params,search_form,"holph",sHolph);
							}
							if(search_form.lenid != null){
								search_form.lenid.value = sLenid;
							}
							if(search_form.holsc != null){
								formValueSet(params,search_form,"holsc",sHolsc);
							}
							if(search_form.cln != null){
								search_form.cln.value = sCln;
							}
							if(search_form.holstat != null){
								if(sHolstat != ""){
									formValueSet(params,search_form,"holstat",sHolstat);
								}
							}
						}
						if(search_form.srhclm1 != null){
							search_form.srhclm1.value = sSrhclm1;
						}
						if(search_form.srhclm2 != null){
							search_form.srhclm2.value = sSrhclm2;
						}
						if(search_form.srhclm3 != null){
							search_form.srhclm3.value = sSrhclm3;
						}
						if(search_form.srhclm4.value != null){
							search_form.srhclm4.value = sSrhclm4;
						}
						if(search_form.valclm1 != null){
							search_form.valclm1.value = sValclm1;
						}
						if(search_form.valclm2 != null){
							search_form.valclm2.value = sValclm2;
						}
						if(search_form.valclm3 != null){
							search_form.valclm3.value = sValclm3;
						}
						if(search_form.valclm4.value != null){
							search_form.valclm4.value = sValclm4;
						}
						
						if(search_form.isbn_issn != null){
							search_form.isbn_issn.value = sIsbn_issnValue;
						}
						if(search_form.listcnt != null){
							formValueSet(params,search_form,"listcnt",sListcnt);
						}
						
						if(search_form.gcattp_flag != null){
							
							if (sGcattp_flag != "") {
								search_form.gcattp_flag.checked = true;
							} else {
								search_form.gcattp_flag.checked = false;
							}
						}
						
						if (sGcattp != "") {
							
							var arrGcattp = sGcattp.split(",");
							for(var i = 0; i < arrGcattp.length; i++){
								
								if (document.getElementById("gcattp_"+arrGcattp[i]+num)) {
									document.getElementById("gcattp_"+arrGcattp[i]+num).checked = true;
								}
							}
						}
						
						if (sGcattp_flag == "" && sGcattp == "") {
							if(search_form.gcattp_flag != null){
								search_form.gcattp_flag.checked = true;
							}	
						}
						
						if(search_form.holar_flag != null){
							
							if (sHolar_flag != "" && sHolar != "") {
								search_form.holar_flag.checked = true;
							} else {
								search_form.holar_flag.checked = false;
							}
						}
						
						if (sHolar != "") {
							
							var arrHolar = sHolar.split(",");
							for(var i = 0; i < arrHolar.length; i++){
								
								if (document.getElementById("holar_"+arrHolar[i]+num)) {
									document.getElementById("holar_"+arrHolar[i]+num).checked = true;
								}
							}
						}
						
						if (sHolar_flag == "" && sHolar == "") {
							if(search_form.holar_flag != null){
								search_form.holar_flag.checked = true;
							}
						}
						
						if(sHollc != null){
							opacHollcCreate(search_form,"",num,sHollc);
						}
						
						if(search_form.year != null){
							search_form.year.value = sYear;
						}
						
						if(search_form.year2 != null){
							if (sYear2 != "") {
								search_form.year2.value = sYear2;
							}
						}
						if(search_form.code_type != null){
							formValueSet(params,search_form,"code_type",sCode_type);
						}
						if(search_form.code != null){
							formValueSet(params,search_form,"code",sCode);
						}
						if(search_form.cntry != null){
							formValueSet(params,search_form,"cntry",sCntry);
						}
						if(search_form.ncid != null){
							search_form.ncid.value = sNcid;
						}
						if(search_form.lang != null){
							formValueSet(params,search_form,"lang",sLang);
						}
						if(search_form.cls != null){
							formValueSet(params,search_form,"cls",sCls);
						}
					}
				}else if(old_form_id == "opac"){
					if(mode == "simple"){
						search_form.words.value = sKeywdValue;
						if(form_id == "sc"){
							search_form.keywd.value = sKeywdValue;
						}else{
							if(search_form.words != null){
								search_form.words.value = sKeywdValue;
							}
						}
					}else{
						if(form_id == "sc"){
							search_form.title.value = sTitleValue;
							if(search_form.title.value == ""){
								search_form.title.value = sKeywdValue;
							}
							search_form.auth.value = sAuthValue;
							search_form.pub.value = sPubValue;
							search_form.isbn.value = sIsbn_issnValue;
						}else{
							if(form_id == "nii"){
								if(search_form.srhclm1 != null){
									search_form.srhclm1.value = sSrhclm1;
								}
								if(search_form.srhclm2 != null){
									search_form.srhclm2.value = sSrhclm2;
								}
								if(search_form.srhclm3 != null){
									search_form.srhclm3.value = sSrhclm3;
								}
								if(search_form.srhclm4.value != null){
									search_form.srhclm4.value = sSrhclm4;
								}
								if(search_form.valclm1 != null){
									search_form.valclm1.value = sValclm1;
								}
								if(search_form.valclm2 != null){
									search_form.valclm2.value = sValclm2;
								}
								if(search_form.valclm3 != null){
									search_form.valclm3.value = sValclm3;
								}
								if(search_form.valclm4.value != null){
									search_form.valclm4.value = sValclm4;
								}
							} else {
								if(form_id == "elib"){
									search_form.sortkey.value = sSortkey;
									search_form.bibid.value = sBibid;
								}
								if(search_form.valclm1 != null){
									search_form.valclm1.value = sKeywdValue;
								}
								if(search_form.valclm2 != null){
									search_form.valclm2.value = sTitleValue;
								}
								if(search_form.valclm3 != null){
									search_form.valclm3.value = sAuthValue;
								}
								if(search_form.valclm4.value != null){
									search_form.valclm4.value = sPubValue;
								}
							}
							if(search_form.isbn_issn != null){
								search_form.isbn_issn.value = sIsbn_issnValue;
							}
							if(search_form.listcnt != null){
								formValueSet(params,search_form,"listcnt",sListcnt);
							}
							
							if(search_form.gcattp_flag != null){
								
								if (sGcattp_flag != "") {
									search_form.gcattp_flag.checked = true;
								} else {
									search_form.gcattp_flag.checked = false;
								}
							}
							
							if (sGcattp != "") {
								
								var arrGcattp = sGcattp.split(",");
								for(var i = 0; i < arrGcattp.length; i++){
									
									if (document.getElementById("gcattp_"+arrGcattp[i]+num)) {
										document.getElementById("gcattp_"+arrGcattp[i]+num).checked = true;
									}
								}
							}
							
							if (sGcattp_flag == "" && sGcattp == "") {
								if(search_form.gcattp_flag != null){
									search_form.gcattp_flag.checked = true;
								}	
							}
							
							if(search_form.holar_flag != null){
								
								if (sHolar_flag != "") {
									search_form.holar_flag.checked = true;
								} else {
									search_form.holar_flag.checked = false;
								}
							}
							
							if (sHolar != "") {
								
								var arrHolar = sHolar.split(",");
								for(var i = 0; i < arrHolar.length; i++){
									
									if (document.getElementById("holar_"+arrHolar[i]+num)) {
										document.getElementById("holar_"+arrHolar[i]+num).checked = true;
									}
								}
							}
							
							if (sHolar_flag == "" && sHolar == "") {
								if(search_form.holar_flag != null){
									search_form.holar_flag.checked = true;
								}	
							}
							
							if(search_form.year != null){
								search_form.year.value = sYear;
							}
							if(search_form.code_type != null){
								formValueSet(params,search_form,"code_type",sCode_type);								
							}
							if(search_form.code != null){
								formValueSet(params,search_form,"code",sCode);
							}
							if(search_form.cntry != null){
								formValueSet(params,search_form,"cntry",sCntry);
							}
							if(search_form.ncid != null){
								search_form.ncid.value = sNcid;
							}
							if(search_form.lang != null){
								formValueSet(params,search_form,"lang",sLang);
							}
							if(search_form.cls != null){
								formValueSet(params,search_form,"cls",sCls);
							}
						}
					}
				}else if(form_id == "elib"){
					if(mode == "simple"){
						search_form.words.value = sKeywdValue;
					}else{
						if(search_form.srhclm1 != null){
							search_form.srhclm1.value = sSrhclm1;
						}
						if(search_form.srhclm2 != null){
							search_form.srhclm2.value = sSrhclm2;
						}
						if(search_form.srhclm3 != null){
							search_form.srhclm3.value = sSrhclm3;
						}
						if(search_form.srhclm4.value != null){
							search_form.srhclm4.value = sSrhclm4;
						}
						if(search_form.valclm1 != null){
							search_form.valclm1.value = sValclm1;
						}
						if(search_form.valclm2 != null){
							search_form.valclm2.value = sValclm2;
						}
						if(search_form.valclm3 != null){
							search_form.valclm3.value = sValclm3;
						}
						if(search_form.valclm4.value != null){
							search_form.valclm4.value = sValclm4;
						}
						
						if(search_form.isbn_issn != null){
							search_form.isbn_issn.value = sIsbn_issnValue;
						}
						if(search_form.listcnt != null){
							formValueSet(params,search_form,"listcnt",sListcnt);
						}
						
						if(search_form.gcattp_flag != null){
							
							if (sGcattp_flag != "") {
								search_form.gcattp_flag.checked = true;
							} else {
								search_form.gcattp_flag.checked = false;
							}
						}
						
						if (sGcattp != "") {
							
							var arrGcattp = sGcattp.split(",");
							for(var i = 0; i < arrGcattp.length; i++){
								
								if (document.getElementById("gcattp_"+arrGcattp[i]+num)) {
									document.getElementById("gcattp_"+arrGcattp[i]+num).checked = true;
								}
							}
						}
						
						if (sGcattp_flag == "" && sGcattp == "") {
							if(search_form.gcattp_flag != null){
								search_form.gcattp_flag.checked = true;
							}	
						}
						
						if(search_form.holar_flag != null){
							
							if (sHolar_flag != "") {
								search_form.holar_flag.checked = true;
							} else {
								search_form.holar_flag.checked = false;
							}
						}
						
						if (sHolar != "") {
							
							var arrHolar = sHolar.split(",");
							for(var i = 0; i < arrHolar.length; i++){
								
								if (document.getElementById("holar_"+arrHolar[i]+num)) {
									document.getElementById("holar_"+arrHolar[i]+num).checked = true;
								}
							}
						}
						
						if (sHolar_flag == "" && sHolar == "") {
							if(search_form.holar_flag != null){
								search_form.holar_flag.checked = true;
							}	
						}
						
						if(search_form.year != null){
							search_form.year.value = sYear;
						}
						
						if(search_form.year2 != null){
							if (sYear2 != "") {
								search_form.year2.value = sYear2;
							}
						}
						if(search_form.code_type != null){
							formValueSet(params,search_form,"code_type",sCode_type);
						}
						if(search_form.code != null){
							formValueSet(params,search_form,"code",sCode);
						}
						if(search_form.cntry != null){
							formValueSet(params,search_form,"cntry",sCntry);
						}
						if(search_form.ncid != null){
							search_form.ncid.value = sNcid;
						}
						if(search_form.lang != null){
							formValueSet(params,search_form,"lang",sLang);
						}
						if(search_form.cls != null){
							formValueSet(params,search_form,"cls",sCls);
						}
					}
				}else if(old_form_id == "elib"){
					if(mode == "simple"){
						search_form.words.value = sKeywdValue;
						if(form_id == "sc"){
							search_form.keywd.value = sKeywdValue;
						}else{
							if(search_form.words != null){
								search_form.words.value = sKeywdValue;
							}
						}
					}else{
						if(form_id == "sc"){
							search_form.title.value = sTitleValue;
							if(search_form.title.value == ""){
								search_form.title.value = sKeywdValue;
							}
							search_form.auth.value = sAuthValue;
							search_form.pub.value = sPubValue;
							search_form.isbn.value = sIsbn_issnValue;
						}else{
							if(form_id == "nii"){
								if(search_form.srhclm1 != null){
									search_form.srhclm1.value = sSrhclm1;
								}
								if(search_form.srhclm2 != null){
									search_form.srhclm2.value = sSrhclm2;
								}
								if(search_form.srhclm3 != null){
									search_form.srhclm3.value = sSrhclm3;
								}
								if(search_form.srhclm4.value != null){
									search_form.srhclm4.value = sSrhclm4;
								}
								if(search_form.valclm1 != null){
									search_form.valclm1.value = sValclm1;
								}
								if(search_form.valclm2 != null){
									search_form.valclm2.value = sValclm2;
								}
								if(search_form.valclm3 != null){
									search_form.valclm3.value = sValclm3;
								}
								if(search_form.valclm4.value != null){
									search_form.valclm4.value = sValclm4;
								}
							} else {
								if(search_form.valclm1 != null){
									search_form.valclm1.value = sKeywdValue;
								}
								if(search_form.valclm2 != null){
									search_form.valclm2.value = sTitleValue;
								}
								if(search_form.valclm3 != null){
									search_form.valclm3.value = sAuthValue;
								}
								if(search_form.valclm4.value != null){
									search_form.valclm4.value = sPubValue;
								}
							}
							if(search_form.isbn_issn != null){
								search_form.isbn_issn.value = sIsbn_issnValue;
							}
							if(search_form.listcnt != null){
								formValueSet(params,search_form,"listcnt",sListcnt);
							}
							
							if(search_form.gcattp_flag != null){
								
								if (sGcattp_flag != "") {
									search_form.gcattp_flag.checked = true;
								} else {
									search_form.gcattp_flag.checked = false;
								}
							}
							
							if (sGcattp != "") {
								
								var arrGcattp = sGcattp.split(",");
								for(var i = 0; i < arrGcattp.length; i++){
									
									if (document.getElementById("gcattp_"+arrGcattp[i]+num)) {
										document.getElementById("gcattp_"+arrGcattp[i]+num).checked = true;
									}
								}
							}
							
							if (sGcattp_flag == "" && sGcattp == "") {
								if(search_form.gcattp_flag != null){
									search_form.gcattp_flag.checked = true;
								}	
							}
							
							if(search_form.holar_flag != null){
								
								if (sHolar_flag != "") {
									search_form.holar_flag.checked = true;
								} else {
									search_form.holar_flag.checked = false;
								}
							}
							
							if (sHolar != "") {
								
								var arrHolar = sHolar.split(",");
								for(var i = 0; i < arrHolar.length; i++){
									
									if (document.getElementById("holar_"+arrHolar[i]+num)) {
										document.getElementById("holar_"+arrHolar[i]+num).checked = true;
									}
								}
							}
							
							if (sHolar_flag == "" && sHolar == "") {
								if(search_form.holar_flag != null){
									search_form.holar_flag.checked = true;
								}	
							}
							
							if(search_form.year != null){
								search_form.year.value = sYear;
							}
							if(search_form.code_type != null){
								formValueSet(params,search_form,"code_type",sCode_type);
							}
							if(search_form.code != null){
								formValueSet(params,search_form,"code",sCode);
							}
							if(search_form.cntry != null){
								formValueSet(params,search_form,"cntry",sCntry);
							}
							if(search_form.ncid != null){
								search_form.ncid.value = sNcid;
							}
							if(search_form.lang != null){
								formValueSet(params,search_form,"lang",sLang);
							}
							if(search_form.cls != null){
								formValueSet(params,search_form,"cls",sCls);
							}
						}
					}
				}
			}
			if(form_id == "opac"){
				var params2 = jQuery(search_form).serialize();
				changeSearchMode('opac','',num,mode);
				var pattern = new RegExp("^[^0-9]+","g");
				var opac_num = search_form.id.replace(pattern,"");
				if(form_id != old_form_id){
					clearSearchErrorMsg();
					sendOpacSearch(search_form,id,"true");
				}else{
					if(opac_num != old_opac_form_id){
						clearSearchErrorMsg();
						sendOpacSearch(search_form,id,"true");
					}
				}
				if(sessionStorage.getItem("other_srh_flg") != null){
					var other_srh_flg = sessionStorage.getItem("other_srh_flg");
					if(other_srh_flg == "true"){
						clearSearchErrorMsg();
						sendOpacSearch(search_form,id,"true");
						sessionStorage.removeItem("other_srh_flg");
					}
				}
				if(mode == "simple"){
					convertSimple2Detail("opac",id,num);
				}
			}else if(form_id == "nii"){
				changeSearchMode('nii','',num,mode);
				if(form_id != old_form_id){
					if(this.disp_num != getTab_Num()){
						clearSearchErrorMsg();
						sendNiiSearch(search_form,'',"true");
					}
				}
				if(mode == "simple"){
					convertSimple2Detail("nii",id,num);
				}
			}else if(form_id == "other"){
				clearSearchErrorMsg();
				document.getElementById('search_page'+num).innerHTML = '';
				document.getElementById('opt_page'+num).innerHTML = '';
				
				changeSearchMode('other',id,num,mode);
				if(form_id != old_form_id){
					search_form.submit();
				}
				if(mode == "simple"){
					convertSimple2Detail("other",id,num);
				}
				sessionStorage.setItem("other_srh_flg","true");
			}else if(form_id == "sc"){
				var pattern = new RegExp("^[^0-9]+","g");
				var sc_num = search_form.id.replace(pattern,"");
				changeSearchMode('sc',id,sc_num,mode);
				if(form_id != old_form_id){
					clearSearchErrorMsg();
					sendScTabSearch(search_form,id,sc_num,mode);
				}else{
					if(sc_num != old_sc_form_id){
						sendScTabSearch(search_form,id,sc_num,mode);
					}
				}
			}else if(form_id == "eds"){
				var pattern = new RegExp(".*?"+id,"g");
				var eds_num = search_form.id.replace(pattern,"");
				changeSearchMode('eds',id,eds_num,mode);
				if(form_id != old_form_id){
					if(search_form.words.value != ""){
						clearSearchErrorMsg();
						sendEdsSearch(search_form,id);
					}else{
						clearSearchErrorMsg();
					}
				}
			}else if(form_id == "smn"){
				
				changeSearchMode('smn','',num,mode);
				if(form_id != old_form_id){
					clearSearchErrorMsg();
					sendSummonSearch(search_form,'',"true");
				}
			}else if(form_id == "elib"){
				var params2 = jQuery(search_form).serialize();
				changeSearchMode('elib','',num,mode);
				if(form_id != old_form_id){
					clearSearchErrorMsg();
					sendOpacSearch(search_form,id,"true");
				}
				if(mode == "simple"){
					convertSimple2Detail("elib",id,num);
				}
			}
		}
	}

	function formValueSet(params,search_form,obj,value){
		for(var i = 0 ; i < params.length ; i++){
			var param_sp = params[i].split("=");
			var param_name = param_sp[0];
			if(obj=="listcntRev"){
				param_name = "listcntRev";
			}else if(obj=="dispnum"){
				param_name = "dispnum";
			}
			if(param_name=="dispnum"){
				param_name = obj;
			}
			if(search_form[param_name] != null){
				for(var j = 0 ; j < search_form[param_name].length ; j++){
					if (param_name == obj) {
						var s_param = search_form[param_name][j];
						if(!s_param.disabled || s_param.type != "hidden"){
							
							search_form[param_name][j].value = value;
						}
					}
				}
			}
		}
	}

	function getTab_Num(){
		var tab_num="";
		if(sessionStorage.getItem("query_str") != null){
			var query_str=sessionStorage.getItem("query_str");
			var params = query_str.split("&amp;");
			for(var i = 0 ; i < params.length ; i++){
				var param = params[i].split("=");
				var name = param[0];
				var value = param[1];
				if(name=="tab_num"){
					tab_num=value;
				}
			}
		}
		return tab_num;
	}

	function formConvert(old_form,search_form){
		if(old_form != null && search_form != null){
			for(var i = 0 ; i < old_form.length ; i++){
				var name = old_form[i].name;
				var value = old_form[i].value;
				if(search_form[name] != null){
					if(old_form[i].type == "hidden" || search_form[name].type == "hidden"){
						continue;
					}
					
					if(old_form[i].type == "checkbox"){
						if(name != "site"){
							if(search_form[name].type == "checkbox"){
								search_form[name].checked = old_form[i].checked;
							}else if(search_form[name].length){
								for(var j = 0 ; j < search_form[name].length ; j++){
									var s_param = search_form[name][j];
									if(s_param.type == "checkbox" && s_param.value == value){
										s_param.checked = old_form[i].checked;
									}
								}
							}
						}
					}else if(search_form[name].type == "select-one"){
						for(var j = 0 ; j < search_form[name].options.length ; j++){
							if(search_form[name].options[j].value == value){
								search_form[name].value = value;
								break;
							}
						}
					}else{
						if(name != "initFlg" && name != "startpos" && name != "fromDsp" && name != "searchDsp" && name.indexOf("fct_") != 0){
							search_form[name].value = value;
						}
					}
				}
			}
		}
	}

	function formConvert2(old_form,new_form){
		if(old_form != null && new_form != null){
			var params = Form.serialize(old_form).split("&");
			var param_sp = null;
			var param_name = null;
			var param_name_hst = null;
			for(var i = 0 ; i < params.length ; i++){
				param_sp = params[i].split("=");
				param_name = param_sp[0];
				if(new_form[param_name] == null || param_name == param_name_hst){
					lElement = document.createElement('input');
					lElement.type = "hidden";
					lElement.name = param_name;
					lElement.value = decodeURIComponent(param_sp[1]);
					new_form.appendChild(lElement);
					param_name_hst = param_name;
				}
			}
		}
	}

	function changeSearchMode(name,id,num,mode,tab_type){
		var simple = document.getElementById(name+'_tab_simple'+num);
		var detail = document.getElementById(name+'_tab_detail'+num);
		if(name == "opac"){
			if(tab_type == "tab" && mode == "simple"){
				var simple2 = document.getElementById(name+"_valclm1"+num).value;
				if (simple2 != "") {
					document.getElementById(name+'_tab_keywd'+num).value = simple2;
				}
				tab_type = "";
			}else if(tab_type == "tab" && mode == "detail"){
				var simple1 = document.getElementById(name+'_tab_keywd'+num).value;
				if(simple1) {
					document.getElementById(name+'_valclm1'+num).value = simple1;
				}
				tab_type = "";
			}
		}else{
			if(tab_type == "tab" && mode == "simple"){
				
				var simple2 = document.getElementById(name+"_valclm1").value;
				if (simple2 != "") {
					document.getElementById(name+'_tab_keywd'+num).value = simple2;
				}
				tab_type = "";
			}else if(tab_type == "tab" && mode == "detail"){
				var simple1 = document.getElementById(name+'_tab_keywd'+num).value;
				if(simple1) {
					document.getElementById(name+'_valclm1').value = simple1;
				}
				tab_type = "";
			}
		}
		if(simple != null && detail != null){
			if(mode == "simple"){
				simple.style.display = 'block';
				detail.style.display = 'none';
				this.disp_search_mode = mode;
			}else{
				if(detail.className == "none"){
					detail.className = "";
					url = "cattab.do?tab_detail_num=" + num;
					if(tab_type != null && tab_type != ""){
						url += "&tab_type="+tab_type;
					}
					
					jQuery.ajax({
						url: url,
						dataType: "html",
						method:"post",
						cache: false,
						success: function(data, textStatus){
							detail.innerHTML = data;
							simple.style.display = 'none';
							detail.style.display = 'block';
							this.disp_search_mode = mode;
						},
						error: function(xhr, textStatus, errorThrown){
						}
					});
					
				}else{
					simple.style.display = 'none';
					detail.style.display = 'block';
					this.disp_search_mode = mode;
				}
			}
		}
	}

	function convertSimple2Detail(name,id,num){
		var simple = document.getElementById(name+'_tab_form'+id+num);
		var detail = document.getElementById(name+'_tab_detail_form'+id+num);
		
		if(simple != null && simple["words"] != null && detail != null && detail["valclm1"] != null){
			detail.reset();
			detail["valclm1"].value = simple["words"].value;
		}
		
	}

	function clearSearchPage(id){
		var tab_area = document.getElementById('tab_area'+id);
		if(tab_area != null){
			var tabs = tab_area.getElementsByTagName('li');
			if(tabs != null){
				for(var num = 0 ; num < tabs.length ; num++) {
					if(document.getElementById("search_page"+id+num) != null){
						document.getElementById("search_page"+id+num).innerHTML = '';
					}
				}
			}
		}
	}

	function getCurrentlyDisplayedSearchTabFormId() {
		let $searchTabForms = $("form[id*='_tab_']");
		let curTabFormId = "";
		$searchTabForms.each(function(index, element) {
			let $form = $(element);
			if ($form.is(':visible') && $form.parents("div[id^=page]").is(':visible')) {
				curTabFormId = element.id;
				return false;
			}
		});
		return curTabFormId;
	}
	
	function imgChange2On(el) {
	    var img_el = (el.tagName.toLowerCase() == "img") ? el : el.getElementsByTagName("img")[0];
	    if(img_el) {
	        prev_name=img_el.src.replace(/(\!|"|'|\(|\)|\-|\=|\^|\\|\||\[|\{|\+|\:|\*|\]|\}|\,|\<|\.|\>|\/|\?)/g,"\$1");
	        img_el.src = img_el.src.replace("_off_", "_on_");
	    }
	}

	function imgChange2Off(el) {
		var className = el.className;
		if(className.indexOf("toggle_on") != -1){return false;}
	    var img_el = (el.tagName.toLowerCase() == "img") ? el : el.getElementsByTagName("img")[0];
	    if(img_el) {
	        prev_name=img_el.src.replace(/(\!|"|'|\(|\)|\-|\=|\^|\\|\||\[|\{|\+|\:|\*|\]|\}|\,|\<|\.|\>|\/|\?)/g,"\$1");
	        img_el.src = img_el.src.replace("_on_", "_off_");
	    }
	}

	function opacSetSortKey_type(sortkey,id,form_name){
		var search_form = document.getElementById(form_name);
		search_form.sortkey.value = sortkey;
		sendOpacSearch_formkey(search_form,id);
	}

	function opacSetListcnt(listcnt,id,form_name){
		var search_form = document.getElementById(form_name);
		search_form.listcnt.value = listcnt;
		sendOpacSearch_formkey(search_form,id);
	}

	function opacSetStartpos(startpos,id,form_name){
		var search_form = document.getElementById(form_name);
		search_form.startpos.value = startpos;
		search_form.initFlg.value = "_RESULT_SET_NOTBIB";
		sendOpacSearch_formkey(search_form,id);
	}

	function sendOpacSearch_formkey(form_el,id){
		this.old_search_form = form_el;
		this.opac_block_id = id.replace("_","");
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);

		document.getElementById('search_page'+id+this.disp_num).innerHTML = '';
		document.getElementById('opt_page'+id+this.disp_num).innerHTML = '';

		var search_form = form_el;
		search_form.startpos.value = form_el.startpos.value;
		search_form.initFlg.value = form_el.initFlg.value;
		search_form.listcnt.value = form_el.listcnt.value;
		search_form.sortkey.value = form_el.sortkey.value;
		var lElement = document.createElement('input');
		lElement.type = "hidden";
		lElement.name = "tab_num";
		lElement.value = decodeURIComponent(this.disp_num);
		search_form.appendChild(lElement);
		search_form.method = "POST";
		search_form.target_el = document.getElementById('search_page'+id+this.disp_num);

		search_form.action = "https://www.lib.kansai-u.ac.jp/webopac/ctlsrh.do";
		search_form.submit();
	}

	function sendOpacSearch_history(id,tab_num,formkeyno){

		document.getElementById('search_page'+id+tab_num).innerHTML = '';
		document.getElementById('opt_page'+id+tab_num).innerHTML = '';
		
		var top_el = document.getElementById(id);
		var param = "v3search_action_main_opac";
		param += "&tab_num=" + encodeURIComponent(tab_num);
		
		var op_param = "formkeyno="+formkeyno;
		op_param += "&svcaction=history";
		param += "&op_param=" + encodeURIComponent(op_param);

		var params = new Object();
		params["param"] = param;
		params["method"] = "post";
		params["loading_el"] = top_el;
		params["top_el"] = top_el;
		params["target_el"] = document.getElementById('search_page'+id+tab_num);
		
		commonCls.send(params);
	}

	function sendNiiSearch_history(id,tab_num,formkeyno){

		document.getElementById('search_page'+id+tab_num).innerHTML = '';
		document.getElementById('opt_page'+id+tab_num).innerHTML = '';
		
		var top_el = document.getElementById(id);
		var param = "v3search_action_main_nii";
		param += "&tab_num=" + encodeURIComponent(tab_num);
		
		var op_param = "formkeyno="+formkeyno;
		op_param += "&svcaction=history";
		param += "&op_param=" + encodeURIComponent(op_param);

		var params = new Object();
		params["param"] = param;
		params["method"] = "post";
		params["loading_el"] = top_el;
		params["top_el"] = top_el;
		params["target_el"] = document.getElementById('search_page'+id+tab_num);
		
		commonCls.send(params);
	}

	function checkBibid(form_id,func){
		var boxs = document.getElementById(form_id).bibid;
		if(boxs.length){
			for(num=0; num < boxs.length; num++){
				boxs[num].checked = func;
			}
		}else{
			boxs.checked = func;
		}
	}

	function keywdClear(form_el){
		form_el.keywd.value = "";
	}

	function hiddenSearchModule(id){
		document.getElementById('v3_module'+id).style.display = 'none';
	}

	function opacCatdbl(id,bibid,startpos,hitcnt,form_id,svcaction,formkeyno,load_point,notformkey,old_formkeyno){
		
		var url = "";

		if(bibid != null){
			url += "pkey=" + encodeURIComponent(bibid);
		}
		
		var add_url = "";
		if(form_id != null){
			var form_el_add = document.getElementById(form_id);
			add_url = "&" + jQuery(form_el_add).serialize();
		}

		if(add_url == "" && formkeyno == null){
			add_url += "&initFlg=" + encodeURIComponent("_RESULT_SET_NOTBIB");
		}
		if(startpos != null){
			add_url += "&startpos=" + encodeURIComponent(startpos);
		}
		if(hitcnt != null){
			add_url += "&hitcnt=" + encodeURIComponent(hitcnt);
		}

		if(svcaction != null){
			add_url += "&svcaction=" + encodeURIComponent(svcaction);
		}
		
		if(this.disp_num != null){
			add_url += "&tab_num=" + encodeURIComponent(this.disp_num);
		}
		
		if(old_formkeyno != null){
			add_url += "&old_formkeyno=" + encodeURIComponent(old_formkeyno);
		}
		
		var tab_num = this.disp_num;
		if(formkeyno == null && notformkey == null){
			formkeyno = this.formList[tab_num];
		}
		if(formkeyno != null){
			var fkn_enc = "&formkeyno="+encodeURIComponent(formkeyno);
			url += fkn_enc;
		}
		
		var catdbl_url = "https://www.lib.kansai-u.ac.jp/webopac/catdbl.do?" + url + add_url;
		location.href = catdbl_url;
	}

	function opacSingleHit(id,bibid,formkeyno){
		if(document.getElementById('v3_module') != null && document.getElementById('v3_module').style.display != "none"){
			hiddenSearchModule(id);
			
			var detail_object = document.getElementById('detail_object'+id);
			var detail_area = document.getElementById('detail_area'+id);
			detail_area.appendChild(detail_object);
			detail_area.style.display = 'block';
			
			opacSetFormkeyno(id,formkeyno);
		}
	}

	function opacCatdal(id,linkid,form_id,svcaction,old_formkeyno){
		if(linkid != null && linkid != ""){
			opacSetHash(id,"#catdal-"+linkid);
		}
		
		var url = "";

		if(linkid != null){
			url += "&linkid=" + encodeURIComponent(linkid);
			url += "&pkeyAty=" + encodeURIComponent(linkid);
			if(getQueryValue('pkey')!=null){
				url+="&pkey="+getQueryValue('pkey');
			}
		}

		var add_url = "";
		if(form_id != null){
			var form_el = document.getElementById(form_id);
			add_url += jQuery(form_el).serialize();
		}

		if(svcaction != null){
			add_url += "&svcaction=" + encodeURIComponent(svcaction);
		}
		
		url += "&" + add_url;

		var tab_num = this.disp_num;
		var formkeyno = this.formList[tab_num];
		if(formkeyno != null){
			var fkn_enc = "&formkeyno="+encodeURIComponent(formkeyno);
			url += fkn_enc;
		}
		
		if(old_formkeyno != null){
			url += "&old_formkeyno_catdal="+encodeURIComponent(old_formkeyno);
		}
		
		var catdal_url = "https://www.lib.kansai-u.ac.jp/webopac/catdal.do?" + url;
		location.href = catdal_url;
	}

	function opacCatdhl(id,event,holid){
		var url = "catdhl.do?";
		url += "pkeyHol="+encodeURIComponent(holid);

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			type:"post",
			success: function(data, textStatus){
				PopUpOpenAjax(data);
				},
			error: function(xhr, textStatus, errorThrown){
			}
		});
	}

	function opacDspmap(id,event,holid,dbtarget,hollctype){
		var url = "dspmap.do?";
		url += "id="+encodeURIComponent(holid);
		url += "&dbTarget="+encodeURIComponent(dbtarget);
		url += "&hollcType="+encodeURIComponent(hollctype);

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjaxLmap(data);
				},
			error: function(xhr, textStatus, errorThrown){
			}
		});
	}

	function sendOpacSearch_Field(form_el,id){
		this.old_search_form = form_el;
		this.opac_block_id = id.replace("_","");

		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		form_el.tab_num = this.disp_num;
		form_el.tab_detail_num = "1";

		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ctlsrh.do?search_mode=detail";
		form_el.method = "POST";
		form_el.submit();
	}

	function opacSearchLocal_Cnd(id){
		var tabs = document.getElementById('tab_area'+id).getElementsByTagName('li');
		for(var num = 0 ; num < tabs.length ; num++) {
			if(tabs[num].id === "opac") {
				backToList(id);
				document.getElementById("search_page"+id+num).innerHTML = '';
				showpage(tabs[num],id);
				
				break;
			}
		}
	}

	function opacSearchLocal_Id(form_el,id){
		this.old_search_form = form_el;
		this.opac_block_id = id.replace("_","");
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		form_el.tab_num.value = "0";
		form_el.search_mode.value = "detail";
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ctlsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function opacSearchNii_Cnd(form_el,id,reSrchCondFormkeyno){
		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		this.search_lock = true;
		
		form_el.reSrchCondFormkeyno.value = reSrchCondFormkeyno;
		form_el.tab_num.value = "nii";
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ctnsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function opacSearchNii_Id(form_el,id){
		this.old_search_form = form_el;
		this.opac_block_id = id.replace("_","");
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		form_el.tab_num.value = "nii";
		form_el.search_mode.value = "detail";
		form_el.reSrchCondFormkeyno.value = "";
		sessionStorage.removeItem("old_search_form");
		sessionStorage.removeItem("old_search_form_id");
		sessionStorage.removeItem("search_mode");
		
		var params = jQuery(form_el).serialize();
		sessionStorage.setItem("old_search_form",params);
		sessionStorage.setItem("old_search_form_id","nii");
		sessionStorage.setItem("search_mode","detail");
		
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ctnsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function opacShowRelation(target,id){
		var lis = document.getElementById('relation_table'+id).getElementsByTagName('li');
		for(var num = 0 ; num < lis.length ; num++) {
			if(lis[num].id === target) {
				if(lis[num].style.display != "block"){
					lis[num].style.display = "block";
				}else{
					lis[num].style.display = "none";
				}
			}else if(lis[num].id != null && lis[num].id != ""){
				lis[num].style.display = "none";
			}
		}
	}

	function opacSearch_Cnd(target,id){
		var tabs = document.getElementById('tab_area'+id).getElementsByTagName('li');
		for(var num = 0 ; num < tabs.length ; num++) {
			if(tabs[num].id === target) {
				backToList(id);
				document.getElementById("search_page"+id+num).innerHTML = '';
				showpage(tabs[num],id);
				
				break;
			}
		}
	}

	function setHistoryCheck(id){
		if(this.historyCheck == null){
			this.historyCheck = setInterval("historyCheck('"+id+"')", 1000);
		}
	}

	function historyCheck(id){
		var hash = window.location.hash;
		if(hash != null){
			if(hash != this.disp_act){
				var hashs = hash.split("-");
				var act = hashs[0];
				if(act == "#searchlist"){
					if(hashs.length == 3){
						var tab_num = hashs[1];
						var formkeyno = hashs[2];
						if(this.disp_act != null){
							var d_hashs = this.disp_act.split("-");
							var d_act = d_hashs[0];
							if(d_act == "#catdbl"){
								backToList(id,true);
							}else if(d_act == "#catdal"){
								backToList(id);
							}else if(d_act == "#catdbn"){
								backToList(id);
							}else if(d_act == "#catdan"){
								backToList(id);
							}else{
								this.old_search_form = null;
								var forms = document.getElementById('div_area'+id).getElementsByTagName('form');
								var simple_form = forms.item(tab_num * 2);
								if(simple_form != null){
									simple_form.reset();
								}
								var detail_form = forms.item(tab_num * 2 + 1);
								if(detail_form != null){
									detail_form.reset();
								}

								var tabs = document.getElementById('tab_area'+id).getElementsByTagName('li');
								var select_tab = tabs[tab_num];
								if(d_hashs.length > 1){
									var d_tab_num = d_hashs[1];
									if(tab_num != d_tab_num){
										showpage(select_tab,id);
									}
								}
								
								this.disp_act = hash;
								
								var tab_type = select_tab.id;
								if(tab_type == "opac"){
									sendOpacSearch_history(id,tab_num,formkeyno);
								}else if(tab_type == "elib"){
									sendOpacSearch_history(id,tab_num,formkeyno);
								}else if(tab_type == "nii"){
									sendNiiSearch_history(id,tab_num,formkeyno);
								}else if(tab_type == "sc"){
									sendSearch_history(id,tab_num,formkeyno);
								}
							}
						}else{
							var tabs = document.getElementById('tab_area'+id).getElementsByTagName('li');
							var select_tab = tabs[tab_num];
							var tab_type = select_tab.id;
							this.disp_act = hash;
							if(tab_type == "opac"){
								sendOpacSearch_history(id,tab_num,formkeyno);
							}else if(tab_type == "elib"){
								sendOpacSearch_history(id,tab_num,formkeyno);
							}else if(tab_type == "nii"){
								sendNiiSearch_history(id,tab_num,formkeyno);
							}else if(tab_type == "sc"){
								sendSearch_history(id,tab_num,formkeyno);
							}
						}
					}else{
						backToList(id);
					}
				}else if(act == "#bkmref"){
					if(this.disp_act != null && this.disp_act.indexOf("#catdbl") == 0){
						backToList(id);
					}else{
						this.disp_act = hash;
						sendOtherSearch(id,'bkmref');
					}
				}else if(act == "#hstref"){
					this.disp_act = hash;
					sendOtherSearch(id,'hstref');
				}else if(act == "#beslst"){
					//ヒストリーバック用フラグが有効であればブラウザのヒストリーバックを実行
					if(this.back_flg){
						window.history.back();
						exit;
					}else{
					backToList(id);
					}
				}else if(act == "#brqlst"){
					backToList(id);
				}else if(act == "#newlst"){
					//ヒストリーバック用フラグが有効であればブラウザのヒストリーバックを実行
					if(this.back_flg){
						window.history.back();
						exit;
					}else{
					backToList(id);
					}
				}else if(act == "#reflst"){
					backToList(id);
				}else if(act == "#acrlst"){
					//ヒストリーバック用フラグが有効であればブラウザのヒストリーバックを実行
					if(this.back_flg){
						window.history.back();
						exit;
					}else{
					backToList(id);
					}
				}else if(act == "#v3search_view_main_init"){
					//ヒストリーバック用フラグが有効であればブラウザのヒストリーバックを実行
					if(this.back_flg){
						window.history.back();
						exit;
					}
				}else{
					if(hashs.length == 2){
						var key = hashs[1];
						if(act == "#catdbl"){
							this.disp_act = hash;
							opacCatdbl(id,key);
						}else if(act == "#catdal"){
							this.disp_act = hash;
							opacCatdal(id,key);
						}else if(act == "#catdbn"){
							this.disp_act = hash;
							niiCatdbn(id,key);
						}else if(act == "#catdan"){
							this.disp_act = hash;
							niiCatdan(id,key);
						}
					}
				}
			}
		}
	}

	function backToList(id, noHash){
		history.back();
	}

	function opacAjax(bibid,gcattp,formkeyno,id,tab_num,svcaction){
		url = "extsrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		url += "&gcattp="+encodeURIComponent(gcattp);
		url += "&formkeyno="+encodeURIComponent(formkeyno);
		url += "&block_id="+encodeURIComponent(id);
		url += "&tab_num="+encodeURIComponent(tab_num);
		if(svcaction != null && svcaction != ""){
			url += "&svcaction="+encodeURIComponent(svcaction);
		}

		var screenwidth = window.innerWidth;
		if(screenwidth <= 1218){
			url += "&isMobile=true";
		}else{
			url += "&isMobile=false";
		}

		var loading_el = document.getElementById('ajax_area'+bibid+tab_num);
		
		var div_parent = document.createElement("DIV");
		div_parent.innerHTML = "<div class=\"loading\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
		var div = div_parent.childNodes[0];
		var odiv = loading_el.previousElementSibling;
		var divwidth = odiv.offsetWidth;
		var divheight = odiv.offsetHeight;

		div.style.left = (divwidth/2) +"px";
		div.style.height  = (divheight) +"px";
		$(div).css("position","relative");
		
		loading_el.appendChild(div_parent);
		
		$.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				//document.getElementById('ajax_area'+bibid+tab_num).innerHTML = data;
				$('#ajax_area'+bibid+tab_num).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	function opacAjaxMulti(ids,formkeyno,id,tab_num,svcaction){
		url = "/exmsrh.do?";
		url += "formkeyno="+encodeURIComponent(formkeyno);
		url += "&block_id="+encodeURIComponent(id);
		url += "&tab_num="+encodeURIComponent(tab_num);
		if(svcaction != null && svcaction != ""){
			url += "&svcaction="+encodeURIComponent(svcaction);
		}
		
		for(var i = 0; i < ids.length ;i++){
			url += "&ids="+encodeURIComponent(ids[i]);
		}
		
		var buf = ids[0].split("|");

		if(document.getElementById('opacAjaxDispButton'+id+tab_num) != null){
			var loading_el = document.getElementById('opacAjaxDispButton'+id+tab_num);
		}else{
			var loading_el = document.getElementById('ajax_area'+buf[0]+id+tab_num);
		}
		
		var div_parent = document.createElement("DIV");
		div_parent.innerHTML = "<div class=\"loading\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
		var div = div_parent.childNodes[0];
		Element.addClassName(div,"loading");
		var loading_imege_offset_x = 8;
		var loading_imege_offset_y = 8;
		
		var offset = Position.cumulativeOffset(loading_el);

		var ex1 = offset[0];
		var ey1 = offset[1];

		div.style.left = (ex1 + (loading_el.offsetWidth/2) - loading_imege_offset_x) +"px";
		div.style.top  = (ey1 + (loading_el.offsetHeight/2) - loading_imege_offset_y + 10) +"px";
		
		loading_el.appendChild(div_parent);
		
		var top_el = document.getElementById(id);
		var params = new Object();
		params["param"] = "v3search_action_main_ajax&target=opac" + "&url=" + encodeURIComponent(url);
		params["method"] = "post";
		params["top_el"] = top_el;
		params["target_el"] = document.getElementById('ajax_area'+buf[0]+id+tab_num);
		params["callbackfunc"] = function(res){
			
			for(var i = 0; i < ids.length ;i++){
				var buf = ids[i].split("|");
				if(buf != null && buf.length > 0){
					var target_area = document.getElementById('ajax_area'+buf[0]+id+tab_num);
					var target_mod = document.getElementById('exmsrh_area'+buf[0]+id+tab_num);
					if(target_area != null && target_mod != null){
						target_area.insertBefore(target_mod, target_area.firstChild);
					}
				}
			}
			
			
			
			Element.remove(div);
		};

		commonCls.send(params);
	}

	// 所在情報表示(同一資料複数HIT対応版)
	function opacAjax_numplus(bibid,gcattp,id,tab_num,svcaction,volbr,num){
		url = "https://www.lib.kansai-u.ac.jp/webopac/extsrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		url += "&gcattp="+encodeURIComponent(gcattp);
		url += "&block_id="+encodeURIComponent(id);
		url += "&tab_num="+encodeURIComponent(tab_num);
		url += "&fvol="+encodeURIComponent(opacEscapeToMeta(volbr));
		if(svcaction != null && svcaction != ""){
			url += "&svcaction="+encodeURIComponent(svcaction);
		}
		
		var loading_el = document.getElementById('ajax_area'+num+bibid+id+tab_num);
		
		var div_parent = document.createElement("DIV");
		div_parent.innerHTML = "<div class=\"loading\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
		var div = div_parent.childNodes[0];
		var odiv = loading_el.previousElementSibling;
		var divwidth = odiv.offsetWidth;
		var divheight = odiv.offsetHeight;

		div.style.left = (divwidth/2) +"px";
		div.style.height  = (divheight) +"px";
		$(div).css("position","relative");

		loading_el.appendChild(div_parent);

		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				jQuery('#ajax_area'+num+bibid+id+tab_num).html(data);
				jQuery(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				jQuery(div).remove();
			}
		});
		
	}

	function opacRblsrh(bibid,id,tab_num,formkeyno){
		
		url = "https://www.lib.kansai-u.ac.jp/webopac/rblsrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		url += "&tab_num="+encodeURIComponent(tab_num);
		url += "&formkeyno="+encodeURIComponent(formkeyno);
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"get",
			cache: false,
			success: function(data, textStatus){
				jQuery('#ajax_rbl_workspace'+bibid+id+tab_num).html(data);
				dispAjaxRblWorkData(bibid, id, tab_num);
			},
			error: function(xhr, textStatus, errorThrown){
			}
		});
	}

	// もくじあらすじ、表紙取得処理(同一資料複数HIT対応版)
	function opacRblsrh_numplus(bibid,id,tab_num, num){
		
		url = "https://www.lib.kansai-u.ac.jp/webopac/rblsrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		url += "&tab_num="+encodeURIComponent(tab_num);
		url += "&num="+encodeURIComponent(num);
		url += "&notsave_flg=true";
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"get",
			cache: false,
			success: function(data, textStatus){
				document.getElementById('ajax_rbl_workspace'+num+bibid+id+tab_num).innerHTML = data;
			},
			error: function(xhr, textStatus, errorThrown){
			}
		});
	}

	
	function dispAjaxRblWorkData(bibid, id, tab_num) {
		var rbl_area = document.getElementById('ajax_rbl_area'+bibid+id+tab_num);
		var rbl_work = document.getElementById('ajax_rbl_work'+bibid+id+tab_num);
		if(rbl_area != null && rbl_work != null){
			rbl_area.appendChild(rbl_work);
		}
		var img_area = document.getElementById('ajax_img_area'+bibid+id+tab_num);
		var img_work = document.getElementById('ajax_img_work'+bibid+id+tab_num);
		if(img_area != null && img_work != null){
			img_area.appendChild(img_work);
		}
		var cte_area = document.getElementById('ajax_cte_area'+bibid+id+tab_num);
		var cte_work = document.getElementById('ajax_cte_work'+bibid+id+tab_num);
		if(cte_area != null && cte_work != null){
			cte_area.appendChild(cte_work);
		}
	}
	
	function opacCatcteAjax(isbn_issn,ncid,locale,id,ajax_area){
		var url = "catcte.do?check=0";
		url += "&isbn_issn="+encodeURIComponent(isbn_issn);
		url += "&ncid="+encodeURIComponent(ncid);
		url += "&locale="+encodeURIComponent(locale);

		var div = ajaxLoading(ajax_area);

		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				document.getElementById(ajax_area).innerHTML = data;
				$(div).remove();
				},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
				}
		});
	}

	function opacCatctePopup(isbn_issn,ncid,locale,id,event){
		url = "catcte.do?check=0";
		url += "&isbn_issn="+encodeURIComponent(isbn_issn);
		url += "&ncid="+encodeURIComponent(ncid);
		url += "&locale="+encodeURIComponent(locale);

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data,true);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}

	// 書誌詳細画面のレビュー一覧[Ajax]
	function opacRevsrxAjax(bibid,volbr,isbn,id,ajax_area,svcaction){
		window.addEventListener('load', function(){
			url = "key=logoff";
			url += "&bibid="+encodeURIComponent(bibid);
			url += "&volbr="+encodeURIComponent(volbr);
			url += "&isbn="+encodeURIComponent(isbn);
			url += "&block_id="+encodeURIComponent(id);
			if(svcaction != null && svcaction != ""){
				url += "&svcaction="+encodeURIComponent(svcaction);
			}
			var parentnode = document.getElementById(ajax_area).parentNode;
			var loadingarea = parentnode.querySelector("#load");
			if (loadingarea == null) {
				var loading_el = document.getElementById(ajax_area);
				var div_parent = document.createElement("DIV");
				div_parent.innerHTML = "<div class=\"loading\" id=\"load\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
				var div = div_parent.childNodes[0];
				var loading_imege_offset_x = 8;
				var loading_imege_offset_y = 8;

				var divwidth = parentnode.offsetWidth;
				var divheight = parentnode.offsetHeight;

				div.style.left = (divwidth/2 - loading_imege_offset_x) +"px";
				div.style.top  = (divheight/2 - loading_imege_offset_y) +"px";
				$(div).css("position","relative");

				loading_el.appendChild(div_parent);
			}
			
			$.ajax({
				url: "revsrx.do?"+url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					document.getElementById(ajax_area).innerHTML = data;
					$(div).remove();
				},
				error: function(xhr, textStatus, errorThrown){
					$(div).remove();
				}
			});
		});
	}

	// 書誌詳細画面の総合評価[Ajax]
	function opacRevsrxAjaxAvg(bibid,id,ajax_area){
		window.addEventListener('load', function(){
			url = "key=logoff";
			url += "&bibid="+encodeURIComponent(bibid);
			url += "&block_id="+encodeURIComponent(id);
			url += "&mode=avg";

			var div = ajaxLoading(ajax_area);
			$.ajax({
				url: "revsrx.do?"+url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					document.getElementById(ajax_area).innerHTML = data;
					$(div).remove();
				},
				error: function(xhr, textStatus, errorThrown){
					$(div).remove();
				}
			});
		});
	}

	function opacSessrhAjax(bibid,stposVol,id,ajax_area){
		url = "sessrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		url += "&stposVol="+encodeURIComponent(stposVol);

		var div = ajaxLoading(ajax_area);
		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				$("#"+ajax_area).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	function opacSfxsrhAjax(bibid,stposVol,id,ajax_area){
		url = "sfxsrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		url += "&stposVol="+encodeURIComponent(stposVol);

		var div = ajaxLoading(ajax_area);

		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				$("#"+ajax_area).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}
	
	function opacSylsrhAjax(bibid,ajax_area){
		url = "sylsrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		var div = ajaxLoading(ajax_area);

		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				$("#"+ajax_area).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}
	
	function opacRessrhAjax(bibid,ajax_area){
		url = "ressrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		var div = ajaxLoading(ajax_area);

		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				$("#"+ajax_area).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	function opacImgdtlAjax(isbn,ncid,txtl,id,tab_num,ajax_area,size){
		window.addEventListener('load', function(){
			var url = "";
			url += "block_id="+encodeURIComponent(id);
			url += "&tab_num="+encodeURIComponent(tab_num);
			url += "&isbn="+encodeURIComponent(isbn);
			url += "&ncid="+encodeURIComponent(ncid);
			if(txtl != null){
				url += "&txtl="+encodeURIComponent(txtl);
			}
			if(size != null){
				url += "&size="+encodeURIComponent(size);
			}
			var div = ajaxLoading(ajax_area);
			$.ajax({
				url: "casimg.do?="+url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					$("#"+ajax_area).html(data);
					$(div).remove();
				},
				error: function(xhr, textStatus, errorThrown){
					$(div).remove();
				}
			});
		});
	}

	function opacShowPopup(id,event) {
		var params = new Object();
		params["action"] = "v3search_view_main_popup";
		params["prefix_id_name"] = "v3search";

		var popupParams = new Object();
		var top_el = document.getElementById(id);
		popupParams['top_el'] = top_el;
		popupParams['target_el'] = top_el;
		popupParams['center_flag'] = true;
		popupParams['modal_flag'] = true;
		commonCls.sendPopupView(event, params, popupParams);
	}

	function opacSetHash(id,hash){
	}

	function opacSetFormkeyno(id,formkeyno){
		var tab_num = this.disp_num;
		this.formList[tab_num] = formkeyno;
	}

	function niiSetListcnt(listcnt,id,form_name){
		var search_form = document.getElementById(form_name);
		search_form.listcnt.value = listcnt;
		sendNiiSearch_formkey(search_form,id);
	}

	function niiSetStartpos(startpos,id,form_name){
		var search_form = document.getElementById(form_name);
		search_form.startpos.value = startpos;
		search_form.initFlg.value = "_RESULT_SET_NOTBIB";
		sendNiiSearch_formkey(search_form,id);
	}

	function sendNiiSearch_formkey(form_el,id){
		this.old_search_form = form_el;
		this.opac_block_id = id.replace("_","");
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);

		document.getElementById('search_page'+id+this.disp_num).innerHTML = '';
		document.getElementById('opt_page'+id+this.disp_num).innerHTML = '';

		var search_form = form_el;
		search_form.startpos.value = form_el.startpos.value;
		search_form.initFlg.value = form_el.initFlg.value;
		search_form.listcnt.value = form_el.listcnt.value;
		search_form.method = "POST";
		search_form.target_el = document.getElementById('search_page'+id+this.disp_num);

		search_form.action = "https://www.lib.kansai-u.ac.jp/webopac/ctnsrh.do";
		search_form.submit();
	}

	function niiCatdbn(id,bibid,startpos,hitcnt,form_id,svcaction,load_point,formkeyno){
		if(bibid != null && bibid != ""){
			opacSetHash(id,"#catdbn-"+bibid);
		}
		
		var url = "";

		if(bibid != null){
			url += "&bibid=" + encodeURIComponent(bibid);
			url += "&pkey=" + encodeURIComponent(bibid);
		}

		var add_url = "";
		if(form_id != null){
			var form_el_add = document.getElementById(form_id);
			add_url = "&" + jQuery(form_el_add).serialize();
		}

		if(add_url == ""){
			add_url += "&initFlg=" + encodeURIComponent("_RESULT_SET_NOTBIB");
		}
		if(startpos != null){
			add_url += "&startpos=" + encodeURIComponent(startpos);
		}
		if(hitcnt != null){
			add_url += "&hitcnt=" + encodeURIComponent(hitcnt);
		}
		
		if(svcaction != null){
			add_url += "&svcaction=" + encodeURIComponent(svcaction);
		}

		url += "&url=" + add_url;

		var tab_num = this.disp_num;
		if(formkeyno != null){
			var fkn_enc = "&formkeyno="+encodeURIComponent(formkeyno);
			url += fkn_enc;
		}

		var catdbn_url = "https://www.lib.kansai-u.ac.jp/webopac/catdbn.do?" + url;
		location.href = catdbn_url;
	}

	function niiCatdan(id,linkid,form_id){
		if(linkid != null && linkid != ""){
			opacSetHash(id,"#catdal-"+linkid);
		}
		
		var url = "";

		if(linkid != null){
			url += "&linkid=" + encodeURIComponent(linkid);
		}

		var add_url = "";
		if(form_id != null){
			var form_el = document.getElementById(form_id);
			add_url = $(form_el).serialize();
		}

		url += "&url=" + encodeURIComponent(add_url);

		var tab_num = this.disp_num;
		var formkeyno = this.formList[tab_num];
		if(formkeyno != null){
			var fkn_enc = "&formkeyno="+encodeURIComponent(formkeyno);
			url += encodeURIComponent(fkn_enc);
		}

		document.getElementById('detail_area'+id).style.display = 'block';

		var top_el = document.getElementById(id);
		var params = new Object();
		params["param"] = "v3search_view_main_catdan"+url;
		params["method"] = "get";
		params["loading_el"] = top_el;
		params["loading_x"] = document.documentElement.clientWidth / 2 + document.documentElement.scrollLeft;
		params["loading_y"] = document.documentElement.clientHeight / 2 + document.documentElement.scrollTop;
		params["top_el"] = top_el;
		params["target_el"] = document.getElementById('detail_area'+id);
		params["callbackfunc"] = function(res){
			hiddenSearchModule(id);
			if(linkid != null && linkid != ""){
				opacSetHash(id,"#catdal-"+linkid);
			}
		};

		commonCls.send(params);
	}

	function niiCatdhn(id,event,bibid,holid){
		var url = "catdhn.do?";
		url += "pkey="+encodeURIComponent(bibid);
		url += "&pkeyHol="+encodeURIComponent(holid);

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			type:"post",
			success: function(data, textStatus){
				PopUpOpenAjax(data);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}

	function changeCatSrcCode(id,clscode) {
//			var params = new Object();
//			params["action"] = "v3search_view_main_catsrc";
//			params["clscode"] = clscode;
//			commonCls.sendView(id, params);
		
		changeHref(id,"catsrc","&clscode="+clscode);
	}

	function changeLnkLstFunc(id,lnkfunc) {
//			var params = new Object();
//			params["action"] = "v3search_view_main_lnklst";
//			params["lnkfunc"] = lnkfunc;
//			commonCls.sendView(id, params);
		
		changeHref(id,"lnklst","&lnkfunc="+lnkfunc);
	}

	function showCatSrcLocalResult(form_el, id, clscode) {
		if (form_el.clsdata.value == "") {
			return;
		}
		form_el.cls.value = clscode + "\ " + form_el.clsdata.value + "*";
		
		sendOpacSearch_Field(form_el, id);
	}

	function showLnkLstLocalResult(id,lnkfunc,groupno,itemno) {	
		var url = "https://www.lib.kansai-u.ac.jp/webopac/lnkexe.do?";
		url += "lnkfunc=" + encodeURIComponent(lnkfunc);
		url += "&groupno=" + encodeURIComponent(groupno);
		url += "&itemno=" + encodeURIComponent(itemno);

		location.href = url;
	}

	function dspclvByholid(form_id, action, bibid, holid, stposHol){
		var w;
		document.getElementById(form_id).action=action;
		document.getElementById(form_id).target='Dspclv';
		document.getElementById(form_id).pkey.value=bibid;
		document.getElementById(form_id).pkeyHol.value=holid;
		document.getElementById(form_id).stposHol.value=stposHol;
		w = window.open("", document.getElementById(form_id).target, "location=yes, toolbar=no, directories=no, menubar=no, status=no, resizable=yes, scrollbars=yes, width=225,height=520");
		document.getElementById(form_id).hitcntHol.value='';
		document.getElementById(form_id).initFlg.value='';
		document.getElementById(form_id).submit();
		document.getElementById(form_id).target='';
		w.focus();
	}

	function clssrhPopup(id, event, form_id, clscode){
		if (clscode != '' && !$('#popupDialogArea').is(':empty')) {
			closePopupDialog();
			if(document.createEvent){
				var event = document.createEvent("MouseEvent");
			}else{
				var event = document.createEventObject();
			}
		}
		
		var params = new Object();
		params["action"] = "v3search_view_main_clssrh";
		params["formname"] = form_id;
		params["prefix_id_name"] = "clssrh";
		params["clscode"] = clscode;
		
		var popupParams = new Object();
		var top_el = document.getElementById(id);
		popupParams['top_el'] = top_el;
		popupParams['target_el'] = top_el;
		popupParams['modal_flag'] = true;
		popupParams["loading_el"] = top_el;
		popupParams["loading_x"] = document.documentElement.clientWidth / 2 + document.documentElement.scrollLeft;
		popupParams["loading_y"] = document.documentElement.clientHeight / 2 + document.documentElement.scrollTop;
		popupParams["request_url"] = "https://www.lib.kansai-u.ac.jp/webopac/clssrh.do";
		
		sendPopupView(event, params, popupParams, true);
	}

	function setcls(id, pform_id, cform_id, clscode){
		var pform_el = document.getElementById(pform_id);
		var cform_el = document.getElementById(cform_id);

		if (cform_el.clsdata.value == ""){
			return;
		}
		
		if (pform_id.indexOf("opac") == 0 || pform_id.indexOf("nii") == 0) {
			$inpcls = $('input[name="cls"]:enabled', $(pform_el));
			if(pform_id.indexOf("opac_newlst") == 0 || pform_id.indexOf("opac_beslst") == 0){
				$inpcls.val(cform_el.clsdata.value+"*");
			}else{
				$inpcls.val(clscode +"\ "+cform_el.clsdata.value+"*");
			}
		} else if (pform_id.indexOf("newbesform") == 0) {
			if(pform_el.cls.length > 1){
				pform_el.cls[0].value = cform_el.clsdata.value+"*";
				pform_el.cls[1].value = cform_el.clsdata.value+"*";
			} else {
				pform_el.cls.value = cform_el.clsdata.value+"*";
			}
		} else {
			pform_el.cls.value = cform_el.clsdata.value+"*";
		}

		closePopupDialog();
	}


	function showArea(tgt,area_id){
		closeOtherArea(tgt,area_id);
		setActive(tgt);
		var area = document.getElementById(area_id);
		if(area.style.display == "none"){
			area.style.display = "block";
		}else{
			area.style.display = "none";
		}
	}

	function closeOtherArea(tgt,area_id){
		var area = document.getElementById("cls_area");
		var tds = area.getElementsByTagName('td');
		for (i=0; i < tds.length; i++){
			var td = tds[i];

			if(td.id != "" && td.id != area_id && area_id.indexOf(td.id) == -1){
				td.style.display = "none"

				var elms = $(".active", $(td));
				elms.each(function(index, element) {
					$(element).removeClass("active");
				});
			}
		}
		clearActive(tgt);
	}
	function setActive(tgt) {
		clearActive(tgt);
		$(tgt).toggleClass("active");
		var parent_td = tgt.parentNode.parentNode;
		if ($(parent_td).next().length > 0) {
			if ($("table", $(parent_td).next()).length > 0) {
				var p = tgt.parentNode;
				$(p).toggleClass("active");
			}
	    }
		return false;
	}
	function clearActive(tgt) {
		var tgt_tr = tgt.parentNode.parentNode.parentNode;
		var elms = $(tgt_tr).siblings();
		elms.each(function(index, element) {
			var acts = $(".active", $(element));
				acts.each(function(index, act) {
					$(act).removeClass("active");
			});
		});
		return false;
	}

	function displayClsCode(display_id, display){
		var clsStylePlus = document.getElementById(display_id + "Plus");
		var clsStyleMinus = document.getElementById(display_id + "Minus");
		
		if (!clsStylePlus || !clsStyleMinus) {
			return;
		}
		
		if (display == 'open') {
			clsStylePlus.style.display = "none";
			clsStyleMinus.style.display = "block";
		} else {
			clsStylePlus.style.display = "block";
			clsStyleMinus.style.display = "none";
		}
	}

	// 分類参照パンくずリストを設定
	function setClsHistory(form_id, cls_data, cls_history){
		var form_el = document.getElementById(form_id);
		form_el.clsdata.value = cls_data;
		form_el.clsHistory.value = cls_history;
	}

	function changeClsHighlight(lnkCls_id, cls_history_list, highlight_color, reset_color){
		var lnkCls_el = document.getElementById(lnkCls_id);
		resetClsHighlight(lnkCls_el, highlight_color, reset_color);
		
		var highLightList = cls_history_list.split(" ");
		for (i=0; i < highLightList.length; i++) {
			var highLigh_el1 = document.getElementById(lnkCls_id + highLightList[i] + "Plus");
			var highLigh_el2 = document.getElementById(lnkCls_id + highLightList[i] + "Minus");
			if (highLigh_el1) {
				highLigh_el1.style.backgroundColor = highlight_color;
			}
			if (highLigh_el2) {
				highLigh_el2.style.backgroundColor = highlight_color;
			}
		}
	}

	function resetClsHighlight(lnkCls_el, highlight_color, reset_color) {
		if (!lnkCls_el) {
			return;
		}
		
		var childs = lnkCls_el.childNodes;
		for (var i=0; i < childs.length; i++) {
			var child_el = childs[i];
			if (!child_el) {
				continue;
			}
			if (!child_el.id) {
				continue;
			}
			
			child_el.style.backgroundColor = reset_color;
			
			resetClsHighlight(child_el, highlight_color, reset_color);
		}
	}

	// レビュー一覧画面表示
	function opacRevsra(id,startpos,sortkey,listcnt){
		var url = "&stposRevlsa="+encodeURIComponent(startpos)+"&sortkeyRevlsa="+encodeURIComponent(sortkey)+"&listcntRevlsa="+encodeURIComponent(listcnt);
		var revsra_url = "https://www.lib.kansai-u.ac.jp/webopac/revsra.do?" + url;
		location.href = revsra_url;
	}

	// 書誌レビュー一覧画面表示(レビュー一覧画面経由)
	function opacRevsrh(id,formkeyno,bibid,volbr,isbn,revid,stpos,sortkey,listcnt,svcaction){
		
		var url = "";
		if(formkeyno != null){
			url += "&formkeyno="+encodeURIComponent(formkeyno);
		}
		if(bibid != null){
			url += "&pkey="+encodeURIComponent(bibid);
		}
		if(volbr != null){
			url += "&pkeyVol="+encodeURIComponent(volbr);
		}
		if(isbn != null){
			url += "&pkeyIsbn="+encodeURIComponent(isbn);
		}
		if(revid != null){
			url += "&pkeyRevid="+encodeURIComponent(revid);
		}
		if(stpos != null){
			url += "&stposRev="+encodeURIComponent(stpos);
		}
		if(sortkey != null){
			url += "&sortkeyRev="+encodeURIComponent(sortkey);
		}
		if(listcnt != null){
			url += "&listcntRev="+encodeURIComponent(listcnt);
		}
		if(svcaction != null && svcaction != ""){
			url += "&svcaction="+encodeURIComponent(svcaction);
		}
		
		var revsrh_url = "https://www.lib.kansai-u.ac.jp/webopac/revsrh.do?" + url;
		location.href = revsrh_url;
	}

	// 書誌レビュー一覧画面表示(書誌詳細画面のレビュー一覧[Ajax]経由)
	function opacRevsrh2(id,revid,stpos,sortkey,listcnt,form_id){

		var add_url = "";
		var form_el = document.getElementById(form_id);
		add_url += jQuery(form_el).serialize();

		var url = "&"+add_url+"&pkeyRevid="+encodeURIComponent(revid)+"&stposRev="+encodeURIComponent(stpos)+"&sortkeyRev="+encodeURIComponent(sortkey)+"&listcntRev="+encodeURIComponent(listcnt);
		
		var revsrh_url = "https://www.lib.kansai-u.ac.jp/webopac/revsrh.do?" + url;
		location.href = revsrh_url;
	}

	// レビュー詳細画面表示(書誌レビュー一覧画面経由)
	function opacRevdbl(id,formkeyno,stposCmt,stposRev,svcaction){
		
		var url = "";
		if(formkeyno != null){
			url += "&formkeyno="+encodeURIComponent(formkeyno);
		}
		if(stposCmt != null){
			url += "&stposCmt="+encodeURIComponent(stposCmt);
		}
		if(stposRev != null){
			url += "&stposRev="+encodeURIComponent(stposRev);
		}
		if(svcaction != null && svcaction != ""){
			url += "&svcaction="+encodeURIComponent(svcaction);
		}
		
		var revdbl_url = "https://www.lib.kansai-u.ac.jp/webopac/revdbl.do?" + url;
		location.href = revdbl_url;
	}

	// レビュー詳細画面表示(レビュー一覧画面経由)
	function opacRevdbl2(id,formkeyno,stposCmt,stposRev,stposRevlsa){
		
		var url = "&formkeyno="+encodeURIComponent(formkeyno)+"&stposCmt="+encodeURIComponent(stposCmt)+"&stposRev="+encodeURIComponent(stposRev)+"&stposRevlsa="+encodeURIComponent(stposRevlsa);
		
		var revdbl_url = "https://www.lib.kansai-u.ac.jp/webopac/revdbl.do?" + url;
		location.href = revdbl_url;
	}

	// レビュー詳細画面表示(書誌詳細画面のレビュー一覧[Ajax]経由)
	function opacRevdbl3(id,stposCmt,stposRev,sortkey,listcnt,form_id){
		
		var add_url = "";
		var form_el = document.getElementById(form_id);
		add_url += jQuery(form_el).serialize();

		var url = "&"+add_url+"&stposCmt="+encodeURIComponent(stposCmt)+"&stposRev="+encodeURIComponent(stposRev)+"&sortkeyRev="+encodeURIComponent(sortkey)+"&listcntRev="+encodeURIComponent(listcnt);

		var revdbl_url = "https://www.lib.kansai-u.ac.jp/webopac/revdbl.do?" + url;
		location.href = revdbl_url;
	}

	// 新着一覧画面表示
	function newlst_sendOpacSearch(id, form_name){
		var form = document.getElementById(form_name);
		form.action = "https://www.lib.kansai-u.ac.jp/webopac/newexe.do";
		form.method = "POST";
		form.submit();
	}

	// 新着一覧の資料種別チェック 全て
	function newlst_opacCheckAll(form_id, name){
		var form = document.getElementById(form_id);
		form["gcattp_flag"].checked = true;
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				form[name][i].checked = false;
			}
		}else{
			form[name].checked = false;
		}
	}

	// 新着一覧の資料種別チェック 各個
	function newlst_opacCheckEach(form_id, name){
		var form = document.getElementById(form_id);
		var cnt = 0;
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				if(form[name][i].checked){
					cnt++;
				}
			}
		}else{
			if(form[name].checked){
				cnt++;
			}
		}
		if(cnt > 0){
			form["gcattp_flag"].checked = false;
		}else{
			form["gcattp_flag"].checked = true;
		}
	}

	// 新着一覧 レコード全てチェック付ける・外す
	function newlst_checkBibid(form_id, func){
		var boxs = document.getElementById(form_id).elements['bibid[]'];
		if(boxs.length){
			for(num=0; num < boxs.length; num++){
				boxs[num].checked = func;
			}
		}else{
			boxs.checked = func;
		}
	}

	// 新着一覧 表示件数変更
	function newlst_opacSetListcnt(listcnt, id, form_name){
		var form = document.getElementById(form_name);
		form.listcnt.value = listcnt;
		form.stpos.value = "1";
		newlst_sendOpacSearch(id,form_name);
	}

	// 新着一覧 ページ移動
	function newlst_opacSetStartpos(stpos, id, form_name){
		var form = document.getElementById(form_name);
		form.stpos.value = stpos;
		newlst_sendOpacSearch(id,form_name);
	}

	// 貸出ランキング一覧画面表示
	function beslst_sendOpacSearch(id, form_name){
		var form = document.getElementById(form_name);
		form.action = "https://www.lib.kansai-u.ac.jp/webopac/besexe.do"
		form.method = "POST";
		form.submit();
	}

	// 貸出ランキング一覧の資料種別チェック 全て
	function beslst_opacCheckAll(form_id, name){
		var form = document.getElementById(form_id);
		form["gcattp_flag"].checked = true;
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				form[name][i].checked = false;
			}
		}else{
			form[name].checked = false;
		}
	}

	// 貸出ランキング一覧の資料種別チェック 各個
	function beslst_opacCheckEach(form_id, name){
		var form = document.getElementById(form_id);
		var cnt = 0;
		if(form[name].length){
			for(var i = 0; i < form[name].length; i++){
				if(form[name][i].checked){
					cnt++;
				}
			}
		}else{
			if(form[name].checked){
				cnt++;
			}
		}
		if(cnt > 0){
			form["gcattp_flag"].checked = false;
		}else{
			form["gcattp_flag"].checked = true;
		}
	}

	// 貸出ランキング一覧 レコード全てチェック付ける・外す
	function beslst_checkBibid(form_id, func){
		var boxs = document.getElementById(form_id).elements['bibid[]'];
		if(boxs.length){
			for(num=0; num < boxs.length; num++){
				boxs[num].checked = func;
			}
		}else{
			boxs.checked = func;
		}
	}

	// 貸出ランキング一覧 表示件数変更 
	function beslst_opacSetListcnt(listcnt, id, form_name){
		var form = document.getElementById(form_name);
		form.listcnt.value = listcnt;
		form.stpos.value = "1";
		beslst_sendOpacSearch(id,form_name);
	}

	// 貸出ランキング一覧 ページ移動 
	function beslst_opacSetStartpos(stpos, id, form_name){
		var form = document.getElementById(form_name);
		form.stpos.value = stpos;
		beslst_sendOpacSearch(id,form_name);
	}

	function PopUpClose(){
		var popup = document.getElementById("popup");
		if(popup != null){
			document.body.removeChild(popup);
		} else {
			closePopupDialog();
		}
	}

	function opacCatlanPopup(id,event){
		url = "/catlan.do";
		
		var params = new Object();
		params["target"] = "opac";
		params["url"] = url;

		var popupParams = new Object();
		var top_el = document.getElementById(id);
		popupParams['top_el'] = top_el;
		popupParams['target_el'] = top_el;
		popupParams['center_flag'] = true;
		popupParams['modal_flag'] = true;
		popupParams["request_url"] = "https://www.lib.kansai-u.ac.jp/webopac/catlan.do";
		
		sendPopupView(event, params, popupParams, true);
	}

	function opacLanguageCode(id,form_el){
		var dispFormId = getCurrentlyDisplayedSearchTabFormId();
		var $main_target = $('input[name="lang"]:enabled', $('#'+dispFormId));
		var langcode = form_el.langcode;
		var sb = "";
		var num;
		if(langcode.length){
			for(num=0; num < langcode.length; num++){
				if(langcode[num].checked){
					if(sb.length != 0 ){
						if(sb.indexOf(langcode[num].value,0) == -1){
						sb += "+";
						}
					}
					if(sb.indexOf(langcode[num].value,0) == -1){
						sb += langcode[num].value;
					}
				}
			}
			$main_target.val(sb);
			
		}else{
			if(langcode.checked){
				$main_target.val(langcode.value);
			}
		}
		closePopupDialog();
	}

	function opacLanguageInit(id,form_el){
		var dispFormId = getCurrentlyDisplayedSearchTabFormId();
		var $main_target = $('input[name="lang"]:enabled', $('#'+dispFormId));
		if($main_target.val() != null && $main_target.val() != ""){
			var langcode = jQuery(form_el).find('input[name="langcode"]');
			var codes = $main_target.val().split("+");
			for(var i = 0 ; i < codes.length ; i++){
				if(langcode.length){
					for(var num = 0 ; num < langcode.length ; num++){
						if(codes[i] == langcode[num].value){
							langcode[num].checked = true;
							break;
						}
					}
				}else{
					if(codes[i] == langcode.value){
						langcode.checked = true;
						break;
					}
				}
			}
		}
	}

	function opacCatcouPopup(id,event){
		var url = "/catcou.do";
		
		var params = new Object();
		params["target"] = "opac";
		params["url"] = url;

		var popupParams = new Object();
		var top_el = document.getElementById(id);
		popupParams['top_el'] = top_el;
		popupParams['target_el'] = top_el;
		popupParams['center_flag'] = true;
		popupParams['modal_flag'] = true;
		popupParams["request_url"] = "https://www.lib.kansai-u.ac.jp/webopac/catcou.do";
		
		sendPopupView(event, params, popupParams, true);
	}

	function opacCountryCode(id,form_el){
		var dispFormId = getCurrentlyDisplayedSearchTabFormId();
		var $main_target = $('input[name="cntry"]:enabled', $('#'+dispFormId));
		var cntrycode = form_el.cntrycode;
		var sb = "";
		if(cntrycode.length){
			for(var num = 0 ; num < cntrycode.length ; num++){
				if(cntrycode[num].checked){
					if(sb.length != 0 ){
						if(sb.indexOf(cntrycode[num].value,0) == -1){
						sb += "+";
						}
					}
					if(sb.indexOf(cntrycode[num].value,0) == -1){
						sb += cntrycode[num].value;
					}
				}
			}
			$main_target.val(sb);
			
		}else{
			if(cntrycode.checked){
				$main_target.val(cntrycode.value);
			}
		}
		closePopupDialog();
	}

	function opacCountryInit(id,form_el){
		var dispFormId = getCurrentlyDisplayedSearchTabFormId();
		var $main_target = $('input[name="cntry"]:enabled', $('#'+dispFormId));
		if($main_target.val() != null && $main_target.val() != ""){
			var cntrycode = jQuery(form_el).find('input[name="cntrycode"]');
			var codes = $main_target.val().split("+");
			for(var i = 0 ; i < codes.length ; i++){
				if(cntrycode.length){
					for(var num = 0 ; num < cntrycode.length ; num++){
						if(codes[i] == cntrycode[num].value){
							cntrycode[num].checked = true;
							break;
						}
					}
				}else{
					if(codes[i] == cntrycode.value){
						cntrycode.checked = true;
						break;
					}
				}
			}
		}
	}

	function opacRcmclsAjax(id,bibid){
		var bib_id = bibid;
		var url = "/ajaxreccls.do?";
		url += "bibid="+encodeURIComponent(bib_id);
		url += "&block_id="+id.replace("_","");

		var top_el = document.getElementById(id);
		var params = new Object();

		params["param"] = "v3search_action_main_ajax&target=opac" + "&url=" + encodeURIComponent(url);
		params["method"] = "post";
		params["top_el"] = top_el;
		params["target_el"] = document.getElementById("rcmcls_result");
		params["loading_el"] = document.getElementById("rcmcls_result");

		commonCls.send(params);
		
	}

	function opacRcmclsAjax_hol(id,holids){
			var url = "";
			var holid_str = "";
			for(i=0; i<holids.length; i++){
				holid_str += encodeURIComponent(holids[i])+"+";
			}
			if(holid_str != ""){
				holid_str.replace("\\+$","");
				url += "holids="+holid_str+"&";
			}

			var div = ajaxLoading("rcmcls_result");

			$.ajax({
				url: "ajaxreccls.do?"+url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					jQuery("#rcmcls_result").html(data);
					$(div).remove();
				},
				error: function(xhr, textStatus, errorThrown){
					$(div).remove();
				}
			});
	}

	function opacRcmrccAjax(id,bibid){
		var url = "ajaxrecrcc.do?";
		url += "bibid="+encodeURIComponent(bibid);

		var div = ajaxLoading("rcmrcc_result");

		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				jQuery("#rcmrcc_result").html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
		
	}

	// 検索履歴検索 
	function opacHstexe(id,operand1,operand2,operator){
		var url = "";
		if(operand1 != null){
			url += "&operand1="+encodeURIComponent(operand1);
		}
		if(operand2 != null){
			url += "&operand2="+encodeURIComponent(operand2);
		}
		if(operator != null){
			url += "&operator="+encodeURIComponent(operator);
		}
		
		var hstexe_url = "https://www.lib.kansai-u.ac.jp/webopac/hstexe.do?" + url;
		location.href = hstexe_url;
	}

	// 検索履歴検索(書誌一覧へのリダイレクト用) 
	function sendOpacSearch_Hstexe(form_el,id,search_mode){
		this.old_search_form = form_el;
		this.opac_block_id = id.replace("_","");

		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		form_el.tab_num.value = this.disp_num;
		form_el.search_mode.value = search_mode;
		form_el.tab_detail_num.value = "1";
		form_el.startpos.value = "1";

		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ctlsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	// 検索履歴の「全てチェック」ボタンと「全て解除」ボタン 
	function checkHistory(form_id,func){
		var boxs = document.getElementById(form_id).history;
		if(boxs.length){
			for(num=0; num < boxs.length; num++){
				boxs[num].checked = func;
			}
		}else{
			boxs.checked = func;
		}
		document.getElementById(form_id).chkmaster.checked = func;
	}

	// 検索履歴のチェックボックス(全てon/off)の制御 
	function checkHistoryControll(form_id){
		var func=document.getElementById(form_id).chkmaster.checked;
		checkHistory(form_id,func);
	}

	// 検索履歴の一括削除 
	function opacHstDel(id,event,form_id){
		var form_el = document.getElementById(form_id);
		var param = jQuery(form_el).serialize();
		
		var url = "hstdel.do?";
		url += param;

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}

	// タグ検索画面 ページ移動 
	function tagsrh_opacSetSearch(mode, id, form_name){
		var form_el = document.getElementById(form_name);
		form_el.mode.value = mode;
		tagsrh_sendOpacSearch(form_el, id);
	}

	function showCatTagLocalResult(form_name, id, tag) {
		if (tag == "") {
			return;
		}
		var form_el = document.getElementById(form_name);
		form_el.srhclm1.value = "tag";
		form_el.valclm1.value = tag;
		sendOpacSearch_Field(form_el, id);
	}

	function bibidConvert(bibids,search_form,pkey){
		if(pkey == null){
			pkey = "bibid";
		}
		var formBibids = search_form[pkey];
		if(formBibids != null){
			for(var i = 0 ; i < bibids.length ; i++){
				if(formBibids.length){
					for(var j = 0 ; j < formBibids.length ; j++){
						if(formBibids[j].value == bibids[i]){
							formBibids[j].checked = true;
						}
					}
				}else{
					if(formBibids.value == bibids[i]){
						formBibids.checked = true;
						break;
					}
				}
			}
		}
	}

	function opacSetHoldispflg(id,flg){
		this.hol_disp_flg = flg;
	}

	function opacClnsChk(cln){
		var str = "";
		if(typeof(cln) != 'undefined'){
			str = cln.replace("<br>", "");
			//内容が空値の場合、全角SPACEを詰め
			if(str.replace(" ","")==""){
				str="　";
			}
		}else{
			str = "　";
		}
		return str;
	}

	function opacClnBlock(value_cln,delimiter,callno_cnt,event){
		//請求記号１
		var cln1 = "";
		//請求記号２
		var cln2 = "";
		//請求記号３
		var cln3 = "";
		//請求記号４
		var cln4 = "";
		
		//delimiterで請求記号値を分ける
		var clnArray = value_cln.split(delimiter);
		//請求記号１があれば
		cln1 = opacClnsChk(clnArray[0]);
		//請求記号２があれば
		cln2 = opacClnsChk(clnArray[1]);
		//請求記号３があれば
		cln3 = opacClnsChk(clnArray[2]);
		//請求記号４があれば
		cln4 = opacClnsChk(clnArray[3]);
		//請求記号１、２、３、４のいずれがあれば、ポップ画面を表示する
		if(cln1!="　"||cln2!="　"||cln3!="　"||cln4!="　"){
			//表示内容を編集
			var content = "";
			var clnArray_new = new Array(4);
			clnArray_new[0] = cln1;
			clnArray_new[1] = cln2;
			clnArray_new[2] = cln3;
			clnArray_new[3] = cln4;
			
			//パラメータに段数が4を超える場合、4を設定する
			if(callno_cnt > 4){
				callno_cnt = 4;
			}
			
			//ラベル内容の構築
			content += "<span class=\"cln_block\"><table>";
			for(var i = 0 ; i < callno_cnt ; i++){
				//最後の行の場合に、Endのタグを付く
				if(i + 1 == callno_cnt){
					content += "<tr><td nowrap>" + clnArray_new[i] + "</td></tr>";
					content += "</table></span>";
				//最後の行ではない場合に、表示クラスを指定して、下線を表示する
				}else{
					content += "<tr><td class=\"td_cln\" nowrap>" + clnArray_new[i] + "</td></tr>";
				}
			}
			
			var cln_popup = document.getElementById("cln_popup");
			if(cln_popup == null){
				cln_popup = document.createElement('div');
				cln_popup.id = "cln_popup";
				cln_popup.style.position = "absolute";
				document.body.appendChild(cln_popup);
			}
			
			cln_popup.innerHTML = content;
			var cx = event.clientX + (document.body.scrollLeft || document.documentElement.scrollLeft);
			var cy = event.clientY + (document.body.scrollTop  || document.documentElement.scrollTop);
			cln_popup.style.left = (cx + 6) + 'px';
			cln_popup.style.top = (cy + 6) + 'px';
			cln_popup.style.display = 'block';
		}
	}

	function opacClnRemove(){
		var cln_popup = document.getElementById("cln_popup");
		if(cln_popup != null){
			document.body.removeChild(cln_popup);
		}
	}

	function sendMailBibid(id,target,ajaxflg,bibid){
		if(target == "localbiblst"){
			bibid = bibid.replace(/sortkey.*?listcnt.*?&/,"&");
			bibid = bibid.replace(/bib/g,"");
			if(bibid.indexOf("&") != 0){
				bibid = "&"+bibid;
			}
		}else if (target == "newbest"){
			bibid = bibid.replace(/cls.*?listcnt.*?&/,"");
			bibid = bibid.replace(/&/g,"");
			bibid = bibid.replace(/bibid.*?=/g,"&id=");
			if(ajaxflg == true){
				var tmp = "";
				var bibids = bibid.split("&id=");
				for(var i = 0 ; i < bibids.length ; i++){
					if(bibids[i] != ""){
						var vol = document.getElementById("VOL_"+bibids[i]);
						if(vol != null){
							tmp += "&id="+bibids[i]+" "+vol.value;
						}
					}
				}
				bibid = tmp;
			}
		}else if (target == "niibiblst"){
			bibid = bibid.replace(/listcnt.*?&/,"&");
			bibid = bibid.replace(/bib/g,"");
		}else if (target == "browshis"){
			bibid = bibid.replace(/&/g,"");
			bibid = bibid.replace(/bib/g,"&");
		}else if (target == "linkbiblst"){
			bibid = bibid.replace(/startpos.*?listcnt.*?&/,"&");
			bibid = bibid.replace(/bib/g,"");
		}
		
		return bibid;
	}

	function opacCatfctAjax(id,tab_num,ajax_area,formkeyno){
		if(typeof (tab_num) == "undefined" || null ==tab_num){
			tab_num = this.disp_num;
		}
		
		var loading_el = document.getElementById(ajax_area);
		
		var div_parent = document.createElement("DIV");
		div_parent.innerHTML = "<div class=\"loading\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
		var div = div_parent.childNodes[0];

		var loading_imege_offset_x = 8;
		var loading_imege_offset_y = 8;
		var odiv = loading_el.parentNode;
		var divwidth = odiv.offsetWidth;
		var divheight = odiv.offsetHeight;

		div.style.left = (divwidth/2 - loading_imege_offset_x) +"px";
		div.style.top  = (divheight/2 - loading_imege_offset_y) +"px";
		$(div).css("position","relative");

		loading_el.appendChild(div_parent);
		
		$.ajax({
			url: "catfct.do?formkeyno="+formkeyno + "&tab_num="+tab_num,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				document.getElementById(ajax_area).innerHTML = data;
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
				
			}
		});
	}

	function opacCatSmlrAjax(id,tab_num,ajax_area,formkeyno){
		if(typeof (tab_num) == "undefined" || null ==tab_num){
			tab_num = this.disp_num;
		}
		
		var loading_el = document.getElementById(ajax_area);
		var div_parent = document.createElement("DIV");
		div_parent.innerHTML = "<div class=\"loading\" id=\"load\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
		var div = div_parent.childNodes[0];
		var loading_imege_offset_x = 8;
		var loading_imege_offset_y = 8;

		var areawidth = document.getElementById(ajax_area).offsetWidth;
		if(areawidth == 0){
			areawidth = document.body.offsetWidth;
		}

		var divheight = document.getElementById(ajax_area).offsetHeight;

		div.style.left = (areawidth/2 - loading_imege_offset_x) +"px";
		div.style.top  = (divheight/2 - loading_imege_offset_y) +"px";
		$(div).css("position","relative");
		loading_el.appendChild(div_parent);
		
		$.ajax({
			url: "catsmlr.do?formkeyno="+formkeyno + "&tab_num="+tab_num,
			cache: false,
			success: function(data, textStatus){
				document.getElementById(ajax_area).innerHTML = data;
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	function opacFctSearch(tab_num,target,value){
		opacFctSendRequest(tab_num, target, value);
	}

	function opacFctRemove(tab_num,target,index){
		opacFctSendRequest(tab_num, target, "removeIdx:" + index);
	}

	function opacFctSendRequest(tab_num, target, value) {
		var search_form = null;
		var tabs = document.getElementById('tab_area').getElementsByTagName('li');
		var id = tabs[tab_num].id;
		search_form = $("#"+id+"_tab_detail_form" + tab_num)[0];
		
		var fct_target = "fct_" + target;
		search_form[fct_target].value = value;
		search_form["fct_target_name"].value = fct_target;
		search_form["formkeyno"].value = "230937384hEweK39H5";
		search_form["search_mode"].value = this.disp_search_mode ? this.disp_search_mode : "simple";
		sendOpacSearch(search_form,id);
	}

	function opacBlfsrhInit(id,bibid,target) {
		var checkArea = document.getElementById("elibParent_check" + target);
		var resultArea = document.getElementById("elibParent_result" + target);
		
		opacBlfsrhTgl(target);
		checkArea.onclick = function(){opacBlfsrhTgl(target);}
		
		url = "blfsrh.do?bibid=" + encodeURIComponent(bibid);
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				resultArea.innerHTML = data;
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}

	function opacBlfsrhTgl(target){
		var checkArea = document.getElementById("elibParent_check" + target);
		var resultArea = document.getElementById("elibParent_result" + target);
		
		if(resultArea.style.display == "block"){
			resultArea.style.display = "none";
			checkArea.innerHTML = checkArea.innerHTML.replace("minus","plus");
		}else{
			resultArea.style.display = "block";
			checkArea.innerHTML = checkArea.innerHTML.replace("plus","minus");
		}
		return false;
	}

	function opacHollcCreate(form_el,id,tab_num,hollc){
		var pattern = new RegExp("/.*");
		if(form_el["holar"] != null && form_el["hollc"] != null){
			if(form_el["holar_flag"].checked != true){
				var target_holar = new Array();
				
				if(form_el["holar"].length){
					for(var i = 0 ; i < form_el["holar"].length ; i++){
						if(form_el["holar"][i].checked){
							target_holar.push(form_el["holar"][i].value);
						}
					}
				}else{
					if(form_el["holar"].checked){
						target_holar.push(form_el["holar"].value);
					}
				}
				
				var campus = form_el["campus"];
				if(campus != null && campus.length){
					for(var i = 0 ; i < campus.length ; i++) {
						var target_campus = "campus"+campus[i].value+tab_num;
						var boxs = document.getElementById(target_campus).getElementsByTagName('input');
						if(campus[i].checked){
							for(var j = 0; j < boxs.length; j++) {
								target_holar.push(boxs[j].value);
							}
						}
					}
				}
				
				form_el["hollc"].innerHTML = '';
				form_el["hollc"].appendChild(new Option("", ""));
				var select = document.getElementById("opac_hollc_select"+id+tab_num);
				for(var i = 0 ; i < select.options.length ; i++){
					var opt_value = select.options[i].value;
					if(opt_value != ""){
						var opt_holar = opt_value.replace(pattern,"");
						if(target_holar.indexOf(opt_holar) != -1){
							form_el["hollc"].appendChild(select.options[i].cloneNode(true));
						}
					}
				}
				form_el["hollc"].value = hollc;
			}
		}
	}

	function opacEscapeToMeta(str){
		str = str.replace(/&amp;/g,"&");
		str = str.replace(/&quot;/g,"\"");
		str = str.replace(/&#039;/g,"'");
		str = str.replace(/&#39;/g,"'");
		str = str.replace(/&lt;/g,"<");
		str = str.replace(/&gt;/g,">");
		
		return str;
	}

	// 書誌詳細画面の文脈表示一覧[Ajax] 
	function opacCtxsrhAjax(bibid,formkeyno,stposctx,ajax_area){
		url = "ctxsrh.do";
		url += "?pkey="+encodeURIComponent(bibid);
		url += "&formkeyno="+encodeURIComponent(formkeyno);
		url += "&stposCtx="+encodeURIComponent(stposctx);
		
		var div = ajaxLoading(ajax_area);
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				$("#"+ajax_area).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	// 参照ランキング一覧画面表示 
	function reflst_sendOpacSearch(id, form_name){
		var form = document.getElementById(form_name);
		form.action = "https://www.lib.kansai-u.ac.jp/webopac/reflst.do";
		form.method = "POST";
		form.submit();
	}

	// 参照ランキング一覧 表示件数変更 
	function reflst_opacSetListcnt(listcnt, id, form_name){
		var form = document.getElementById(form_name);
		form.listcnt.value = listcnt;
		form.stpos.value = "1";
		reflst_sendOpacSearch(id,form_name);
	}

	// 参照ランキング一覧 ページ移動 
	function reflst_opacSetStartpos(stpos, id, form_name){
		var form = document.getElementById(form_name);
		form.stpos.value = stpos;
		reflst_sendOpacSearch(id,form_name);
	}

	function opacAppendHiddenElement(form_el,name,value){
		if(form_el != null && name != null && value != null){
			var lElement = document.createElement('input');
			lElement.type = "hidden";
			lElement.name = name;
			lElement.value = value;
			form_el.appendChild(lElement);
		}
	}

	function opacGmdSmdCreate(form_el){
		if(form_el["gcattp_flag"] != null && form_el["gcattp"] != null && form_el["gmdsmd"] != null){
			if(!form_el["gcattp_flag"].checked){
				var gcattp = form_el["gcattp"];
				var target_gcattp = new Array();
				if(gcattp.length){
					for(var i = 0; i < gcattp.length; i++){
						if(gcattp[i].checked){
							target_gcattp.push(gcattp[i].value);
						}
					}
				}
				
				var gmdsmd = form_el["gmdsmd"];
				var options = gmdsmd.getElementsByTagName('option');
				if(gmdsmd.length){
					for(var i = gmdsmd.length - 1 ; i >= 0 ; i--){
						if(gmdsmd[i]){
							if(gmdsmd[i].id){
								var hiddenFlg = true;
								var gmdsmd_codes = gmdsmd[i].id.split(",");
								for(var j = 0; j < gmdsmd_codes.length; j++){
									if(target_gcattp.indexOf(gmdsmd_codes[j]) != -1){
										hiddenFlg = false;
										break;
									}
								}
								if(hiddenFlg){
									gmdsmd.removeChild(options[i]);
								}
							}
						}
					}
				}
			}
		}
	}

	function atysrhPopup(id, event, form_id){
		var params = new Object();
		params["action"] = "v3search_view_main_atysrh";
		params["form_name"] = form_id;
		params["prefix_id_name"] = "atysrh";
		
		var popupParams = new Object();
		var top_el = document.getElementById(id);
		popupParams['top_el'] = top_el;
		popupParams['target_el'] = top_el;
		popupParams['modal_flag'] = true;
		popupParams["loading_el"] = top_el;
		popupParams["loading_x"] = document.documentElement.clientWidth / 2 + document.documentElement.scrollLeft;
		popupParams["loading_y"] = document.documentElement.clientHeight / 2 + document.documentElement.scrollTop;
		
		commonCls.sendPopupView(event, params, popupParams);
	}

	function opacAtySearch(id, form_el, target_id){
		document.getElementById(target_id).innerHTML = "";
		
		var top_el = document.getElementById(id);
		var param = "v3search_action_main_atysrh";
		param += "&op_param=" + encodeURIComponent($(form_el).serialize());
		
		var params = new Object();
		params["param"] = param;
		params["method"] = "post";
		params["top_el"] = top_el;
		params["loading_el"] = document.getElementById(target_id);
		params["target_el"] = document.getElementById(target_id);
		
		commonCls.send(params);
	}

	function opacSetAtyWords(id, pform_id, words){
		var pform_el = document.getElementById(pform_id);
		if(pform_el != null){
			pform_el.search_aty.value = words;
			commonCls.removeBlock('_atysrh' + id);
		}
	}

	function brqlst_sendOpacSearch(id, form_name){
		var top_el = document.getElementById(id);
		var params = new Object();
		params["method"] = "get";
		params["param"] = "action=v3search_view_main_brqlst"
						+ "&" + Form.serialize(form_name);
		params["top_el"] = top_el;
		params["loading_el"] = top_el;
		params["loading_x"] = document.documentElement.clientWidth / 2 + document.documentElement.scrollLeft;
		params["loading_y"] = document.documentElement.clientHeight / 2 + document.documentElement.scrollTop;
		params["target_el"] = top_el;
		commonCls.send(params);
	}

	function brqlst_opacSetListcnt(listcnt, id, form_name){
		var form = document.getElementById(form_name);
		form.listcnt.value = listcnt;
		form.stpos.value = "1";
		brqlst_sendOpacSearch(id,form_name);
	}

	function brqlst_opacSetStartpos(stpos, id, form_name){
		var form = document.getElementById(form_name);
		form.stpos.value = stpos;
		brqlst_sendOpacSearch(id,form_name);
	}

	function opacLnkcte(bibid,id,tab_num){
		var ajax_area = "ajax_lnkcte" + bibid + id + tab_num;
		
		url = "/lnkcte.do";
		url += "?bibid="+encodeURIComponent(bibid);
		
		var top_el = document.getElementById(id);
		var params = new Object();
		params["param"] = "v3search_action_main_ajax&target=opac" + "&url=" + encodeURIComponent(url);
		params["method"] = "post";
		params["loading_el"] = document.getElementById(ajax_area);
		params["top_el"] = top_el;
		params["target_el"] = document.getElementById(ajax_area);

		commonCls.send(params);
	}

	function opacMokujiPopup(issn,id, holid, mode, title, event){
		var url = "mpmcte.do";
		url += "?issn="+encodeURIComponent(issn);
		url += "&holid="+encodeURIComponent(holid);
		url += "&mode="+encodeURIComponent(mode);
		url += "&title="+encodeURIComponent(title);
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data,true);
			},
			error: function(xhr, textStatus, errorThrown){

			}
		});
	}

	function opacMokujiList(issn, id, mode, title, event){
		var url = "mpmlst.do";
		url += "?issn="+encodeURIComponent(issn);
		url += "&mode="+encodeURIComponent(mode);
		url += "&title="+encodeURIComponent(title);
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data,true);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}

	function opacMmokujidtl(issn,id,mode,tocURI,title){
		url = "mpmcte.do";
		url += "?issn="+encodeURIComponent(issn);
		url += "&mode="+encodeURIComponent(mode);
		url += "&tocURI="+encodeURIComponent(tocURI);
		url += "&title="+encodeURIComponent(title);
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				jQuery('#mpm_detail_area').html(data);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}

	function hideMokujilist(id){
		
		var lst =  document.getElementById('mpm_list_area'+id);
		if(lst != null){
			lst.style.display = "none";
		}
		
		return false;
	}

	function returnToVollist(id){
		
		var dtl =  document.getElementById('mpm_detail_area'+id);
		if(dtl != null){
			dtl.innerHTML = '';
		}
		
		var lst =  document.getElementById('mpm_list_area'+id);
		if(lst != null){
			lst.style.display = "block";
		}

		return false;
	}
	
	function sendOpacInitPage(){
		sessionStorage.clear();
		location.href = "https://www.lib.kansai-u.ac.jp/webopac/cattab.do";
	}
	
	function sendOpacSearch(form_el,id,svcaction,sFlg){
		
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		this.search_mode = this.disp_search_mode;
		
		if (sFlg != "true") {
			var params = jQuery(form_el).serialize();
			sessionStorage.setItem("old_search_form",params);
			sessionStorage.setItem("old_search_form_id",this.old_search_form.id);
			sessionStorage.setItem("search_mode",this.search_mode);
			sessionStorage.setItem("old_opac_form_id",this.disp_num);
		} else {
			
			sessionStorage.removeItem("old_search_form");
			sessionStorage.removeItem("old_search_form_id");
			sessionStorage.removeItem("search_mode");
			sessionStorage.removeItem("old_opac_form_id");
			
			var params = jQuery(form_el).serialize();
			sessionStorage.setItem("old_search_form",params);
			sessionStorage.setItem("old_search_form_id",this.form_el.id);
			sessionStorage.setItem("search_mode",this.search_mode);
			sessionStorage.setItem("old_opac_form_id",this.disp_num);
		}
		
		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		
		var search_page = document.getElementById('search_page'+this.disp_num);
		if(search_page == null){
			return false;
		}
		search_page.innerHTML = '';
		
		var opt_page = document.getElementById('opt_page'+this.disp_num);
		if(opt_page == null){
			return false;
		}
		opt_page.innerHTML = '';
		
		if(svcaction != null && svcaction != ""){
			var svcEnc = encodeURIComponent(svcaction);
			//param += encodeURIComponent("&svcaction="+svcEnc);
		}
		form_el.tab_num.value = this.disp_num;

		//二度押し防止：ロック
		this.search_lock = true;
		
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ctlsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function sendOpacReSearch(reSrchCondFormkeyno, backCattab){
		let act;
		if (backCattab === "true") {
			act = "https://www.lib.kansai-u.ac.jp/webopac/cattab.do";
		} else {
			act = "https://www.lib.kansai-u.ac.jp/webopac/ctlsrh.do";
		}
		$('<form/>',{action:act, method:"post"})
		.append("<input type='hidden' name='reSrchCondFormkeyno' value='" + encodeURIComponent(reSrchCondFormkeyno) + "'>")
		.appendTo($('body'))
		.submit();
	}

	function sendSummonSearch(form_el,id,svcaction,sFlg){
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		this.search_mode = this.disp_search_mode;
		if (sFlg != "true") {
			var params = jQuery(form_el).serialize();
			sessionStorage.setItem("old_search_form",params);
			sessionStorage.setItem("old_search_form_id",this.old_search_form.id);
			sessionStorage.setItem("search_mode",this.search_mode);
		} else {
			
			sessionStorage.removeItem("old_search_form");
			sessionStorage.removeItem("old_search_form_id");
			sessionStorage.removeItem("search_mode");
			
			var params = jQuery(form_el).serialize();
			sessionStorage.setItem("old_search_form",params);
			sessionStorage.setItem("old_search_form_id",this.form_el.id);
			sessionStorage.setItem("search_mode",this.search_mode);
		}
		
		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		
		var search_page = document.getElementById('search_page'+this.disp_num);
		if(search_page == null){
			return false;
		}
		search_page.innerHTML = '';
		
		var opt_page = document.getElementById('opt_page'+this.disp_num);
		if(opt_page == null){
			return false;
		}
		opt_page.innerHTML = '';
		
		if(svcaction != null && svcaction != ""){
			var svcEnc = encodeURIComponent(svcaction);
			//param += encodeURIComponent("&svcaction="+svcEnc);
		}

		form_el.tab_num.value = this.disp_num;
		//二度押し防止：ロック
		this.search_lock = true;
		
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/smnsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function sendEdsSearch(form_el,id,svcaction){
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		this.search_mode = this.disp_search_mode;
		
		var params = jQuery(form_el).serialize();
		sessionStorage.setItem("old_search_form",params);
		sessionStorage.setItem("old_search_form_id",form_el.id);
		sessionStorage.setItem("search_mode",sessionStorage.getItem("search_mode"));

		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		
		var search_page = document.getElementById('search_page'+this.disp_num);
		if(search_page == null){
			return false;
		}
		search_page.innerHTML = '';
		
		var opt_page = document.getElementById('opt_page'+this.disp_num);
		if(opt_page == null){
			return false;
		}
		opt_page.innerHTML = '';
		
		if(svcaction != null && svcaction != ""){
			var svcEnc = encodeURIComponent(svcaction);
			//param += encodeURIComponent("&svcaction="+svcEnc);
		}

		form_el.tab_num.value = this.disp_num;
		//二度押し防止：ロック
		this.search_lock = true;
		
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/edssrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function sendOpacPage(id,act,param){
		var baseurl = "<{$smarty.const.BASE_URL|smarty:nodefaults}><{$smarty.const.INDEX_FILE_NAME|smarty:nodefaults}>";
		var paramurl = "?action=pages_view_main&active_action="+act+"&block_id="+this.opac_block_id;
		//トップ画面からの新着案内、貸出ランキング、アクセスランキングの場合
		if(act == "v3search_view_main_newlst" || 
			act == "v3search_view_main_beslst" ||
			act == "v3search_view_main_acrlst"){
			//「v3search_view_main_」以降を切り出しハッシュとする
			act = act.replace( "v3search_view_main_", "" );
		}
		var hash = "#" + act;
		location.href = baseurl + paramurl + param + hash;
	}

	function sendOtherSearch(id,act,svcaction,formkeyno){
		var baseurl = "https://www.lib.kansai-u.ac.jp/webopac";
		var paramurl = "";
		if("catsrm" == act){
			paramurl += "/catsrm.do";
		}else if("lnklst" == act){
			paramurl += "/lnklst.do";
		}else if("revsra" == act){
			paramurl += "/revsra.do";
		}else if("rusesra" == act){
			paramurl += "/rusesra.do";
		}else if("beslst" == act){
			paramurl += "/besexe.do";
		}else if("newlst" == act){
			paramurl += "/newexe.do";
		}else if("acrlst" == act){
			paramurl += "/acrexe.do";
		}else if("catsrc" == act){
			paramurl += "/catsrc.do";
		}else if("reflst" == act){
			paramurl += "/reflst.do";
		}else if("tagsrh" == act){
			paramurl += "/tagsrh.do";
		}else if("bkmref" == act){
			paramurl += "/bkmref.do";
		}else if("hstref" == act){
			paramurl += "/hstref.do";
		}
		if(formkeyno != null){
			paramurl += "?formkeyno="+encodeURIComponent(formkeyno);
		}
		if(svcaction != null){
			paramurl += "&svcaction="+encodeURIComponent(svcaction);
		}
		location.href = baseurl + paramurl;
	}

	function opacUseFunction(id,loginFlg,form_el,svcaction,locale,autoFlg){
		if(loginFlg == "true"){

			if(form_el.locale == null){
				var lElement = document.createElement('input');
				lElement.type = "hidden";
				lElement.name = "locale";
				lElement.value = locale;
				form_el.appendChild(lElement);
			}else{
				form_el.locale.value = locale;
			}
			
			opacPopupConfirm(form_el, null, id, autoFlg);
		}else if(loginFlg == "always"){
			opacUseFunctionAlways(id,form_el,locale);
		}else{
			var login_url = this.opac_base_url + "/ufisnd.do";
			
			var act = location.pathname.replace(/.*\//,"");
			login_url += "?redirect_act="+encodeURIComponent(act);
			
			if(act=="opnurl.do"){
				login_url += encodeURIComponent(location.search);
			}
			
			if(act == "catdal.do"){
				var search = location.search;
				var params = search.split('&');
				
				for(var i = 1 ; i < params.length ; i++){
					if(params[i].includes('old_formkeyno_catdal')){
						var old_formkeyno_catdal = params[i].split('=')[1];
					}
				}
				
				login_url += "?old_formkeyno_catdal=" + old_formkeyno_catdal;
			}
			
			var tab_num = this.disp_num;
			var formkeyno = this.formList[tab_num];
			if(formkeyno != null && formkeyno != ''){
				login_url += "&redirect_formkeyno=" + encodeURIComponent(formkeyno);
			}
			
			login_url += "&svcaction=" + encodeURIComponent(svcaction);
			login_url += "&locale=" + encodeURIComponent(locale);
			login_url += "&tab_num=" + encodeURIComponent(tab_num);
			
			if(sessionStorage.getItem('query_str')==null&&typeof query_str!='undefined'){
				sessionStorage.setItem('query_str',query_str);
			}
			location.href = login_url;
		}
	}

	function opacUseFunctionAlways(id,form_el,locale){
		var login_url = this.opac_base_url + "/opacsnd.do";
		var target = form_el.action;
		opac_target = target.replace(/.*\//,"");
		if(form_el.opac_target == null){
			var lElement = document.createElement('input');
			lElement.type = "hidden";
			lElement.name = "opac_target";
			lElement.value = opac_target;
			form_el.appendChild(lElement);
		}else{
			form_el.opac_target.value = opac_target;
		}
		form_el.action = login_url;
		
		if(form_el.locale == null){
			var lElement = document.createElement('input');
			lElement.type = "hidden";
			lElement.name = "locale";
			lElement.value = locale;
			form_el.appendChild(lElement);
		}else{
			form_el.locale.value = locale;
		}

		form_el.submit();
		
		form_el.action = target;
	}

	function opacUseFunctionPopup(id,loginFlg,form_el,svcaction,locale){
		if((loginFlg == "true") || loginFlg == "noCheckLogin"){
			if(form_el.locale == null){
				var lElement = document.createElement('input');
				lElement.type = "hidden";
				lElement.name = "locale";
				lElement.value = locale;
				form_el.appendChild(lElement);
				if(loginFlg == "noCheckLogin"){
					var lElement = document.createElement('input');
					lElement.type = "hidden";
					lElement.name = "onetime";
					lElement.value = "noCheckLogin";
					form_el.appendChild(lElement);
				}
			}else{
				form_el.locale.value = locale;
				if(loginFlg == "noCheckLogin"){
					form_el.onetime.value = "noCheckLogin";
				}
			}
			
			var params = $(form_el).serialize();
			
			var popupParams = new Object();
			popupParams["request_url"] = form_el.action;
			
			sendPopupView(null, params, popupParams);
			
		}else if(loginFlg == "always"){
			
			opacUseFunctionPopupAlways(form_el);
		}else{
			var login_url = this.opac_base_url + "/ufisnd.do";
			
			var act = location.pathname.replace(/.*\//,"");
			login_url += "?redirect_act="+encodeURIComponent(act);
			
			if(act == "catdal.do"){
				var search = location.search;
				var params = search.split('&');
				
				for(var i = 1 ; i < params.length ; i++){
					if(params[i].includes('old_formkeyno_catdal')){
						var old_formkeyno_catdal = params[i].split('=')[1];
					}
				}
				
				login_url += "?old_formkeyno_catdal=" + old_formkeyno_catdal;
			}
			
			var tab_num = this.disp_num;
			var formkeyno = this.formList[tab_num];
			if(formkeyno != null && formkeyno != ''){
				login_url += "&redirect_formkeyno=" + encodeURIComponent(formkeyno);
			}
			
			login_url += "&svcaction=" + encodeURIComponent(svcaction);
			login_url += "&locale=" + encodeURIComponent(locale);
			login_url += "&tab_num=" + encodeURIComponent(tab_num);
			
			if(sessionStorage.getItem('query_str')==null&&typeof query_str!='undefined'){
				sessionStorage.setItem('query_str',query_str);
			}
			location.href = login_url;
		}
	}

	function opacUseFunctionPopupAlways(form_el, url){
		if(url != null){
			var wrk = url.split("?");
			var target = wrk[0];
			var params = wrk[1];
		}else{
			var target = form_el.action;
			var params = $(form_el).serialize();
		}
		params += "&popup_flg=true";
		opac_target = target.replace(/.*\//,"");
		params += "&opac_target=" + encodeURIComponent(opac_target);

		var popupParams = new Object();
		popupParams["request_url"] = "https://www.lib.kansai-u.ac.jp/webopac/opacsnd.do";
		
		if(document.createEvent){
			var event = document.createEvent("MouseEvent");
		}else{
			var event = document.createEventObject();
		}
		
		sendPopupView(event, params, popupParams, false);
	}
	
	function opacLocaleChange(lang, formkeyno, mode){
		var change_url = "?locale=" + encodeURIComponent(lang);
		if(formkeyno != null && formkeyno != ''){
			change_url += "&formkeyno=" + encodeURIComponent(formkeyno);
		}
		if(mode != null && mode != ''){
			change_url += "&search_mode=" + encodeURIComponent(mode);
		}
		if(this.disp_num){
			change_url += "&tab_num=" + encodeURIComponent(this.disp_num);
		}
		change_url += "&initFlg=" + encodeURIComponent("locale");
		location.search = change_url;
	}
	
	function sendNiiSearch(form_el,id,svcaction,sFlg){
		this.old_search_form = form_el.cloneNode(true);
	    formConvert(form_el,this.old_search_form);
		this.search_mode = this.disp_search_mode;
		
		if (sFlg != "true") {
			var params = jQuery(form_el).serialize();
			sessionStorage.setItem("old_search_form",params);
			sessionStorage.setItem("old_search_form_id",this.old_search_form.id);
			sessionStorage.setItem("search_mode",this.search_mode);
		} else {
			
			sessionStorage.removeItem("old_search_form");
			sessionStorage.removeItem("old_search_form_id");
			sessionStorage.removeItem("search_mode");
			
			var params = jQuery(form_el).serialize();
			sessionStorage.setItem("old_search_form",params);
			sessionStorage.setItem("old_search_form_id",this.form_el.id);
			sessionStorage.setItem("search_mode",this.search_mode);
		}
		
		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		document.getElementById('search_page'+this.disp_num).innerHTML = '';
		document.getElementById('opt_page'+this.disp_num).innerHTML = '';
		
		if(svcaction != null && svcaction != ""){
			var svcEnc = encodeURIComponent(svcaction);
			//param += encodeURIComponent("&svcaction="+svcEnc);
		}
		form_el.tab_num.value = this.disp_num;
		
		//二度押し防止：ロック
		this.search_lock = true;
		
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ctnsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function sendNiiReSearch(reSrchCondFormkeyno, backCattab){
		let act;
		if (backCattab === "true") {
			act = "https://www.lib.kansai-u.ac.jp/webopac/cattab.do";
		} else {
			act = "https://www.lib.kansai-u.ac.jp/webopac/ctnsrh.do";
		}
		$('<form/>',{action:act, method:"post"})
		.append("<input type='hidden' name='reSrchCondFormkeyno' value='" + encodeURIComponent(reSrchCondFormkeyno) + "'>")
		.appendTo($('body'))
		.submit();
	}

	function sendNiiPage(id,act,param){
		var baseurl = "<{$smarty.const.BASE_URL|smarty:nodefaults}><{$smarty.const.INDEX_FILE_NAME|smarty:nodefaults}>";
		var paramurl = "?action=pages_view_main&active_action="+act+"&block_id="+this.opac_block_id;
		location.href = baseurl + paramurl + param;
	}

	function changeHref(id,act,param){
		var baseurl = "https://www.lib.kansai-u.ac.jp/webopac";
		var url ="/" + act +".do?";
		location.href = baseurl + url + param;
	}

	function showLnkLstELib(id,lnkfunc,groupno,itemno) {
		var baseurl = "<{$smarty.const.BASE_URL|smarty:nodefaults}><{$smarty.const.INDEX_FILE_NAME|smarty:nodefaults}>";
		var paramurl = "?action=pages_view_main&active_action=v3search_view_main_lnkexe&block_id="+id.replace("_","");
		var param = "";
		param += "&lnkfunc="+lnkfunc;
		param += "&groupno="+groupno;
		param += "&itemno="+itemno;
		location.href = baseurl + paramurl + param;
	}

	// チェックを入れた書誌をEndNoteWeb、RefWorksに登録する
	function sendEndRef(software,form_id,opacurl,target,type,tab_type){
			var form_el = document.getElementById(form_id);
			var param = jQuery(form_el).serialize();
	 		if(param.indexOf("bibid") != -1){
	 			if(target == "localbiblst"){
				param = param.replace(/sortkey.*?listcnt.*?&/,"&");
				param = param.replace(/bib/g,"");
	 			}else if(target == "niibiblst"){
				param = param.replace(/listcnt.*?&/,"&");
				param = param.replace(/bib/g,"");
			}else if (target == "newbest"){
				param = param.replace(/cls.*?listcnt.*?&/,"");
				param = param.replace(/&/g,"");
				param = param.replace(/bibid.*?=/g,"&id=");
			}else if (target == "acrexe"){
				param = param.replace(/cls.*?listcnt.*?&/,"");
				param = param.replace(/&/g,"");
				param = param.replace(/bibid.*?=/g,"&id=");
			}else if (target == "browhis"){
				param = param.replace(/listcnt.*?&/,"");
				param = param.replace(/&/g,"");
				param = param.replace(/bib/g,"&");
			}else if (target == "linkbiblst"){
				param = param.replace(/startpos.*?listcnt.*?&/,"&");
				param = param.replace(/bib/g,"");
			}
	 			
	 			if(param.indexOf("&") != 0){
	 				param = "&" + param;
	 			}
	 			
			var w;
			w = opacurl;
			
			if(software == "refworks"){
	 			w += "/refworks.do?type=";
	 			w += type;
	 			w += param;
				window.open(w,"RefWorks");

			}else if(software == "endnote"){
				w += "/endnote.do?type=";
				w += type;
	 			w += param;
	 			if(tab_type != null){
	 				w += "&tab_type="+tab_type;
	 			}
				window.open(w,"EndNote");
			}else if(software == "mendeley"){
	 			w += "/mendeley.do?type=";
	 			w += type;
	 			w += param;
				window.open(w,"Mendeley");
	 		}
			}
	 		else{
	 			alert("書誌が選択されていません")
		}
	}

	function PopUpOpen(id,event,pop_id,form_el,detailflg){
		try {
			if(detailflg == "false"){
		 		var param = jQuery(form_el).serialize();
		 		if(param.indexOf("bibid") == -1){
		 			alert("書誌が選択されていません");
		 			return false;
				}
			}
			var pop_obj = document.getElementById(pop_id).cloneNode(true);
			pop_obj.style.display = "block";
			showResultsToPopup(pop_obj);
			return false;
		} catch( e ) {
			return false;
		}
	}

	function PopUpOpenAjax(pop_obj,showCloseLink,widthNoSet){
		try {
			showResultsToPopup(pop_obj,showCloseLink);
			if(showCloseLink){
				if(!widthNoSet){
					$('#popupDialog').width("65%");
				}
			}
			return false;
		} catch( e ) {
			alert(e);
			return false;
		}
	}

	function PopUpOpenAjaxLmap(pop_obj,showCloseLink,widthNoSet){
		try {
			showResultsToPopupLmap(pop_obj,showCloseLink);
			if(showCloseLink){
				if(!widthNoSet){
					$('#popupDialog').width("65%");
				}
			}
			return false;
		} catch( e ) {
			alert(e);
			return false;
		}
	}

	function showResultsToPopupLmap(data, showCloseLink) {
		let popupDialogTmplClone = $($('#popupDialogTmplmap').html());
		popupDialogTmplClone.height($(document).height());
		popupDialogTmplClone.width($(document).width());
		// 閉じるリンクがある場合
		if(typeof(data) == "string" && data.indexOf("opac_garnish_link_area") != -1){
			let closeLink = $(data).find('.opac_garnish_link_area');
			// 閉じるリンクの場所変更
			$('#popupDialog', popupDialogTmplClone).append(closeLink);
			// データ元から閉じるリンク削除
			data = data.replace(closeLink[0].outerHTML,"");
		}
		$('#popupDialogContents', popupDialogTmplClone).append(data);
		
		if(showCloseLink){
			let closeElm = document.createElement('div');
			closeElm.className = "opac_garnish_link_area";
			closeElm.innerHTML = '<a href="#" onclick="PopUpClose();return false;" class="close_link">'
				+'このウインドウを閉じる</a>';
			$('#popupDialog', popupDialogTmplClone).append(closeElm);;
		}
		if ($('header', popupDialogTmplClone).length) {
			$('header', popupDialogTmplClone).hide();
		}
		if ($('footer', popupDialogTmplClone).length) {
			$('footer', popupDialogTmplClone).hide();
		}
		$('#popupDialogArea').append(popupDialogTmplClone);

		let clientHeight = document.body.clientHeight;
		let elementHeight = $('#popupDialog').outerHeight();
		let marginHeight = clientHeight - elementHeight;
		let scrollTop = $(window).scrollTop();
		if (marginHeight > 0) {
			$('#popupDialog').css("margin-top", (marginHeight / 2) + scrollTop);
		}
	}

	function opacOpnurl(id,svcaction){
		var params = "<{$smarty.session.OPNURL_PARAMS}>";

		var svcactionstr = "";
		var pattern = new RegExp("&amp;","g");
		params = params.replace(pattern,"&");

		if(svcaction != null){
			svcactionstr = "&svcaction=" + svcaction;
		}
		
		var baseurl = "<{$smarty.const.BASE_URL|smarty:nodefaults}><{$smarty.const.INDEX_FILE_NAME|smarty:nodefaults}>";
		var paramurl = "?action=pages_view_main&active_action=v3search_view_main_opnurl&block_id="+id.replace("_","");
		location.href = baseurl + paramurl + params + svcactionstr;
		
	}

	function opacBkmexeDel(id,event,form_id){
		var form_el = document.getElementById(form_id);
		var param = jQuery(form_el).serialize();
		
		if(param.indexOf("bibid=") != -1){
			var pattern = new RegExp("sortkey.*?listcnt.*?&");
			var reparam = param.replace(pattern,"&");
			reparam = reparam.replace(/bibid/g,"bookmark"); 
			
			var url = "bkmexe.do?";
			url += "mode=del&" + reparam;
			
			jQuery.ajax({
				url: url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					PopUpOpenAjax(data);
				},
				error: function(xhr, textStatus, errorThrown){
				}
			});
		}else{
			alert("書誌が選択されていません");
		}
	}

	// タグ検索画面表示
	function tagsrh_sendOpacSearch(form_el, id){
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/tagsrh.do";
		form_el.method = "POST";
		form_el.submit(); 
	}

	function opacSendBibidUse(id,loginFlg,form_id,bibform_id,svcaction,locale,id_name,pkey,autoFlg){
		var form_el = document.getElementById(form_id);
		var param = $(form_el).serialize();

		if(pkey == null){
			pkey = "bibid";
		}else{
			pkey = encodeURIComponent(pkey);
		}

		if(param.indexOf(pkey+"=") != -1){
			if(param.indexOf(pkey+"=") != 0){
				var pattern = new RegExp(".*?&"+pkey);
				var reparam = param.replace(pattern,"&"+pkey);
			}else{
				var reparam = param;
			}
			
			var regexp = new RegExp(pkey+"=","g");
			reparam = reparam.replace(regexp,"|");
			reparam = reparam.replace(/&/g,"");
			
			var bibform = document.getElementById(bibform_id);
			if(bibform[id_name] != null){
				if(bibform[id_name].length){
					while(bibform[id_name] != null){
						if(bibform[id_name][0]){
							bibform.removeChild(bibform[id_name][0]);
						}else{
							bibform.removeChild(bibform[id_name]);
						}
					}
				}else{
					bibform.removeChild(bibform[id_name]);
				}
			}
			
			var bibids = reparam.split("|");
			var lElement = null;
			for(var i = 1 ; i < bibids.length ; i++){
				lElement = document.createElement('input');
				lElement.type = "hidden";
				lElement.name = id_name;
				lElement.value = bibids[i];
				bibform.appendChild(lElement);
			}
			
			//ブックマーク限定でポップアップ表示
			if(id_name == "bookmark"){
				opacUseFunctionPopup(id,loginFlg,bibform,svcaction+reparam,locale);
			}else{
				opacUseFunction(id,loginFlg,bibform,svcaction+reparam,locale,autoFlg);
			}
		}else{
			alert("書誌が選択されていません");
		}
	}

	function opacCatdowPopup(id,form,target,type,formkey,event,output_mode){
		var bibid = jQuery(form).serialize();
		if(bibid.indexOf("bibid") != -1){
			var ajaxflg = this.hol_disp_flg;
			if(target == "localbiblst"){
				bibid = bibid.replace(/sortkey.*?listcnt.*?&/,"");
				bibid = bibid.replace(/&/g,"");
			}else if (target == "newbest"){
				bibid = bibid.replace(/cls.*?listcnt.*?&/,"");
				bibid = bibid.replace(/&/g,"");
				bibid = bibid.replace(/bibid.*?=/g,"bibid=");
				
				if(ajaxflg == true){
					var tmp = "";
					var bibids = form["bibid[]"];
					if(bibids.length != undefined){
						for(var i = 0 ; i < bibids.length ; i++){
							if(bibids[i] != null && bibids[i].checked == true){
								var vol = form["VOL_"+i+"_"+bibids[i].value];
								if(vol != null){
									tmp += "bibid="+bibids[i].value+" "+vol.value;
								}else{
									vol = document.getElementById("VOL_"+bibids[i].value);
									if(vol != null){
										tmp += "bibid="+bibids[i].value+" "+vol.value;
									}
								}
							}
						}
						bibid = tmp;
					}
				}
			}else if (target == "acrexe"){
				bibid = bibid.replace(/cls.*?listcnt.*?&/,"");
				bibid = bibid.replace(/&/g,"");
				bibid = bibid.replace(/bibid.*?=/g,"bibid=");
				
				if(ajaxflg == true){
					var tmp = "";
					var bibids = bibid.split("bibid=");
					for(var i = 0 ; i < bibids.length ; i++){
						if(bibids[i] != ""){
							var vol = document.getElementById("VOL_"+bibids[i]);
							if(vol != null){
								tmp += "bibid="+bibids[i]+" "+vol.value;
							}
						}
					}
					bibid = tmp;
					}
			}else if (target == "niibiblst"){
				bibid = bibid.replace(/listcnt.*?&/,"");
				bibid = bibid.replace(/&/g,"");
			}else if (target == "browshis"){
				bibid = bibid.replace(/listcnt.*?&/,"");
				bibid = bibid.replace(/&/g,"");
			}else if (target == "linkbiblst"){
				bibid = bibid.replace(/startpos.*?listcnt.*?&/,"");
				bibid = bibid.replace(/&/g,"");
			}
			
			var url = "";
			var tab_num = this.disp_num;
			var formkeyno = this.formList[tab_num];
			if(formkey != null){
				formkeyno = formkey;
			}
			if(formkeyno != null){
				url = "formkeyno="+encodeURIComponent(formkeyno);
			}
			
			var url = "catdow.do?";
			var params = new Object();
			url += "downloadBibid=" + encodeURIComponent(bibid);
			url += "&ajaxFlg=" + encodeURIComponent(ajaxflg);
			url += "&type=" + encodeURIComponent(type);
			url += "&dispflg=" + encodeURIComponent(target);
			
			if(output_mode != null){
				var output_param = output_mode;
				var bescntform = document.getElementById("bescntform"+id);
				
				var bibids = form["bibid[]"];
				if(bibids.length != undefined){
					for(var i = 0 ; i < bibids.length ; i++){
						if(bibids[i] != null && bibids[i].checked == true){
							var bid = bibids[i].value;
							if(bescntform[bid+"_"+i] != null){
								output_param += "|"+bid+","+bescntform[bid+"_"+i].value;
							}else if(bescntform[bid] != null){
								output_param += "|"+bid+","+bescntform[bid].value;
							}
						}
					}
				}else{
					var bid = bibids.value;
					if(bescntform[bid+"_0"] != null){
						output_param += "|"+bid+","+bescntform[bid+"_0"].value;
					}
				}
				url += "&output_mode=" + encodeURIComponent(output_param);
			}
			
			jQuery.ajax({
				url: url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					PopUpOpenAjax(data);
				},
				error: function(xhr, textStatus, errorThrown){
					
				}
			});
			
		}else{
			alert("書誌が選択されていません")
		}
	}

	function downloadFile(id,dowtype,downloadbibid,ajaxflg,formkeyno,type,dispflg,output_mode){
		downloadbibid = decodeURIComponent(downloadbibid);
		if(dowtype == "ref"){
			var bibs = downloadbibid.split("bib");
			if(bibs.length > 21){
				alert("<{$smarty.const._V3SEARCH_MES_CHECK_DOWNLOAD}>");
				return false;
			}
		}
		PopUpClose();
		var baseurl = "https://www.lib.kansai-u.ac.jp/webopac/dowexe.do";
		var url = "";
		url += "?ajaxflg=" + ajaxflg;
		url += "&dow_type=" + dowtype;
		url += "&type=" + type;
		url += "&dispflg=" + dispflg;
		url += "&formkeyno=" + formkeyno;
		if(output_mode != null){
			url += "&output_mode=" + encodeURIComponent(output_mode);
		}
		downloadbibid = encodeURIComponent(downloadbibid);
		var bibid_rep = downloadbibid.replace(/bib/g,"&").replace(/%3D/g,"=");
		url += bibid_rep;
		
		location.href = baseurl + url;
	}

	function sendMailPopup(id,form_el,opacurl,target,type,loginFlg,locale,formkey,svcaction){
		if(svcaction == null){
			svcaction = "sendmail";
		}
		
		var bibid = jQuery(form_el).serialize();
		if(bibid.indexOf("bibid") != -1){
			if(window.confirm("メールを送信しますか？")){
				if( (loginFlg == "true") || (loginFlg == "always")){
					var ajaxflg = this.hol_disp_flg;
					bibid = sendMailBibid(id,target,ajaxflg,bibid);
					
					var url = "";
					var tab_num = this.disp_num;
					var formkeyno = this.formList[tab_num];
					if(formkey != null){
						formkeyno = formkey;
					}
					if(formkeyno != null){
						url = "formkeyno="+encodeURIComponent(formkeyno);
					}
					
					if(loginFlg == "true"){
						var params = new Object();
						params["bibid"] = bibid;
						params["ajaxflg"] = ajaxflg;
						params["type"] = type;
						params["dispflg"] = target;
						params["url"] = url;
						
						var popupParams = new Object();
						var top_el = $(id);
						popupParams['top_el'] = top_el;
						popupParams['target_el'] = top_el;
						popupParams['modal_flag'] = true;
						popupParams['request_url'] = "https://www.lib.kansai-u.ac.jp/webopac/malsnd.do?"+url+(!ajaxflg?"&":"")+bibid;
						
						if(document.createEvent){
							var event = document.createEvent("MouseEvent");
						}else{
							var event = document.createEventObject();
						}
						
						sendPopupView(event, params, popupParams, false);
					}else if(loginFlg == "always"){
						var url = "https://www.lib.kansai-u.ac.jp/webopac/malsnd.do?"+url+"&bibid="+bibid+"&type="+type+"&dispflg="+target;
						opacUseFunctionPopupAlways(form_el, url);
					}
				}else{
					if(target == "localbiblst"){
						var reparam = bibid.replace(/sortkey.*?listcnt.*?&/,"&");
						reparam = reparam.replace(/bibid=/g,"|");
						reparam = reparam.replace(/&/g,"");
					}else if (target == "newbest"){
						var reparam = bibid.replace(/cls.*?listcnt.*?&/,"");
						reparam = reparam.replace(/bibid.*?=/g,"|");
						reparam = reparam.replace(/&/g,"");
					}else if (target == "niibiblst"){
						var reparam = bibid.replace(/listcnt.*?&/,"&");
						reparam = reparam.replace(/bibid=/g,"|");
						reparam = reparam.replace(/&/g,"");
					}else if (target == "browshis"){
						var reparam = bibid.replace(/&/g,"");
						reparam = reparam.replace(/bibid=/g,"|");
					}else if (target == "linkbiblst"){
						var reparam = bibid.replace(/startpos.*?listcnt.*?&/,"&");
						reparam = reparam.replace(/&bibid=/g,"|");
					}
					
					var login_url = this.opac_base_url + "/ufisnd.do";
					var act = location.pathname.replace(/.*\//,"");
					login_url += "?redirect_act="+encodeURIComponent(act);
					
					
					if(act == "catdal.do"){
						var search = location.search;
						var params = search.split('&');
						
						for(var i = 1 ; i < params.length ; i++){
							if(params[i].includes('old_formkeyno_catdal')){
								var old_formkeyno_catdal = params[i].split('=')[1];
							}
						}
						
						login_url += "?old_formkeyno_catdal=" + old_formkeyno_catdal;
					}
					
					var tab_num = this.disp_num;
					var formkeyno = this.formList[tab_num];
					if(formkeyno != null && formkeyno != ''){
						login_url += "&redirect_formkeyno=" + encodeURIComponent(formkeyno);
					}
					login_url += "&svcaction=" + encodeURIComponent(svcaction + reparam);
					login_url += "&locale=" + encodeURIComponent(locale);
					login_url += "&tab_num=" + encodeURIComponent(tab_num);
					
					if(sessionStorage.getItem('query_str')==null&&typeof query_str!='undefined'){
						sessionStorage.setItem('query_str',query_str);
					}
					location.href = login_url;
				}
			}
		}else{
			alert("書誌が選択されていません");
		}
	}

	function opacSendFhts(id, loginFlg, form_id, fhtform_id, locale, id_name){

		var histlist = document.getElementById(form_id);
		
		var param = jQuery(histlist).serialize();

		if(param.indexOf("history=") != -1){
			var reparam = param;
			var regexp = new RegExp("history=","g");
			reparam = reparam.replace(regexp,"|");
			reparam = reparam.replace(/&/g,"");
			
			if( (loginFlg == "true") || (loginFlg == "always")){
				var fhtform = document.getElementById(fhtform_id);
				if(fhtform[id_name] != null){
					if(fhtform[id_name].length){
						while(fhtform[id_name] != null){
							fhtform.removeChild(fhtform[id_name][0]);
						}
					}else{
						fhtform.removeChild(fhtform[id_name]);
					}
				}

				var fhtids = reparam.split("|");
				var lElement = null;
				for(var i = 1 ; i < fhtids.length ; i++){
					
					lElement = document.createElement('input');
					lElement.type = "hidden";
					lElement.name = "history";
					lElement.value = fhtids[i];
					
					fhtform.appendChild(lElement);
				}
				
				if(loginFlg == "true"){
					var params = jQuery(fhtform).serialize();
		
					var popupParams = new Object();
					popupParams["request_url"] = fhtform.action;
					
					sendPopupView(null, params, popupParams);
				} else if (loginFlg == "always") {
	 				opacUseFunctionPopupAlways(fhtform);
				}
			}else{
				var login_url = this.opac_base_url + "/ufisnd.do";
				
				var act = location.pathname.replace(/.*\//,"");
				login_url += "?redirect_act="+encodeURIComponent(act);
				
				var tab_num = this.disp_num;
				var formkeyno = this.formList[tab_num];
				if(formkeyno != null && formkeyno != ''){
					login_url += "&redirect_formkeyno=" + encodeURIComponent(formkeyno);
				}
				login_url += "&svcaction=" + encodeURIComponent("hstfht" + reparam);
				login_url += "&locale=" + encodeURIComponent(locale);
				location.href = login_url;
			}
		}
		else {
			alert("登録対象となる検索条件が選択されていません。")
			return false;
		}
		return false;
	}


	// 検索履歴SDI登録
	function opacHstsdi(id,loginFlg,locale,formId,autoFlg){
		var form_el = document.getElementById(formId);
		if( (loginFlg == "true") || (loginFlg == "always") ){
			
			if(form_el.locale == null){
				var lElement = document.createElement('input');
				lElement.type = "hidden";
				lElement.name = "locale";
				lElement.value = locale;
				form_el.appendChild(lElement);
			}else{
				form_el.locale.value = locale;
			}
			
			opacPopupConfirm(form_el, null, id, autoFlg);
		
		}else{
			var login_url = this.opac_base_url +"/ufisnd.do";
			
			var act = location.pathname.replace(/.*\//,"");
			login_url += "?redirect_act="+encodeURIComponent(act);
			
			var tab_num = this.disp_num;
			var formkeyno = this.formList[tab_num];
			if(formkeyno != null && formkeyno != ''){
				login_url += "&redirect_formkeyno=" + encodeURIComponent(formkeyno);
			}
			var svcaction = "hstsdi";
			svcaction += "|" + form_el.operand1.value;
			svcaction += "|" + form_el.operand2.value;
			svcaction += "|" + form_el.operator.value;
			svcaction += "|" + form_el.mode.value;
			login_url += "&svcaction=" + encodeURIComponent(svcaction);
			login_url += "&locale=" + encodeURIComponent(locale);
			location.href = login_url;
		}
	}

	function opacV3LoginLink(id,locale){
		var login_url = this.opac_base_url + "/ufisnd.do?system=<{$smarty.now}>&redirect_page_id=<{$smarty.session._main_page_id}>";
		login_url += "&locale=" + encodeURIComponent(locale);
		location.href = login_url;
	}

	function opacLibuseaskSendComsso(id){
		var link = document.getElementById(id);
		
		/*
		<{if $smarty.const.V3SEARCH_RE_SSO == "true"}>
		var url = link.href;
		var opacurl = encodeURIComponent(url);
		link.href = "?action=v3search_view_main_libusesso&opacurl="+opacurl;
		link.onclick = "";
		<{/if}>
		*/
	}

	// アクセスランキング一覧画面表示
	function acrlst_sendOpacSearch(id, form_name){
		var form = document.getElementById(form_name);
		form.action = "https://www.lib.kansai-u.ac.jp/webopac/acrexe.do";
		form.method = "POST";
		form.submit(); 
	}

	// アクセスランキング一覧 レコード全てチェック付ける・外す
	function acrlst_checkBibid(form_id, func){
		var boxs = document.getElementById(form_id).elements['bibid[]'];
		if(boxs.length){
			for(num=0; num < boxs.length; num++){
				boxs[num].checked = func;
			}
		}else{
			boxs.checked = func;
		}
	}

	// アクセスランキング一覧 表示件数変更
	function acrlst_opacSetListcnt(listcnt, id, form_name){
		var form = document.getElementById(form_name);
		form.listcnt.value = listcnt;
		form.stpos.value = "1";
		acrlst_sendOpacSearch(id,form_name);
	}

	// アクセスランキング一覧 ページ移動
	function acrlst_opacSetStartpos(stpos, id, form_name){
		var form = document.getElementById(form_name);
		form.stpos.value = stpos;
		acrlst_sendOpacSearch(id,form_name);
	}

	function opacPopupConfirm(form_el, addFunc, id, autoFlg){
		if(autoFlg == true){
			if(id != null && this.search_lock == true){
				// 検索処理中はポップアップを描画せずに１秒後に再実行
				setTimeout( function(){opacPopupConfirm(form_el, addFunc, id);} ,1000);
			}else{
				opacPopupConfirmDrawing(form_el, addFunc);
			}
		}else{
			form_el.submit();
			if(addFunc != null){
				setTimeout(addFunc, 1000);
			}
		}
	}

	function opacPopupConfirmDrawing(form_el, addFunc){
		var submitFunc = function(){
			form_el.submit();
			closePopupDialog();
		};
		var btnFunc = function(){
			closePopupDialog();
		};
		
		var popup = document.getElementById("popup");
		if(popup == null){
			popup = document.createElement('div');
			popup.id = "popup";
			popup.style.position = "absolute";
			document.body.appendChild(popup);
		}
		
		var tableElement = document.createElement("table");
		tableElement.align = "center";
		
		var trElement0 = document.createElement("tr");
		var tdElement0 = document.createElement("td");
		tdElement0.style.paddingBottom = "30px";
		tdElement0.colSpan="2";
		tdElement0.appendChild(document.createTextNode('別ウィンドウで画面を開きます。よろしいですか？'));
		tdElement0.appendChild(document.createElement("BR"));
		
		trElement0.appendChild(tdElement0);
		tableElement.appendChild(trElement0);
		
		var trElement1 = document.createElement("tr");
		trElement1.align = "center";
		
		var tdElement1 = document.createElement("td");
		var tdElement2 = document.createElement("td");
		
		var btnElement1 = document.createElement('input');
		btnElement1.type = "button";
		btnElement1.value = 'OK';
		btnElement1.style.width = "80px";
		btnElement1.style.height = "30px";
		
		if(btnElement1.attachEvent){
			btnElement1.attachEvent("onclick",btnFunc);
			btnElement1.attachEvent("onclick",submitFunc);
			if(addFunc != null){
				btnElement1.attachEvent("onclick",addFunc);
			}
		}else{
			btnElement1.addEventListener("click",btnFunc,true);
			btnElement1.addEventListener("click",submitFunc,true);
			if(addFunc != null){
				btnElement1.addEventListener("click",addFunc,true);
			}
		}
		tdElement1.appendChild(btnElement1);

		var btnElement2 = document.createElement('input');
		btnElement2.type = "button";
		btnElement2.value = 'キャンセル';
		btnElement2.style.width = "80px";
		btnElement2.style.height = "30px";
		
		if(btnElement2.attachEvent){
			btnElement2.attachEvent("onclick",btnFunc);
			if(addFunc != null){
				btnElement2.attachEvent("onclick",addFunc);
			}
		}else{
			btnElement2.addEventListener("click",btnFunc,true);
			if(addFunc != null){
				btnElement2.addEventListener("click",addFunc,true);
			}
		}
		tdElement2.appendChild(btnElement2);
		
		trElement1.appendChild(tdElement1);
		trElement1.appendChild(tdElement2);
		tableElement.appendChild(trElement1);
		
		showResultsToPopup(tableElement);
	}

	function ufinityShowModal(event, el, loading_flag) {

		el = (event == undefined || event == null) ? el : this;

		var scroll_left = (document.documentElement.scrollLeft || document.body.scrollLeft || 0);
		var scroll_top = (document.documentElement.scrollTop || document.body.scrollTop || 0);

		var offset = 0;

		var w = Position.getWinOuterWidth();
		var h = ufinityGetWinOuterHeight();

		el.style.width =  (w + scroll_left - offset)  +"px";
		el.style.height =  (h + scroll_top - offset) +"px";

		if(loading_flag) {
			el.style.backgroundColor = "#ff0000";
			Element.setStyle(el, {"opacity":0.2});
		}
		el.style.position = "absolute";
		el.style.left = "0px";
		el.style.top = "0px";

		if(event == undefined || (event.type != "scroll" && event.type != "resize")) {
			commonCls.max_zIndex = commonCls.max_zIndex + 1;
			el.style.zIndex = commonCls.max_zIndex;

			commonCls.inModalEvent[el] = ufinityShowModal.bindAsEventListener(el);
			Event.observe(window,"scroll",commonCls.inModalEvent[el],false);
			Event.observe(window,"resize",commonCls.inModalEvent[el],false);
			if(browser.isIE) {
				var img_blank = document.createElement("img");
				img_blank.src = _nc_core_base_url + "/images/common/blank.gif";
				el.appendChild(img_blank);
			}

			if(browser.isIE) {
				if(img_blank==undefined) {
					var img_blank = Element.getChildElement(el);
				}
				img_blank.style.width = el.style.width;
				img_blank.style.height = el.style.height;
			}
		}
	}

	function ufinityGetWinOuterHeight() {
		if(document === document.window) {
			return document.documentElement.clientHeight;
		} else {
			var doc;
			if(document.nodeType == 9) {
				doc = document.documentElement;
				return Math.max(
					document.body.scrollHeight, doc.scrollHeight,
					document.body.offsetHeight, doc.offsetHeight,
					doc.clientHeight
				);
				
			}
		}
		return 0;
	}

	//カテゴリ絞込み用
	function opacCategryOption(action,suffix,id,startpos,sortkey,listcnt,options){
		var url = "&stpos"+suffix+"="+encodeURIComponent(startpos)+"&sortkey"+suffix+"="+encodeURIComponent(sortkey)+"&listcnt"+suffix+"="+encodeURIComponent(listcnt);

		for(key in options){
			url += "&" + key + "Option=" + encodeURIComponent(options[key]);
		}

		var revsra_url = "https://www.lib.kansai-u.ac.jp/webopac/"+ action +".do?" + url;
		location.href = revsra_url;
	}

	function opacRevcntDtl(id,event,tab_num,bibid,volbr,isbn){
		url = "https://www.lib.kansai-u.ac.jp/webopac/revsrx.do?key=logoff";
		url += "&block_id="+encodeURIComponent(id);
		url += "&tab_num="+encodeURIComponent(tab_num);
		url += "&bibid="+encodeURIComponent(bibid);
		url += "&volbr="+encodeURIComponent(volbr);
		url += "&isbn="+encodeURIComponent(isbn);
		url += "&popup_flg=true";

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data,true);
			},
			error: function(xhr, textStatus, errorThrown){

			}
		});
	}

	//投稿者一覧画面表示
	function opacRusesra(id, startpos, sortkey, listcnt){
		var url = "&stposRuselsa="+encodeURIComponent(startpos)+"&sortkeyRuselsa="+encodeURIComponent(sortkey)+"&listcntRuselsa="+encodeURIComponent(listcnt);
		var rusesra_url = "https://www.lib.kansai-u.ac.jp/webopac/rusesra.do?" + url;
		location.href = rusesra_url;
	}

	// 特定利用者のレビュー一覧画面表示
	function opacRusesrh(id, formkeyno, bibid, volbr, isbn, revid, stpos, sortkey, listcnt, userid,
			action, needSortkey, needListcnt, needStpos, svcaction){
		var url = "";
		if(formkeyno != null){
			url += "&formkeyno="+encodeURIComponent(formkeyno);
		}
		if(bibid != null){
			url += "&pkey="+encodeURIComponent(bibid);
		}
		if(volbr != null){
			url += "&pkeyVol="+encodeURIComponent(volbr);
		}
		if(isbn != null){
			url += "&pkeyIsbn="+encodeURIComponent(isbn);
		}
		if(revid != null){
			url += "&pkeyRevid="+encodeURIComponent(revid);
		}
		if(stpos != null){
			url += "&stposRuse="+encodeURIComponent(stpos);
		}
		if(sortkey != null){
			url += "&sortkeyRuse="+encodeURIComponent(sortkey);
		}
		if(listcnt != null){
			url += "&listcntRuse="+encodeURIComponent(listcnt);
		}
		if(userid != null){
			url += "&userid="+encodeURIComponent(userid);
		}
		if(action != null){
			// 遷移元情報を付与(レビュー一覧:Revlsa / レビュー詳細画面:Rev)
			url += "&targetAction="+encodeURIComponent(action);
			if(needSortkey != null){
				url = url + "&sortkey" + action + "=" + encodeURIComponent(needSortkey);
			}
			if(needListcnt != null){
				url = url + "&listcnt" + action + "=" + encodeURIComponent(needListcnt);
			}
			if(needStpos != null){
				url = url + "&stpos" + action + "=" + encodeURIComponent(needStpos);
			}
		}
		if(svcaction != null && svcaction != ""){
			url += "&svcaction="+encodeURIComponent(svcaction);
		}
		var rusesrh_url="https://www.lib.kansai-u.ac.jp/webopac/rusesrh.do?" + url
		location.href = rusesrh_url;
	}

	//レビュー詳細画面表示(投稿者一覧画面、特定利用者のレビュー一覧画面表示経由)
	function opacRusedbl(id, formkeyno, stposCmt, stposRev, stposRevlsa, action, bibid, volbr, isbn, userid, svcaction,listcnt){

		var url = "";
		if(formkeyno != null){
			url += "&formkeyno="+encodeURIComponent(formkeyno);
		}
		if(stposCmt != null){
			url += "&stposCmt="+encodeURIComponent(stposCmt);
		}
		if(stposRev != null){
			url += "&stposRev="+encodeURIComponent(stposRev);
		}
		if(stposRevlsa != null){
			url += "&stposRevlsa="+encodeURIComponent(stposRevlsa);
		}
		if(listcnt != null){
			url += "&listcntRev="+encodeURIComponent(listcnt);
		}
		if(action != null){
			// 遷移元情報を付与(投稿者一覧画面:rusesra / 特定利用者画面のレビュー一覧画面:rusesrh)
			url += "&originTransition="+encodeURIComponent(action);
		}
		if(bibid != null){
			// 書誌ID
			url += "&pkey="+encodeURIComponent(bibid);
		}
		if(volbr != null){
			// 巻号
			url += "&pkeyVol="+encodeURIComponent(volbr);
		}
		if(isbn != null){
			// ISBN
			url += "&pkeyIsbn="+encodeURIComponent(isbn);
		}
		if(userid != null){
			// 利用者ID
			url += "&userid="+encodeURIComponent(userid);
		}
		if(svcaction != null && svcaction != ""){
			url += "&svcaction="+encodeURIComponent(svcaction);
		}
		var revdbl_url = "https://www.lib.kansai-u.ac.jp/webopac/revdbl.do?" + url;
		location.href = revdbl_url;
	}

	//スタンプ登録画面のポップアップ表示用
	function opacStampPopup(id,event,bibid){
		var url = "stppop.do?";
		url += "bibid=" + encodeURIComponent(bibid);

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data,true,true);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}

	//スタンプ登録用
	function opacStampExe(id,bibid,stpno){
		var url = "stpexe.do?";
		url += "bibid=" + encodeURIComponent(bibid);
		url += "&stpno=" + encodeURIComponent(stpno);
		url += "&ufiFlg=true";
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				 document.getElementById('opac_stppopup'+id).innerHTML = data;
			},
			error: function(xhr, textStatus, errorThrown){
					
			}
		});
	}

	//ボタンの連クリックを抑制 - レビュー一覧と投稿者一覧間の遷移
	function DisableButton(obj, ajax_area){
		// 非活性化
		obj.disabled=true;
		
		// ボタンアニメーションを動作させる
		var loading_el = document.getElementById(ajax_area);
		var div_parent = document.createElement("DIV");
		div_parent.innerHTML = "<div class=\"loading\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
		var div = div_parent.childNodes[0];
		jQuery(div).addClass("loading");
		
		// 位置情報を設定
		var loading_imege_offset_x = 8;
		var loading_imege_offset_y = 16;
		var offset = jQuery(loading_el).position();
		
		var ex1 = offset.left;
		var ey1 = offset.top;
		
		div.style.left = (ex1 + (loading_el.offsetWidth/2) - loading_imege_offset_x) +"px";
		div.style.top  = (ey1 + (loading_el.offsetHeight/2) - loading_imege_offset_y + 10) +"px";
		
		loading_el.appendChild(div_parent);
	}

	// Local書誌詳細に関連資料（別巻号）を表示する
	function opacRelbibAjaxLocal(id,bibid,target,refFlg){
			var url = null;
			if(refFlg == "true"){
				// 並列書誌
				url = "ajaxrelbiblcl.do?";
			}else{
				// 別巻号
				url = "ajaxathvollcl.do?";
			}
			url += "bibid="+encodeURIComponent(bibid);
			
			var div = ajaxLoading(target);
			$.ajax({
				url: url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					jQuery("#"+target).html(data);
					$(div).remove();
				},
				error: function(xhr, textStatus, errorThrown){
					$(div).remove();
				}
			});
	}

	// NII書誌詳細に関連資料（並列書誌・別巻号）を表示する
	function opacRelbibAjaxNii(id,ncid,target,refFlg){
		var url = null;
		if(refFlg == "true"){
			// 並列書誌
			url = "ajaxrelbibnii.do?";
		}else{
			// 別巻号
			url = "ajaxathvolnii.do?";
		}
		url += "ncid="+encodeURIComponent(ncid);
		var div = ajaxLoading(target);
		jQuery.ajax({
			url: url,
			dataType: "html",
			type: "POST",
			cache: false,
			success: function(data, textStatus){
				jQuery("#"+target).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	function dspclvBytogid(form_id, action, bibid, togid, stposTog,chkhol){
		var w;
		document.getElementById(form_id).action=action;
		document.getElementById(form_id).target='Dspclv';
		document.getElementById(form_id).pkey.value=bibid;
		document.getElementById(form_id).pkeyTog.value=togid;
		document.getElementById(form_id).stposTog.value=stposTog;
		document.getElementById(form_id).chkhol.value=chkhol;
		w = window.open("", document.getElementById(form_id).target, "location=yes, toolbar=no, directories=no, menubar=no, status=no, resizable=yes, scrollbars=yes, width=225,height=520");
		document.getElementById(form_id).hitcntTog.value='1000000';
		document.getElementById(form_id).initFlg.value='';
		document.getElementById(form_id).submit();
		document.getElementById(form_id).target='';
		w.focus();
	}

	function opacClnBlockPlus(value_cln,delimiter,callno_cnt,clnlabel_pri,event){
		//請求記号１
		var cln1 = "";
		//請求記号２
		var cln2 = "";
		//請求記号３
		var cln3 = "";
		//請求記号４
		var cln4 = "";
		//請求記号５
		var cln5 = "";
		
		//delimiterで請求記号値を分ける
		var clnArray = value_cln.split(delimiter);
		//請求記号１があれば
		cln1 = opacClnsChk(clnArray[0]);
		//請求記号２があれば
		cln2 = opacClnsChk(clnArray[1]);
		//請求記号３があれば
		cln3 = opacClnsChk(clnArray[2]);
		//請求記号４があれば
		cln4 = opacClnsChk(clnArray[3]);
		//請求記号５があれば
		cln5 = opacClnsChk(clnArray[4]);
		//請求記号１、２、３、４、５のいずれがあれば、ポップ画面を表示する
		if(cln1!="　"||cln2!="　"||cln3!="　"||cln4!="　"||cln5!="　"){
			//表示内容を編集
			var content = "";
			var clnArray_new = new Array(5);
			clnArray_new[0] = cln1;
			clnArray_new[1] = cln2;
			clnArray_new[2] = cln3;
			clnArray_new[3] = cln4;
			clnArray_new[4] = cln5;
			
			//段数の登録データ優先フラグが有効な場合
			if(clnlabel_pri == "true"){
				var data_cnt = 0;
				//cln5に値があれば5段表示
				if(cln5!="　"){
					data_cnt = 5;
				}
				//cln4に値があれば4段表示
				else if(cln4!="　"){
					data_cnt = 4;
				}
				//cln3に値があれば3段表示
				else if(cln3!="　"){
					data_cnt = 3;
				}
				//cln2に値があれば2段表示
				else if(cln2!="　"){
					data_cnt = 2;
				}
				//登録データ数がcallno_cntより多ければそちらを優先
				if(data_cnt > callno_cnt){
					callno_cnt = data_cnt;
				}
			}
			
			//ラベル内容の構築
			content += "<span class=\"cln_block\"><table>";
			for(var i = 0 ; i < callno_cnt ; i++){
				//最後の行の場合に、Endのタグを付く
				if(i + 1 == callno_cnt){
					content += "<tr><td nowrap>" + clnArray_new[i] + "</td></tr>";
					content += "</table></span>";
				//最後の行ではない場合に、表示クラスを指定して、下線を表示する
				}else{
					content += "<tr><td class=\"td_cln\" nowrap>" + clnArray_new[i] + "</td></tr>";
				}
			}
			
			var cln_popup = document.getElementById("cln_popup");
			if(cln_popup == null){
				cln_popup = document.createElement('div');
				cln_popup.id = "cln_popup";
				cln_popup.style.position = "absolute";
				document.body.appendChild(cln_popup);
			}
			
			cln_popup.innerHTML = content;
			var cx = event.clientX + (document.body.scrollLeft || document.documentElement.scrollLeft);
			var cy = event.clientY + (document.body.scrollTop  || document.documentElement.scrollTop);
			cln_popup.style.left = (cx + 6) + 'px';
			cln_popup.style.top = (cy + 6) + 'px';
			cln_popup.style.display = 'block';
		}
	}

	function opacNoteBlock(id,event,note){
		
		var note_popup = document.getElementById("_note_popup"+id);
		if(note_popup != null){
			PopUpClose();
		}

		PopUpOpenAjax(note,true);
	}

	function opacFtfsrhAjax(bibid,stposVol,id,ajax_area){
		url = "ftfsrh.do?";
		url += "bibid="+encodeURIComponent(bibid);
		url += "&stposVol="+encodeURIComponent(stposVol);

		var div = ajaxLoading(ajax_area);

		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				$("#"+ajax_area).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	function sendErmsSearch(form_el, formkeyno){
		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		//二度押し防止：ロック
		this.search_lock = true;
		
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/ermssrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function erms_opacSetStartpos(stpos, id, form_name){
		var form_el = document.getElementById(form_name);
		form_el.startpos.value = stpos;
		sendErmsSearch(form_el);
	}
	
	function opacLogin(formkeyno){
		var login_url = "https://www.lib.kansai-u.ac.jp/webopac/ufisnd.do";
		
		var act = location.pathname.replace(/.*\//,"");
		login_url += "?redirect_act="+encodeURIComponent(act);
		if(formkeyno != null && formkeyno != ''){
			login_url += "&redirect_formkeyno=" + encodeURIComponent(formkeyno);
		}
		if(this.disp_num){
			login_url += "&tab_num=" + encodeURIComponent(this.disp_num);
		}
		location.href = login_url;
	}
	
	function opacLogoff(){
		var logoff_url = "https://www.lib.kansai-u.ac.jp/webopac/comoff.do";
		location.href = logoff_url + "?mode=logout";
	}
	
	function getBibidSelected(search_form,pkey){
		if(pkey == null){
			pkey = "bibid";
		}
		var bibidStr = "";
		var formBibids = search_form[pkey];
		
		if(formBibids != null){
			if(formBibids.length == undefined ){
				bibidStr = formBibids.value+"|";
			}else{
				for(var i = 0 ; i < formBibids.length ; i++){
					if(formBibids[i].checked == true){
						if(bibidStr.indexOf(formBibids[i].value) == -1){
							bibidStr += formBibids[i].value+"|";
						}
					}
				}
			}
		}
		return bibidStr.substr(0,bibidStr.length-1);
	}

	function openPrintPreview(printElementId) {
		window.print();
	}

	function openPrintPopup(printPopupId) {
		var div = document.getElementById(printPopupId);
		document.getElementsByClassName("opac_footer_area print_none")[0].style.display="none";
		var iframe = document.createElement('iframe');
		iframe.id="printf";
		iframe.width=0;
		iframe.height=0;
		iframe.frameBorder=0;
		div.appendChild(iframe);
		var printData = document.getElementById(printPopupId).innerHTML;
		iframe.contentDocument.write(printData);
		iframe.contentDocument.close();
		iframe.contentWindow.print();
		document.getElementsByClassName("opac_footer_area print_none")[0].style.display="block";
	}

	function dspclvByholidLocal(form_id, action, bibid, holid, stposHol, local_area_code){
		var w;
		document.getElementById(form_id).action=action;
		document.getElementById(form_id).target='Dspclv';
		document.getElementById(form_id).pkey.value=bibid;
		document.getElementById(form_id).pkeyHol.value=holid;
		document.getElementById(form_id).stposHol.value=stposHol;
		document.getElementById(form_id).local_area_code.value=local_area_code;
		w = window.open("", document.getElementById(form_id).target, "location=yes, toolbar=no, directories=no, menubar=no, status=no, resizable=yes, scrollbars=yes, width=225,height=520");
		document.getElementById(form_id).hitcntHol.value='';
		document.getElementById(form_id).initFlg.value='';
		document.getElementById(form_id).submit();
		document.getElementById(form_id).target='';
		w.focus();
	}

	function getQueryValue(queryName) {
		var query = decodeURI(window.location.search.substring(1));
		var vars = query.split("&");
		for (var i = 0; i < vars.length; i++) {
			var pair = vars[i].split("=");
			if (pair[0] == queryName) { return pair[1]; }
		}
		return null;
	}

	function backtoCatdbl(pkey,old_formkeyno){
		var catdal_url = "https://www.lib.kansai-u.ac.jp/webopac/catdbl.do?bibid=" + pkey + "&old_formkeyno=" + old_formkeyno;
		location.href = catdal_url;
	}

	function sendScTabSearch(form_el,id,sc_num,mode){
		this.old_search_form = form_el.cloneNode(true);
		formConvert(form_el,this.old_search_form);
		this.search_mode = mode;

		var params = jQuery(form_el).serialize();
		sessionStorage.setItem("old_search_form",params);
		sessionStorage.setItem("old_search_form_id",this.old_search_form.id);
		sessionStorage.setItem("search_mode",this.search_mode);
		sessionStorage.setItem("old_sc_form_id",sc_num);
		
		
		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		
		var search_page = document.getElementById('search_page'+this.disp_num);
		if(search_page == null){
			return false;
		}
		search_page.innerHTML = '';
		
		var opt_page = document.getElementById('opt_page'+this.disp_num);
		if(opt_page == null){
			return false;
		}
		opt_page.innerHTML = '';
		
		form_el.tab_num.value = this.disp_num;
		if(this.search_mode != null){
			form_el.search_mode.value = this.search_mode;
		}
		
		//二度押し防止：ロック
		this.search_lock = true;
		sessionStorage.setItem("query_str",jQuery(form_el).serialize());
		
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/sctabsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}

	function scStatus(tab_num,system){
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?";	
		url += "tab_num=" + encodeURIComponent(tab_num);
		url += "&system=" + encodeURIComponent(system);
		url += "&method=scStatus";
		
		$.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				$('#ajax_area'+tab_num).html(data);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}
	
	function scLinklistButton(target,area_id){
		
		var myopac_el = document.getElementById(target+area_id);
		if(myopac_el != null){
			PopUpOpenAjax(myopac_el.outerHTML);
		}

		var list_el = document.getElementById(target+area_id);
		if(list_el.style.display != "block"){
			list_el.style.display = "block";
		}else{
			list_el.style.display = "none";
		}
	}
	
	function scLoading(tab_num){
		var loading_el = document.getElementById('loading_area'+tab_num);
		if(loading_el != null){
			var div_parent = document.createElement("DIV");
			div_parent.innerHTML = "<div class=\"loading\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
			var div = div_parent.childNodes[0];
			$(div).addClass("loading");
			var loading_imege_offset_x = 8;
			var loading_imege_offset_y = 8;

			var offset = $('#loading_area'+tab_num).position();
			var ex1 = offset.left;
			var ey1 = offset.top;

			div.style.left = (ex1 + (loading_el.offsetWidth/2) - loading_imege_offset_x) +"px";
			div.style.top  = (ey1 + (loading_el.offsetHeight/2) - loading_imege_offset_y) +"px";

			loading_el.appendChild(div_parent);
		}
	}
	
	function scResearch(siteid,hitcnt,id,num){
		document.getElementById('search_page'+this.disp_num).innerHTML = '';
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?";	
		url += "siteid="+encodeURIComponent(siteid);
		url += "&sitehitcnt="+encodeURIComponent(hitcnt);
		url += "&tab_num="+encodeURIComponent(num);
		url += "&method=scResearch";
		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				jQuery('#search_list'+num).html(data);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		}); 
	}
	
	function scSearchStop(id,num){
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?siteid=&dispname=&sitehitcnt=&stopflg=true&method=scSearchStop";
		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				jQuery('#search_list'+num).html(data);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}
	
	function scUsrsrd(siteid,sysno,id,event){
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?";
		url += "siteid=" + encodeURIComponent(siteid);
		url += "&sysno=" + encodeURIComponent(sysno);
		url += "&ufi_flg=true";
		url += "&method=scUsrsrd";

		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data);
			},
			error: function(xhr, textStatus, errorThrown){
				
			}
		});
	}
	
	function scDownloadOpen(id,event,form_el){
		var sysno = jQuery(form_el).serialize();
		if(sysno.indexOf("sysno_check") != -1){
			sysno = sysno.replace(/sort.*?dispnum.*?&sysno_check=/,"");
			sysno = sysno.replace(/&sysno_check=/g,",");
			var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?";
			url += "downloadSysno=" + encodeURIComponent(sysno);
			url += "&ufi_flg=true";
			url += "&method=scDownloadOpen";
			
			jQuery.ajax({
				url: url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					PopUpOpenAjax(data);
					$("div.opac_book_option_area ul li").css("height","24px");
				},
				error: function(xhr, textStatus, errorThrown){
					
				}
			});
			
		}else{
			alert("書誌が選択されていません");
		}
	}
	
	function scDownloadFile(id,downloadSysno,format){
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?";
		url += "format=" + encodeURIComponent(format);
		url += "&downloadSysno=" + encodeURIComponent(downloadSysno);
		url += "&ufi_flg=true";
		url += "&method=scDownloadFile";
		location.href = url;
	}
	
	function scCheckSysno(form_el,func){
		var boxs = form_el.sysno_check;
		if(boxs.length){
			for(num=0; num < boxs.length; num++){
				boxs[num].checked = func;
			}
		}else{
			boxs.checked = func;
		}
	}
	
	function scDtlurlCheck(url){
		if(url.indexOf("http://") == 0 || url.indexOf("https://") == 0){
			window.open(url,"detwin");
		}else{
			var pattern = new RegExp("^/.*?/");
			var url_rep = url.replace(pattern,"/");
			var paramurl = "https://www-uf01.ufinity.jp/cassV3" + url_rep;

			window.open(paramurl,"detwin");
		}
	}
	
	function scListChange(startno,sort,dispnum,id,num){
		document.getElementById('search_page'+id+this.disp_num).innerHTML = '';
		var form_el = document.getElementById("sc_searchlist_form_"+this.disp_num);
		
		this.disp_num = num;
		if(this.disp_search_mode == null || this.disp_search_mode== "simple"){
			form_el.search_mode.value = "simple";
		}else{
			form_el.search_mode.value = "detail";
		}
		form_el.tab_num.value = num;
		form_el.startno.value = encodeURIComponent(startno);
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/sctabsrh.do";
		form_el.method = "POST";
		form_el.submit();
	}
	
	function scSubmitLink(sysno,linkurlid,locale) {
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?";
		url += "sysno="+sysno;
		url += "&linkurlid="+linkurlid;
		url += "&locale="+locale;
		url += "&ufi_flg=true";
		url += "&method=scSubmitLink";
		window.open(url,"_blank");
	}
	
	function clearCattp(id) {
		var cattp = document.getElementById("sc_cattp_table"+id).getElementsByTagName('input');
		
		cattp[0].checked = true;
		cattp[1].checked = false;
		cattp[2].checked = false;
		cattp[3].checked = false;
		// 視聴覚資料が表示されている時はここのチェックも変更
		if(cattp.length == 5 ){
			cattp[4].checked = false;
		}
	}
	
	// 資料種別のうち、「全て」以外がチェックされた際に「全て」のチェックを解除し、
	// チェックが全部外された際には「全て」にチェックを入れる
	function cattpCheckEach(id) {
		var cattp = document.getElementById("sc_cattp_table"+id).getElementsByTagName('input');
		
		if(cattp[1].checked == true ||
			cattp[2].checked == true ||
			cattp[3].checked == true ||
			(cattp.length == 5 &&
			cattp[4].checked == true)) {
			cattp[0].checked = false;
		}else{
			cattp[0].checked = true;
		}
	}
	
	// クリア（資料種別）
	// 「全て」が末尾の場合の処理
	function clearCattp2(id) {
		var cattp = document.getElementById("sc_cattp_table"+id).getElementsByTagName('input');
		
		// 初期化
		cattp[0].checked = false;
		cattp[1].checked = false;
		cattp[2].checked = false;
		cattp[3].checked = true;
		// 視聴覚資料が表示されている時はここのチェックも変更
		if(cattp.length == 5 ){
			cattp[3].checked = false;
			cattp[4].checked = true;
		}
	}
	
	// 資料種別のうち、「全て」以外がチェックされた際に「全て」のチェックを解除し、
	// チェックが全部外された際には「全て」にチェックを入れる
	// 「全て」が末尾の場合の処理
	function cattpCheckEach2(id) {
		var cattp = document.getElementById("sc_cattp_table"+id).getElementsByTagName('input');
		
		if(cattp[0].checked == true ||
			cattp[1].checked == true ||
			cattp[2].checked == true ||
			(cattp.length == 5 &&
			cattp[3].checked == true)) {
			if(cattp.length == 4){
				cattp[3].checked = false;
			}else if(cattp.length == 5){
				cattp[4].checked = false;
			}
		}else{
			if(cattp.length == 4){
				cattp[3].checked = true;
			}else if(cattp.length == 5){
				cattp[4].checked = true;
			}
		}
	}

	function scMysshh(id, tab_num){
		if(typeof (tab_num) == "undefined" || null ==tab_num){
			tab_num = this.disp_num;
		}
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabhis.do?";
		url += "ufi_flg=false"
		url += "&tab_num=" + encodeURIComponent(tab_num);
		url += "&method=scMysshh";
		location.href = url; 
	}

	function scCheckDelFormno(form_el,func){
		var boxs = form_el.del_formno;
		if(boxs.length){
			for(num=0; num < boxs.length; num++){
				boxs[num].checked = func;
				}
		}else{
			boxs.checked = func;
		}
	}
	
	function scMysexe(id,formno,tab_num){
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabhis.do";
		url += "?formno=" + encodeURIComponent(formno);
		url += "&tab_num=" + encodeURIComponent(tab_num);
		url += "&method=scMysexe";
		
		location.href = url;
	}
	
	function scMysexeSrh(id,form_el,tab_num){
		this.disp_num = tab_num;
		if(form_el.keywd == null){
			this.disp_search_mode = "detail";
		}else{
			this.disp_search_mode = "simple";
		}
		
		this.search_mode = this.disp_search_mode;
		if(this.search_lock == true){
			alert("処理の実行中です。そのままお待ちください。");
			return false;
		}
		
		form_el.tab_num.value = this.disp_num;
		if(this.search_mode != null){
			form_el.search_mode.value = this.search_mode;
		}
		//二度押し防止：ロック
		this.search_lock = true;
		sessionStorage.setItem("query_str",jQuery(form_el).serialize());
		form_el.action = "https://www.lib.kansai-u.ac.jp/webopac/sctabsrh.do";
		form_el.method = "POST";
		form_el.submit(); 
	}
	
	function scMysdel(id,form_el,event,tab_num){
	 	var del_formno = jQuery(form_el).serialize();
		if(del_formno.indexOf("del_formno") != -1){
			var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabhis.do?";
			url += del_formno;
			url += "&modal_flag=true";
			url += "&ufi_flg=true";
			url += "&tab_num=" + encodeURIComponent(tab_num);
			url += "&method=scMysdel";

			jQuery.ajax({
				url: url,
				dataType: "html",
				cache: false,
				success: function(data, textStatus){
					PopUpOpenAjax(data);
				},
				error: function(xhr, textStatus, errorThrown){
					
				}
			});
		
		}else{
			alert("検索条件が選択されていません。");
		}  
	}
	
	function scMyssts(id,event){
		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?";
		url += "modal_flag=true";
		url += "&dispCookieButton=false";
		url += "&ufi_flg=false";
		url += "&method=scMyssts";
		jQuery.ajax({
			url: url,
			dataType: "html",
			cache: false,
			success: function(data, textStatus){
				PopUpOpenAjax(data);
			},
			error: function(xhr, textStatus, errorThrown){

			}
		});
	}
	
	function scMyscmp(id,form_el){
		var displayCookieSave = document.getElementsByName("displayCookieSaveButton");
		if(displayCookieSave != null){
			if(displayCookieSave[0].value == "true"){
				// クッキーの保存
				saveCookie(id,form_el);
			}
		}

		var tab_num = this.disp_num;
		if(this.disp_search_mode != null){
			var mode = this.disp_search_mode;
		}else{
			var mode = "simple";
		}

		var url = "https://www.lib.kansai-u.ac.jp/webopac/sctabifr.do?method=scMyscmp";
		jQuery.ajax({
			url: url,
			type: "POST",
			dataType: "html",
			data: jQuery(form_el).serialize(),
			cache: false,
			success: function(data, textStatus){
				location.href = "https://www.lib.kansai-u.ac.jp/webopac/cattab.do?" + "search_mode=" + mode + "&tab_num=" + encodeURIComponent(tab_num);
			},
			error: function(xhr, textStatus, errorThrown){

			}
		});
	}
	
	function saveCookie(id,form_el){
		
		var path = location.pathname;

		var paths = new Array();
		paths = path.split("/");
		if(paths[paths.length-1] != ""){
			paths[paths.length-1] = "";
			path = paths.join("/");
		}
		
		var extime = new Date().getTime();
		var cltime;
		
		var sitesID = getSitesID(id);
		if(sitesID != ""){
			// 10年後に設定
			cltime = new Date(extime + (60 * 60 * 24 * 365 * 10 * 1000));
		}else{
			// 未チェック時は過去にして削除
			cltime = new Date(extime - (60 * 60 * 24 * 1000));
		}
		var exdate = cltime.toUTCString();

		var cookieData="";
		
		cookieData += "ufi_cookie_save_site=" + sitesID;
		cookieData += ";path=" + path;
		cookieData += ";expires=" + exdate + ";";
		
		// クッキーに保存
		document.cookie = cookieData;
		
	}
	
	function scSiteGrpTgl(id,gid){
		var grptglArea = document.getElementById("sc_grptgl"+gid+id);
		var grpsiteArea = document.getElementById("sc_sitegrp"+gid+id);

		if(grpsiteArea.style.display == "block"){
			grpsiteArea.style.display = "none";
			grptglArea.innerHTML = grptglArea.innerHTML.replace("minus.png","plus.png");
		}else{
			grpsiteArea.style.display = "block";
			grptglArea.innerHTML = grptglArea.innerHTML.replace("plus.png","minus.png");
		}
	}
	
	function opacScPopfaq(ufinity_url, faqKeyStr){
		const [block_id, frame_id, faq_question_key] = faqKeyStr.split(',');
		var url = `${ufinity_url}/faqs/faq_questions/view/${block_id}/${faq_question_key}?frame_id=${frame_id}`;
		window.open(url);
	} 
	
	function clearSearchErrorMsg(){
		var msg_area = document.getElementById('opac_description_area');
		var smlr_area = document.getElementById('opac_smlr_area');
		if(msg_area != null){
			msg_area.innerHTML = '';
		}
		if(smlr_area != null){
			smlr_area.innerHTML = '';
		}
	}
	
	function opacErmsacrAjax(gcattp, isbn_issn, bibid, ajax_area){
		url = "ermsacr.do?";
		url += "gcattp="+encodeURIComponent(gcattp);
		url += "&isbn_issn="+encodeURIComponent(isbn_issn);
		url += "&bibid="+encodeURIComponent(bibid);
		
		var div = ajaxLoading(ajax_area);
		
		jQuery.ajax({
			url: url,
			dataType: "html",
			method:"post",
			cache: false,
			success: function(data, textStatus){
				$("#"+ajax_area).html(data);
				$(div).remove();
			},
			error: function(xhr, textStatus, errorThrown){
				$(div).remove();
			}
		});
	}

	function showSearch(visible){
		var searchArea = document.getElementById('open');
		if(visible){
			$('.open').css({
			    'visibility':'visible',
			     'height':'auto',
				 'opacity':'1'
			});
			document.getElementById('open_searchArea').style.display = "none";
			document.getElementById('close_searchArea').style.display = "block";
			<!-- 2024.08.21 検索窓下にメッセージ追加-->
			document.getElementById('kgu_news').style.display = "none";
		}else{
			$('.open').css({
			    'visibility':'hidden',
			    'padding':'0 1em',
			     'height':'20',
				 'opacity':'0'
			});
			document.getElementById('open_searchArea').style.display = "block";
			document.getElementById('close_searchArea').style.display = "none";
			<!-- 2024.08.21 検索窓下にメッセージ追加-->
			document.getElementById('kgu_news').style.display = "none";
		}
	}

	function SimilarSearch(keywords,tab_num){
		let form = document.getElementById('opac_tab_form'+tab_num);
		let button = form.getElementsByClassName("opac_keyword_input_area")[0].children[1];
		form["words"].value = keywords;
		button.click();
	}

	function ajaxLoading(ajax_area){
		var loadingarea = document.getElementById(ajax_area).querySelector("#load");
		if (loadingarea == null) {
			var loading_el = document.getElementById(ajax_area);
			var div_parent = document.createElement("DIV");
			div_parent.innerHTML = "<div class=\"loading\" id=\"load\"><img text=\"loading\" alt=\"loading\" src=\"https://www.lib.kansai-u.ac.jp/webopac/css/indicator.gif\"/></div>";
			var div = div_parent.childNodes[0];
			var loading_imege_offset_x = 8;
			var loading_imege_offset_y = 8;

			var divwidth = document.getElementById(ajax_area).offsetWidth;
			var divheight = document.getElementById(ajax_area).offsetHeight;

			div.style.left = (divwidth/2 - loading_imege_offset_x) +"px";
			div.style.top  = (divheight/2 - loading_imege_offset_y) +"px";
			$(div).css("position","relative");
			loading_el.appendChild(div_parent);
			return div;
		} else {
			return loadingarea;
		}
	}
</script>

























	






	



	


<header class="main_header">
	<div class="header_wrapper">
		<div class="logoArea print_none">


			<a href="https://www.lib.kansai-u.ac.jp/webopac/cattab.do">
				<img src="https://www.lib.kansai-u.ac.jp/webopac/image/organization_logo.png"
					title="KOALA 関西大学 図書館"
		 			alt="KOALA 関西大学 図書館"/>
		 	</a>
		</div>
		<div class="loginArea print_none">
			
			<a href="https://opac.lib.kansai-u.ac.jp">
					<span>図書館TOP</span></a>
			
			
				<a href="#" onclick="opacLogin('230937384hEweK39H5');return false;">
					<span>ログイン</span></a>
			
			
		</div>
	</div>
	<script type="text/javascript">
		
		$(function(){
			$("#useInfoLink").on('click', function(){
				let action = 'https://www.lib.kansai-u.ac.jp/webopac/asklst.do';
				let target = 'Service';
				let method = 'post';
				
				
					action = action.replace("http:","https:");
					target = 'Service' + '1737592659018';
				

				
					method = 'get';
				

				$('<form/>',{id:"header_askform", action:action, method:method, target:target})
				.append("<input type='hidden' name='systime' value='" + "1737592659018" + "'>")
				
				.appendTo($('body'));
				
				let submitForm = document.getElementById("header_askform");
				opacUseFunction('','false',submitForm,'AskMenu','ja', false);
				return false;
			});
		});
		
	</script>
</header>
<div class="contents_wrapper">
			<div class="opac_container cell">
				





















	






	

























































<form id="head_askform">
	<input type="hidden" name="systime" value=""/>
	<input type="hidden" name="loginType" value=""/>
</form>

<form id="head_odrform">
	<input type="hidden" name="systime" value=""/>
	<input type="hidden" name="loginType" value=""/>
	<input type="hidden" name="mode" value="new"/>
	<input type="hidden" name="reqType" value="_NEW"/>
	<input type="hidden" name="dbTarget" value="LOCAL"/>
	<input type="hidden" name="volsflg" value="false"/>
</form>

<form id="head_illform">
	<input type="hidden" name="systime" value=""/>
	<input type="hidden" name="loginType" value=""/>
	<input type="hidden" name="srvce" value=""/>
	<input type="hidden" name="mode" value="new"/>
	<input type="hidden" name="reqType" value="_NEW"/>
	<input type="hidden" name="bsflg" value=""/>
	<input type="hidden" name="dbTarget" value="LOCAL"/>
	<input type="hidden" name="volsflg" value="false"/>
</form>

<form id="head_folform">
	<input type="hidden" name="system" value=""/>
	<input type="hidden" name="loginType" value=""/>
	<input type="hidden" name="display" value=""/>
</form>

<form id="head_sdiform">
	<input type="hidden" name="systime" value=""/>
	<input type="hidden" name="loginType" value=""/>
</form>

<form id="head_rsvform">
	<input type="hidden" name="systime" value=""/>
	<input type="hidden" name="loginType" value=""/>
	<input type="hidden" name="srvce" value=""/>
	<input type="hidden" name="mode" value="new"/>
	<input type="hidden" name="reqType" value="_NEW"/>
	<input type="hidden" name="bsflg" value=""/>
	<input type="hidden" name="dbTarget" value="LOCAL"/>
	<input type="hidden" name="volsflg" value="false"/>
</form>

<form id="head_areform">
	<input type="hidden" name="systime" value=""/>
	<input type="hidden" name="loginType" value=""/>
</form>

<div class="opac_container">
	
		
	<div class="opac_headermenu_area print_none">
		<ul class="opac_headermenu">
			
			
			
			<li>
				<a class="opac_btn_big" href="#" onclick="return false;">
					<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/com/icon_mokuroku.png" title="目録検索" alt="目録検索"/>
					目録検索 ▼
				</a>
				<ul>
					<li class="first"></li>
					<li>
						
						
							
								<a class="opac_link arrow_r" href="#" onclick="sendOpacInitPage('','ja');return false;">
							
							
							検索トップへ
							</a>
						
					</li>
					
					<li>
						<a class="opac_link arrow_r" href="#" onclick="sendOtherSearch('','catsrc');">
							分類検索
						</a>
					</li>
					
					
					<li>
						<a class="opac_link arrow_r" href="#" onclick="sendOtherSearch('','catsrm');">
							雑誌検索リスト
						</a>
					</li>
					
					
					
					<li>
						<a class="opac_link arrow_r" href="#" onclick="sendOtherSearch('','newlst');">
							新着図書案内
						</a>
					</li>
					
					
					<li>
						<a class="opac_link arrow_r" href="#" onclick="sendOtherSearch('','beslst');">
							ベストリーダ
						</a>
					</li>
					
					
					
					
					
					
					<li class="last"></li>
				</ul>
			</li>
			
			
			
			<li>
				<a class="opac_btn_big" href="#" onclick="return false;">
					<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/com/icon_myaccount.png" title="利用者サービス" alt="利用者サービス"/>
					利用者サービス ▼
				</a>
				<ul>
					<li class="first"></li>
					
						<li>
							<a class="opac_link arrow_r" href="#" onclick="AskMenu(false);">
								MyLibrary<br/>（利用状況照会）
							</a>
						</li>
						<script class="nc_script" type="text/javascript">
							function AskMenu(autoFlg){
								var askform = document.getElementById("head_askform");
			
								
								  var url = 'https://www.lib.kansai-u.ac.jp/webopac/asklst.do';
								  url = url.replace("http:","https:");
								  askform.action = url;
								  askform.target = 'Service' + '1737592659026';
								
								
								
								askform.systime.value = "1737592659026";
								
								
								
								askform.method = "post";
								
									askform.method = "get";
								
								
								opacUseFunction('','false',askform,'AskMenu','ja',autoFlg);
							}
							
						</script>
					
					
						<script class="nc_script" type="text/javascript">
							function FolMenu(display,autoFlg) {
								var follstform = document.getElementById("head_folform");
						
								
								  var url = 'https://www.lib.kansai-u.ac.jp/webopac/follst.do';
								  url = url.replace("http:","https:");
								  follstform.action = url;
								  follstform.target = 'Service' + '1737592659026';
								
								
								
								follstform.system.value = "1737592659026";
								follstform.display.value = display;
								
								
								
								follstform.method = "post";
								
									follstform.method = "get";
								
								
								opacUseFunction('','false',follstform,'FolMenu_'+display+'','ja',autoFlg);
							}
						</script>
						
							<li>
								<a class="opac_link arrow_r" href="#" onclick="FolMenu('fbmref',false);">
									ブックマーク
								</a>
							</li>
							<script class="nc_script" type="text/javascript">
								
							</script>
						
						
							<li>
								<a class="opac_link arrow_r" href="#" onclick="FolMenu('fhtref',false);">
									お気に入り検索
								</a>
							</li>
							<script class="nc_script" type="text/javascript">
								
							</script>
						
						
						
					
					
					
						<li>
							<a class="opac_link arrow_r" href="#" onclick="orderICP(false);">
								ILL複写依頼
							</a>
						</li>
						<script class="nc_script" type="text/javascript">
							function orderICP(autoFlg){
								var svcillform = document.getElementById("head_illform");
			
								
								  var url = 'https://www.lib.kansai-u.ac.jp/webopac/illexm.do';
								  url = url.replace("http:","https:");
								  svcillform.action = url;
								  svcillform.target = 'Service' + '1737592659026';
								
								
								
								svcillform.srvce.value='C';
								svcillform.bsflg.value='S';
								
								
								
								svcillform.method = "post";
								
									svcillform.method = "get";
								
								
								opacUseFunction('','false',svcillform,'orderICP','ja',autoFlg);
							}
							
						</script>
					
					
						<li>
							<a class="opac_link arrow_r" href="#" onclick="orderILN(false)">
								ILL貸借依頼
							</a>
						</li>
						<script class="nc_script" type="text/javascript">
							function orderILN(autoFlg){
								var svcillform = document.getElementById("head_illform");
			
								
								  var url = 'https://www.lib.kansai-u.ac.jp/webopac/illexm.do';
								  url = url.replace("http:","https:");
								  svcillform.action = url;
								  svcillform.target = 'Service' + '1737592659026';
								
								
								
								svcillform.srvce.value='B';
								svcillform.bsflg.value='';
								
								
								
								svcillform.method = "post";
								
									svcillform.method = "get";
								
								
								opacUseFunction('','false',svcillform,'orderILN','ja',autoFlg);
							}
							
						</script>
					
					
						<li>
							<a class="opac_link arrow_r" href="#" onclick="orderODR(false);">
								新規購入依頼
							</a>
						</li>
						<script class="nc_script" type="text/javascript">
							function orderODR(autoFlg){
								var svcodrform = document.getElementById("head_odrform");
			
								
								  var url = 'https://www.lib.kansai-u.ac.jp/webopac/odrexm.do';
								  url = url.replace("http:","https:");
								  svcodrform.action = url;
								  svcodrform.target = 'Service' + '1737592659026';
								
								
								
								
								
								svcodrform.method = "post";
								
									svcodrform.method = "get";
								
								
								opacUseFunction('','false',svcodrform,'orderODR','ja',autoFlg);
							}
							
						</script>
					
					
					<li class="last"></li>
				</ul>
			</li>
			
			
		</ul>
		
		
		<input type="checkbox" id="menu-toggle-opt_tab" class="menu-checkbox_opt_tab"/>
		<label for="menu-toggle-opt_tab" class="menu-button_opt_tab button-opt_tab">≡</label>
		<div class="drawer-menu-opt_tab">
			<ul class="opac_sub_headermenu">
				
				
				
					
					<li>
						<a href="#" onclick="sendOtherSearch('','bkmref');return false;">
							<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_etsuranrireki.png" title="閲覧履歴" alt="閲覧履歴"/>
						</a>
					</li>
					<span class="srd_gcattp" style="display:none"><br/><br/>
					</span>
				
				
				
					
					<li>
						<a href="#" onclick="sendOtherSearch('','hstref');return false;">
							<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_kensakurireki.png" title="検索履歴" alt="検索履歴" />
						</a>
					</li>
					<span class="srd_gcattp" style="display:none"><br/><br/>
					</span>
				
				
				<li class="opac_lang_english">
					
					
					
						
							<a href="#" onclick="opacLocaleChange('en','230937384hEweK39H5','simple');return false;">
						
						
								
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_dg_english_70-20.png" title="Language" alt="cap_language}" />
							</a>
					
				</li>
			</ul>
		</div>
		<label for="menu-toggle-opt_tab" class="menu-background_tab"></label>
	</div>
</div>
<div id="detail_object<{$id}>">
	<table class="opac_column_wrapper">
		<tr>
			<td class="opac_column_center">
				<form id="opac_list_formcatdbl" name="olformcatdbl" action="#">
					<input type="hidden" name="initFlg" value="_RESULT_SET_NOTBIB"/>
					<input type="hidden" name="stposVol" value=""/>
					<input type="hidden" name="fvol" value=""/>
					<input type="hidden" name="fannul" value=""/>
					<input type="hidden" name="pkey" value=""/>
					<input type="hidden" name="releaseHolFlg" value="false"/>
					
					<div class="opac_block_big">
						<div class="opac_ttl_big print_none" id="catdbl-BB61184090">
	<div class="float-right">
<button class="opac_imgbtn n_display" onclick="openPrintPreview('opac_print_targetcatdbl');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
				<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_lg_print_off_140-30.png" title="このページを印刷" alt="このページを印刷"  />
			</button>
		</div>
	<h2>
		書誌詳細</h2>

</div>
<div id="opac_print_targetcatdbl" class="opac_block_body_big">
							
							<div class="printout_header">
								<div class="opac_ttl_middle">
									<h3>KOALA 関西大学 図書館</h3>
								</div>
							</div>
							
							<div class="opac_pagechg_area_narrow_prevnext print_none">
								<div class="page_prev">
	</div>
	
<div class="page_up">
	<a href="#" onclick="sendOpacReSearch('23093737vdjgzndo0u','true');">
				検索結果一覧へ戻る</a>
		</div>
<div class="page_next">
	</div>
</div>
							
							<table class="opac_bookdetail_area">
	<tr class="z_display">
		<td class="opac_book_img_area">
			<div class="opac_book_img">
				<div id="ajax_imgdtl_area">
							<script class="nc_script" type="text/javascript">
								var screenwidth = window.innerWidth;
								if(window.attachEvent){
									if(screenwidth <= 810){
										window.attachEvent("onload", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area_responsive","120");});
									}else{
										window.attachEvent("onload", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","","catdbl","ajax_imgdtl_area","120");});
									}
								}else{
									if(screenwidth <= 810){
										window.addEventListener("load", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area_responsive","120");},true);
									}else{
										window.addEventListener("load", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area","120");},true);
									}
								}
								
								if(screenwidth <= 810){
									opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area_responsive","120");
								}else{
									opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area","120");
								}
							</script>
						</div>
					</div>
			</td>
		<td width="700px" style="float:left" class="res_summary_area">
			<div class="opac_book_summary_area">
				<img class="opac_icon_bookind" src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/icon_tosyo.png"/>
				<div class="opac_book_title_area_no_photo">
					<h3 class="opac_book_title">
						線形代数 : 大学教養</h3>
					<div class="opac_book_bibliograph">
						数研出版編集部編著. -- 数研出版, 2020. -- (チャート式シリーズ).
						&lt;BB61184090&gt;
					</div>
				
					</div>
			</div>
			
			<div class="opac_book_option_area">
				


































<div class="opac_opebtn_area_narrow opac_round_top opac_round_bottom print_none">
					<span class="opac_label">便利機能：</span>
					<div class="opac_syosisyousai_datas">
						<button class="opac_imgbtn" id="opacSendBkmIconDBLcatdbl" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_bookmark_off_.png" title="ブックマーク" alt="ブックマーク" />
							</button>
						<button class="opac_imgbtn" onclick="opacCatdowPopup('',jQuery('#searchformDBL'),'localbiblst','bibdtl','230937384hEweK39H5');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_file_off_.png" title="ファイルに出力" alt="ファイルに出力" />
							</button>
						<button class="opac_imgbtn" onclick="sendMailPopup('',jQuery('#searchformDBL'),'https://www.lib.kansai-u.ac.jp/webopac','localbiblst','bibdtl','false','ja','230937384hEweK39H5','sendmailDBL');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_mail_off_.png" title="メールを送る" alt="メールを送る" />
							</button>
						<button class="opac_iconbtn" onclick="PopUpOpen('',event,'export_popcatdbl',this.form,'true');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_export_off_.png" title="エクスポート" alt="エクスポート" />
							</button>
							<div id="export_popcatdbl" style="display:none;">
								<div class="opac_ttl_big">
									<h2>
										エクスポート先選択</h2>
								</div>
								<div class="opac_block_body_big">
									<p class="opac_description_area">
										エクスポート先を選択してください。</p>
									
									<button class="opac_imgbtn" onclick="sendEndRef('endnote','searchformDBL','https://www.lib.kansai-u.ac.jp/webopac','localbiblst','bib','');PopUpClose();return false;" >
											<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/com/btn_dg_endnote_off_.png" title="EndNote basic" alt="EndNote basic"/>
										</button>
									</div>
								<br/>
								<div class="opac_garnish_link_area">
									<a href="#" onclick="PopUpClose();return false;" class="close_link">
										このウインドウを閉じる</a>
								</div>
							</div>
						</div>
					
				</div>
			</div>
			
			<div class="opac_book_option_area print_none">
				<a href="#catdbl-BB61184090-bib" class="arrow_r">詳細情報を見る</a>
			</div>
			
			<div class="opac_syosi_url_area">
						書誌URL：<input type="text" id="inputPermalink" readonly="true" value="https://www.lib.kansai-u.ac.jp/webopac/BB61184090" /><button class="opac_imgbtn" id="inputPermabotton" onclick="return false;">
							<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_dg_sentaku_55-20.png" title="選択" alt="選択" />
						</button>
					</div>
					<script class="nc_script" type="text/javascript">
					
						function cpy_catdbl_url(){
							var linkid = document.getElementById("inputPermalink");
							linkid.select();
							if(document.all){
								clipboardData.setData('Text', linkid.value);
							}
						}
						
						var button = document.getElementById("inputPermabotton");
						if(button.attachEvent){
							button.attachEvent("onclick",function(){cpy_catdbl_url()});
						}else{
							button.addEventListener("click",function(){cpy_catdbl_url()},true);
						}
						
					</script>
				</td>
	</tr>

	<tr class="h_display print_none">
		<td class="opac_book_img_area">
			<div class="opac_book_img">
				<div id="ajax_imgdtl_area_responsive">
							<script class="nc_script" type="text/javascript">
								var screenwidth = window.innerWidth;
								if(window.attachEvent){
									if(screenwidth <= 810){
										window.attachEvent("onload", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area_responsive","120","0");});
									}else{
										window.attachEvent("onload", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area","120","0");});
									}
								}else{
									if(screenwidth <= 810){
										window.addEventListener("load", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area_responsive","120","0");},true);
									}else{
										window.addEventListener("load", function(){opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area","120","0");},true);
									}
								}
								
								if(screenwidth <= 810){
									opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area_responsive","120","0");
								}else{
									opacImgdtlAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","jpn","","catdbl","ajax_imgdtl_area","120","0");
								}
							</script>
						</div>
					</div>
			</td>
		</tr>
	<tr class="h_display print_none">
		<td width="700px" style="float:left" class="res_summary_area">
			<div class="opac_book_summary_area">
				<img class="opac_icon_bookind" src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/icon_tosyo.png"/>
				<div class="opac_book_title_area_no_photo">
					<h3 class="opac_book_title">
						線形代数 : 大学教養</h3>
					<div class="opac_book_bibliograph">
						数研出版編集部編著. -- 数研出版, 2020. -- (チャート式シリーズ).
						&lt;BB61184090&gt;
					</div>
				
					</div>
			</div>
			
			<div class="opac_book_option_area">
				


































<div class="opac_opebtn_area_narrow opac_round_top opac_round_bottom print_none">
					<span class="opac_label">便利機能：</span>
					<div class="opac_syosisyousai_datas">
						<button class="opac_imgbtn" id="opacSendBkmIconDBL_Responsivecatdbl" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_bookmark_off_.png" title="ブックマーク" alt="ブックマーク" />
							</button>
						<button class="opac_imgbtn" onclick="opacCatdowPopup('',jQuery('#searchformDBL'),'localbiblst','bibdtl','230937384hEweK39H5');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_file_off_.png" title="ファイルに出力" alt="ファイルに出力" />
							</button>
						<button class="opac_imgbtn" onclick="sendMailPopup('',jQuery('#searchformDBL'),'https://www.lib.kansai-u.ac.jp/webopac','localbiblst','bibdtl','false','ja','230937384hEweK39H5','sendmailDBL');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_mail_off_.png" title="メールを送る" alt="メールを送る" />
							</button>
						<button class="opac_iconbtn" onclick="PopUpOpen('',event,'export_popcatdbl',this.form,'true');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
								<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_export_off_.png" title="エクスポート" alt="エクスポート" />
							</button>
							<div id="export_popcatdbl" style="display:none;">
								<div class="opac_ttl_big">
									<h2>
										エクスポート先選択</h2>
								</div>
								<div class="opac_block_body_big">
									<p class="opac_description_area">
										エクスポート先を選択してください。</p>
									
									<button class="opac_imgbtn" onclick="sendEndRef('endnote','searchformDBL','https://www.lib.kansai-u.ac.jp/webopac','localbiblst','bib','');PopUpClose();return false;" >
											<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/com/btn_dg_endnote_off_.png" title="EndNote basic" alt="EndNote basic"/>
										</button>
									</div>
								<br/>
								<div class="opac_garnish_link_area">
									<a href="#" onclick="PopUpClose();return false;" class="close_link">
										このウインドウを閉じる</a>
								</div>
							</div>
						</div>
					
				</div>
			</div>
			
			<div class="opac_book_option_area print_none">
				<a href="#catdbl-BB61184090-bib" class="arrow_r">詳細情報を見る</a>
			</div>
			
			<div class="opac_syosi_url_area">
						書誌URL：<input type="text" id="inputPermalink_responsive" readonly="true" value="https://www.lib.kansai-u.ac.jp/webopac/BB61184090" /><button class="opac_imgbtn" id="inputPermabotton_responsive" onclick="return false;">
							<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_dg_sentaku_55-20.png" title="選択" alt="選択" />
						</button>
					</div>
					<script class="nc_script" type="text/javascript">
					
						function cpy_catdbl_url_reponsive(){
							var linkid = document.getElementById("inputPermalink_responsive");
							linkid.select();
							if(document.all){
								clipboardData.setData('Text', linkid.value);
							}
						}
						
						var button = document.getElementById("inputPermabotton_responsive");
						if(button.attachEvent){
							button.attachEvent("onclick",function(){cpy_catdbl_url_reponsive()});
						}else{
							button.addEventListener("click",function(){cpy_catdbl_url_reponsive()},true);
						}
						
					</script>
				</td>
	</tr>
	</table>
<table class="opac_bookdetail_area">
	<tr>
		<td>
		
		</td>
	</tr>
</table>





















	






	



























<div class="opac_block_middle">
	
	
		
		
	
	
	
		
			
				<input type="hidden" name="pkeyHol" value=""/>
				<input type="hidden" name="stposHol" value="1"/>
				<input type="hidden" name="hitcntHol" value=""/>
				










<style>
	.syozou_tate {
		display: none;
	}
</style>




<!-- 2014/03/10 (ref #1850) -->
<!-- bean:defineによる定義  -->





















	






	




<div class="opac_ttl_middle">
	<h3>
		所蔵一覧
		
			
				<span class="subttl">
					1件～1件（全1件）
				</span>
			
		
	</h3>
</div>



	
	
	
		
		
		
		
		
		
		
		
		
		
	
	
	
	


	
		
		
			
	
			
				
			
		
			
				
					
				
			
		

		
	


		
		
			<input type="hidden" name="fvol_work"/>
			<input type="hidden" name="fannul_work"/>
		
		
		
		
		
		<div class="opac_block_body_middle">


			
				
			

		</div>
		
		<div class="float-left">
			
				
				
					
					
					
				
			
			
			
			<select name="listcntHol" onchange="document.olformcatdbl.fvol.value = document.olformcatdbl.fvol_work.value;
											 	document.olformcatdbl.fannul.value = document.olformcatdbl.fannul_work.value;
											 	document.olformcatdbl.stposHol.value = '1';
											 	document.olformcatdbl.hitcntHol.value = '1';
											 	document.olformcatdbl.initFlg.value = '_RESULT_SET_ATY';
											 	opacCatdbl('','BB61184090','1','1','opac_list_formcatdbl');">
				
					
					
					<option value="10">10件</option>
				
					
					
					<option value="20">20件</option>
				
					
					
					<option value="50">50件</option>
				
					
					
					<option value="100">100件</option>
				
			</select>
			<script class="nc_script" type="text/javascript">
				var form = document.getElementById("opac_list_formcatdbl");
				form.listcntHol.value = "10";
			</script>
		</div>
		
		
		
	
		
			
			
			
				
			<div class="opac_booksyozou_area opac_syozou_info syozou_yoko">
	<br/>
		<font color="red">資料IDが「1」で始まる図書は「学習用」、「0、2、3、4」で始まる図書は「研究用」となります。</font>
	<table>
		<tr>
			<th class="no">No.</th>
			<th class="kango">巻冊次等</th>
			<th class="syozoukan">所蔵館</th>
			<th class="haichiba">配置場所</th>
<th style="width:80px;">和洋区分</th>
<th class="seikyu">請求記号</th>
			<th class="siryoid">資料ID</th>
<th class="jyoutai" style="width:80px;">禁帯出区分</th>
			<th class="jyoutai">本学所蔵本の注記</th>
<th class="jyoutai">状態</th>
			<th class="yoyaku">予約件数</th>
			</tr>
		<tr>
			<td class="no">
0001</td>
			<td class="kango">
			  </td>
			<td>総合図</td>
			<td>
				２Ｆ開架閲覧室</td>
<td>
				和</td>
<td class="seikyu">
				K*411.3*ス</td>
			<td class="siryoid">103972251</td>
<td></td>
<td></td>
			<td class="jyoutai">
				</td>
			<td class="kensu">
				0件<br />
				



























	<button class="opac_imgbtn" id="orderRSV_ButtonBB61184090catdbl0">
		<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_yoyaku.png" title="予約" alt="予約" />
	</button>
	<script class="nc_script" type="text/javascript">
		function orderRSVBB61184090catdbl0(autoFlg){
			var svcrsvform = document.svcrsvformcatdbl;
			
			var bibform = document.getElementById("orderRSV_Formcatdbl");
			var bibbr = bibform.bibbr.value;
			var bibid = bibform.bibid.value;
			var cattp = bibform.cattp.value;
			
			
			  var url = 'https://www.lib.kansai-u.ac.jp/webopac/rsvexm.do';
			  url = url.replace("http:","https:");
			  svcrsvform.action = url;
			  svcrsvform.target = 'Service' + '1737592659054';
			
			
			
			svcrsvform.holid.value='HL11963433';
			svcrsvform.reqType.value='_NEW';
			svcrsvform.bibbr.value=bibbr.replace("/'/g","\\'");
			svcrsvform.bibid.value=bibid;
			svcrsvform.cattp.value=cattp;
			
			
				svcrsvform.loginType.value='once';
			
			
			svcrsvform.method = "post";
			
			
			opacUseFunction('','false',svcrsvform,'orderRSVBB61184090catdbl0','ja',autoFlg);
			return false;
		}
		$('#orderRSV_ButtonBB61184090catdbl0').on('click', function(){
			orderRSVBB61184090catdbl0(false);
			return false;
		});
		
		
			
		
	</script>

</td>
			</tr>
		</table>
</div>

<div class="opac_booksyozou_area opac_syozou_info syozou_tate">
	<br/>
		<font color="red">資料IDが「1」で始まる図書は「学習用」、「0、2、3、4」で始まる図書は「研究用」となります。</font>
	<table>
		<tr>
			</tr>
		
		<tr>
			<th style="background-color:white; border-top-color:white; border-left-color:white; border-right-color:white; height:10px">
			</th>
		</tr>
		<tr>
			<th class="no">No.</th>
			<td class="no">
0001</td>
		</tr>
		<tr>
			<th class="kango">巻冊次等</th>
			<td class="kango">
			  </td>
		</tr>
		<tr>
			<th class="syozoukan">所蔵館</th>
			<td>総合図</td>
		</tr>
		<tr>
			<th class="haichiba">配置場所</th>
			<td>
				２Ｆ開架閲覧室</td>
		</tr>
<tr>
			<th>和洋区分</th>
			<td>和</td>
		</tr>
<tr>
			<th class="seikyu">請求記号</th>
			<td class="seikyu">
				K*411.3*ス</td>
		</tr>
		<tr>
			<th class="siryoid">資料ID</th>
			<td class="siryoid">103972251</td>
		</tr>
<tr>
			<th class="siryoid">禁帯出区分</th>
			<td></td>
</tr>
<tr>
			<th class="siryoid">本学所蔵本の注記</th>
			<td></td>
		</tr>
		<tr>
			<th class="jyoutai">状態</th>
			<td class="jyoutai">
				</td>
		</tr>
<tr>
			<th class="yoyaku">予約件数</th>
			<td class="kensu">
				0件<br />
				



























	<button class="opac_imgbtn" id="orderRSV_Button_RespBB61184090catdbl0">
		<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_yoyaku.png" title="予約" alt="予約" />
	</button>
	<script class="nc_script" type="text/javascript">
		function orderRSVBB61184090catdbl0(autoFlg){
			var svcrsvform = document.svcrsvformcatdbl;
			
			var bibform = document.getElementById("orderRSV_Formcatdbl");
			var bibbr = bibform.bibbr.value;
			var bibid = bibform.bibid.value;
			var cattp = bibform.cattp.value;
			
			
			  var url = 'https://www.lib.kansai-u.ac.jp/webopac/rsvexm.do';
			  url = url.replace("http:","https:");
			  svcrsvform.action = url;
			  svcrsvform.target = 'Service' + '1737592659054';
			
			
			
			svcrsvform.holid.value='HL11963433';
			svcrsvform.reqType.value='_NEW';
			svcrsvform.bibbr.value=bibbr.replace("/'/g","\\'");
			svcrsvform.bibid.value=bibid;
			svcrsvform.cattp.value=cattp;
			
			
				svcrsvform.loginType.value='once';
			
			
			svcrsvform.method = "post";
			
			
			opacUseFunction('','false',svcrsvform,'orderRSVBB61184090catdbl0','ja',autoFlg);
			return false;
		}
		$('#orderRSV_Button_RespBB61184090catdbl0').on('click', function(){
			orderRSVBB61184090catdbl0(false);
			return false;
		});
		
		
	</script>

</td>
			</tr>
		</table>
</div>

		
		
		
		
		
	
	
	
	<script class="nc_script" type="text/javascript">
		var form = document.getElementById("opac_list_formcatdbl");
		if(form.hollist_holar != null){
			if(form.hollist_holar.options != null){
				for(var j = 0 ; j != form.hollist_holar.options.length ; j++){
					if(form.hollist_holar.options[j].value == ""){
						form.hollist_holar.value = "";
						break;
					}
				}
			}
		}
	</script>
	










<div class="opac_pagetop_link_area print_none">
	<a class="arrow_u" href="#catdbl-BB61184090">このページのTOPへ</a>
</div>


			
		
	
	
	
		
	
</div>
<div id="ajax_sessrh_area">
		<script class="nc_script" type="text/javascript">
			var disp_vol = "";
			
				disp_vol = "0";
			
			
			if(window.attachEvent){
				window.attachEvent("onload", function(){opacSessrhAjax("BB61184090",disp_vol,"","ajax_sessrh_area");});
			}else{
				window.addEventListener("load", function(){opacSessrhAjax("BB61184090",disp_vol,"","ajax_sessrh_area");},true);
			}
			opacSessrhAjax("BB61184090",disp_vol,"","ajax_sessrh_area");
		</script>
	</div>
<div id="ajax_sylsrh_area">
	<script class="nc_script" type="text/javascript">
		</script>
</div>
<div id="ajax_ressrh_area">
	<script class="nc_script" type="text/javascript">
		</script>
</div>

<div class="opac_block_middle print_none"  name="mokuji_block" id="mokuji_block">
	<div class="opac_ttl_middle" id="catdbl-BB61184090-cte">
		<h3>
			目次・あらすじ</h3>
	</div>
	
	<div class="opac_block_body_middle">
		<div id="ajax_catcte_area">
			<script class="nc_script" type="text/javascript">
				if(window.attachEvent){
					window.attachEvent("onload", function(){opacCatcteAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","ja","","ajax_catcte_area");});
				}else{
					window.addEventListener("load", function(){opacCatcteAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","ja","","ajax_catcte_area");},true);
				}
				opacCatcteAjax("f6ce318370b8372e46b813b26459b186","eec52e27129d61ea03deb2c1addb23ce","ja","","ajax_catcte_area");
			</script>
		</div>
	</div>
</div>

<div class="opac_pagetop_link_area print_none">
	<a class="arrow_u" href="#catdbl-BB61184090">このページのTOPへ</a>
</div>




















	






	

























	





<div class="opac_block_middle" id="syosi_block">
	
	<div class="opac_ttl_middle" id="catdbl-BB61184090-bib">
		<h3>書誌詳細</h3>
	</div>
	
	<div class="opac_block_body_middle">
		<table class="opac_syosi_list">
			



			
			
			<tr>
				<th valign="top" nowrap="true">
					標題および責任表示
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								線形代数 : 大学教養 / 数研出版編集部編著<br/>センケイ ダイスウ : ダイガク キョウヨウ
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					出版・頒布事項
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								東京 : 数研出版 , 2020.5
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					形態事項
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								447p : 挿図 ; 21cm
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			
			
			
			
			
			
			
			
			
			<tr>
				<th valign="top" nowrap="true">
					巻号情報
				</th>
				<td>
					<table align="left">
						
						
						
						
						<tr>
							<th>ISBN</th>
							<td>9784410154638</td>
						</tr>
						
						
						
						
						
					</table>
				</td>
			</tr>
					
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					書誌構造リンク
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
					
					
						
						
						
						
							<a href="#catdbl-BB60231685" onclick="opacCatdbl('','BB60231685','-1','1',null,null,null,null,'true');">
								チャート式シリーズ||チャートシキ シリーズ &lt;BB60231685&gt;//a
							</a>
					   	
					   	
						
					  	
						
						
						
						
						
						
					   	
					   	
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					その他の標題
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								表紙タイトル:Mathematics
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					その他の標題
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								異なりアクセスタイトル:大学教養線形代数<br/>ダイガク キョウヨウ センケイ ダイスウ
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					注記
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								監修: 加藤文元
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					学情ID
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								BB30523836
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					本文言語コード
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
						
						
							
							
								
								
								
									
								
								日本語
							
						
					
					
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					著者標目リンク
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
					
					
						
						
						
						
					   	
						
							<a href="#catdal-AU00163270" onclick="opacCatdal('','AU00163270','atyFormcatdbl','','23093737vdjgzndo0u');">
								数研出版編集部||スウケン シュッパン ヘンシュウブ &lt;AU00163270&gt;
							</a>
					   	
					  	
						
						
						
						
						
						
					   	
					   	
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					著者標目リンク
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
					
					
						
						
						
						
					   	
						
							<a href="#catdal-AU00016536" onclick="opacCatdal('','AU00016536','atyFormcatdbl','','23093737vdjgzndo0u');">
								加藤, 文元||カトウ, フミハル &lt;AU00016536&gt;
							</a>
					   	
					  	
						
						
						
						
						
						
					   	
					   	
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					分類標目
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
					
					
						
						
						
						
					   	
						
					  	
						
							<a href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
							   onclick="document.opac_field_form.cls.value='NDC8:411.3';
										document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTCLS+_RESULT_SET';">
								代数学 NDC8:411.3
							</a>
					   	
						
						
						
						
						
					   	
					   	
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					分類標目
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
					
					
						
						
						
						
					   	
						
					  	
						
							<a href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
							   onclick="document.opac_field_form.cls.value='NDC9:411.3';
										document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTCLS+_RESULT_SET';">
								代数学 NDC9:411.3
							</a>
					   	
						
						
						
						
						
					   	
					   	
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					分類標目
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
					
					
						
						
						
						
					   	
						
					  	
						
							<a href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
							   onclick="document.opac_field_form.cls.value='NDC10:411.3';
										document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTCLS+_RESULT_SET';">
								代数学 NDC10:411.3
							</a>
					   	
						
						
						
						
						
					   	
					   	
					
				</td>
			</tr>
			
			
			
			



			



			
			
			<tr>
				<th valign="top" nowrap="true">
					件名標目等
				</th>
				<td style="padding:3px 0px 3px 0px;">
					
					
					
					
						
						
						
						
					   	
						
					  	
						
						
						
							<a href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
							   onclick="document.opac_field_form.srhclm1.value='sh';
							   			document.opac_field_form.valclm1.value='線形代数 センケイ ダイスウ';
										document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTSH+_RESULT_SET';">
								線形代数||センケイ ダイスウ
							</a>
					   	
						
						
						
					   	
					   	
					
				</td>
			</tr>
			
			
			
			



			
		</table>
	</div>
	
	







<div class="opac_pagetop_link_area print_none">
	<a class="arrow_u" href="#catdbl-BB61184090">このページのTOPへ</a>
</div>

</div>
</div>
					</div>
					
					<div class="opac_footer_area print_none">
	<div class="opac_highlight_area opac_round_top opac_round_bottom align-center n_display">
		<div class="opac_opebtn_tying">
			<button class="opac_imgbtn" id="opacSendBkmBtnDBLcatdbl" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
					<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_bookmark_off_.png" title="ブックマーク" alt="ブックマーク" />
				</button>
			<button class="opac_imgbtn" onclick="opacCatdowPopup('',jQuery('#searchformDBL'),'localbiblst','bibdtl','230937384hEweK39H5');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
					<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_file_off_.png" title="ファイルに出力" alt="ファイルに出力" />
				</button>
			<button class="opac_imgbtn" onclick="sendMailPopup('',jQuery('#searchformDBL'),'https://www.lib.kansai-u.ac.jp/webopac','localbiblst','bibdtl','false','ja','230937384hEweK39H5','sendmailDBL');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
					<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_mail_off_.png" title="メールを送る" alt="メールを送る" />
				</button>
			<button class="opac_iconbtn" onclick="PopUpOpen('',event,'export_popcatdbl',this.form,'true');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
					<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_export_off_.png" title="エクスポート" alt="エクスポート" />
				</button>
			</div>
	</div>
</div>
<div class="opac_pagechg_area_prevnext print_none">
						<div class="page_prev">
	</div>
	
<div class="page_up">
	<a href="#" onclick="sendOpacReSearch('23093737vdjgzndo0u','true');">
				検索結果一覧へ戻る</a>
		</div>
<div class="page_next">
	</div>
</div>
					
					<div class="opac_footer_area print_none">
				            <div class="opac_footer_btn_area n_display">
								<button class="opac_imgbtn" onclick="openPrintPreview('opac_print_targetcatdbl');return false;" onmouseover="imgChange2On(this)" onmouseout="imgChange2Off(this)">
									<img src="https://www.lib.kansai-u.ac.jp/webopac/image/default/ja/btn_dg_print_off_215-30.png" title="このページを印刷" alt="このページを印刷" />
								</button>
							</div>
						</div>
					<div class="opac_pagetop_link_area print_none">
	<a class="arrow_u" href="#catdbl-BB61184090">このページのTOPへ</a>
</div>
</form>
				
				<form action="#" name="svcrsvformcatdbl">
<input type="hidden" name="bibbr" value=""/>
<input type="hidden" name="bibid" value=""/>
<input type="hidden" name="cattp" value=""/>
<input type="hidden" name="holid" value=""/>
<input type="hidden" name="vol1" value=""/>
<input type="hidden" name="vol2" value=""/>
<input type="hidden" name="holar" value=""/>
<input type="hidden" name="fvol" value=""/>
<input type="hidden" name="annul" value=""/>
<input type="hidden" name="reqType" value=""/>
<input type="hidden" name="loginType" value=""/>
<input type="hidden" name="system" value=""/>
</form>
<form action="#" name="svcalbformcatdbl">
<input type="hidden" name="bibbr" value=""/>
<input type="hidden" name="bibid" value=""/>
<input type="hidden" name="holid" value=""/>
<input type="hidden" name="fvol" value=""/>
<input type="hidden" name="annul" value=""/>
<input type="hidden" name="reqType" value=""/>
<input type="hidden" name="loginType" value=""/>
<input type="hidden" name="system" value=""/>
</form>
<form action="#" name="svcillformcatdbl">
<input type="hidden" name="mode" value=""/>
<input type="hidden" name="srvce" value=""/>
<input type="hidden" name="vlno" value=""/>
<input type="hidden" name="pages" value=""/>
<input type="hidden" name="year" value=""/>
<input type="hidden" name="bvrfy" value=""/>
<input type="hidden" name="hvrfy" value=""/>
<input type="hidden" name="title" value=""/>
<input type="hidden" name="auth" value=""/>
<input type="hidden" name="pub" value=""/>
<input type="hidden" name="bibed" value=""/>
<input type="hidden" name="isbn" value=""/>
<input type="hidden" name="issn" value=""/>
<input type="hidden" name="coden" value=""/>
<input type="hidden" name="artcltitle" value=""/>
<input type="hidden" name="artclauth" value=""/>
<input type="hidden" name="stdno" value=""/>
<input type="hidden" name="note" value=""/>
<input type="hidden" name="budIndex" value=""/>
<input type="hidden" name="bibnt" value=""/>
<input type="hidden" name="bsflg" value=""/>
<input type="hidden" name="bibid" value=""/>
<input type="hidden" name="illbvrfy" value=""/>
<input type="hidden" name="reqType" value=""/>
<input type="hidden" name="loginType" value=""/>
<input type="hidden" name="other" value=""/>
<input type="hidden" name="arg1" value=""/>
<input type="hidden" name="arg2" value=""/>
<input type="hidden" name="arg3" value=""/>
<input type="hidden" name="arg4" value=""/>
<input type="hidden" name="arg5" value=""/>
<input type="hidden" name="system" value=""/>
<input type="hidden" name="lcflg" value=""/>
<input type="hidden" name="acpar" value=""/>
<input type="hidden" name="spvia" value=""/>
<input type="hidden" name="type" value=""/>
<input type="hidden" name="dbTarget" value=""/>
<input type="hidden" name="volType" value=""/>
<input type="hidden" name="volsflg" value=""/>
</form>
<form action="#" name="svcodrformcatdbl">

<input type="hidden" name="mode" value=""/>
<input type="hidden" name="reqType" value=""/>
<input type="hidden" name="ncid" value=""/>
<input type="hidden" name="bibtr" value=""/>
<input type="hidden" name="auth" value=""/>
<input type="hidden" name="isbn" value=""/>
<input type="hidden" name="issn" value=""/>
<input type="hidden" name="coden" value=""/>
<input type="hidden" name="bibbr" value=""/>
<input type="hidden" name="schvl" value=""/>
<input type="hidden" name="bibid" value=""/>
<input type="hidden" name="bibyr" value=""/>
<input type="hidden" name="loginType" value=""/>
<input type="hidden" name="system" value=""/>
<input type="hidden" name="dbTarget" value=""/>
<input type="hidden" name="volType" value=""/>
<input type="hidden" name="volsflg" value=""/>
<input type="hidden" name="bsflg" value=""/>
<input type="hidden" name="bibpb" value=""/>
<input type="hidden" name="bibed" value=""/>
<input type="hidden" name="bibpr" value=""/>

</form><form action="#" id="orderRSV_Formcatdbl">
					<input type="hidden" name="bibbr" value="線形代数 : 大学教養 / 数研出版編集部編著. -- 数研出版, 2020. -- (チャート式シリーズ)."/>
					<input type="hidden" name="bibid" value="BB61184090"/>
					<input type="hidden" name="cattp" value="BB"/>
				</form>
				
				<form action="#" id="orderALB_Formcatdbl">
					<input type="hidden" name="bibbr" value="線形代数 : 大学教養 / 数研出版編集部編著. -- 数研出版, 2020. -- (チャート式シリーズ)."/>
					<input type="hidden" name="bibid" value="BB61184090"/>
				</form>
				
				<form action="#" id="orderEDDS_Formcatdbl">
					<input type="hidden" name="stdno" value="ISBN=9784410154638"/>
					<input type="hidden" name="bibnt" value="線形代数 : 大学教養 / 数研出版編集部編著. -- 数研出版, 2020. -- (チャート式シリーズ)."/>
					<input type="hidden" name="bibid" value="BB61184090"/>
					<input type="hidden" name="isbn_issn" value="9784410154638"/>
				</form>
				
				<form id="SDIAlertFormBB61184090catdbl">
					<input type="hidden" name="bibid" value=""/>
					<input type="hidden" name="togid" value=""/>
					<input type="hidden" name="holsc" value=""/>
					<input type="hidden" name="disp_holar" value=""/>
					<input type="hidden" name="hollc" value=""/>
					<input type="hidden" name="holdno" value=""/>
				</form>
				
				<form id="atyFormcatdbl">
					<input type="hidden" name="fromDsp" value=""/>
					<input type="hidden" name="clstposAtys" value="1"/>
					<input type="hidden" name="hitcntAty" value="1"/>
					<input type="hidden" name="initFlg" value="_SEARCH+_RESULT_SET_NOTATY"/>
					<input type="hidden" name="pkey" value="BB61184090"/>
				</form>
				
				<form name="opac_field_form" action="#">
					<input type="hidden" name="initFlg" value=""/>
					<input type="hidden" name="cls" value=""/>
					<input type="hidden" name="srhclm1" value="words"/>
					<input type="hidden" name="valclm1" value=""/>
					<input type="hidden" name="optclm1" value="AND"/>
				</form>
				
				<form id="searchformDBL">
					<input type="hidden" name="bibid" value="BB61184090"/>
				</form>
				
				<form id="tagformDBL">
					<input type="hidden" name="mode" value=""/>
					<input type="hidden" name="loginType" value=""/>
				</form>
				
				<form id="bkmformDBL">
					<input type="hidden" name="mode" value=""/>
					<input type="hidden" name="loginType" value=""/>
					<input type="hidden" name="screenid" value="catdbl"/>
				</form>
				
				<form name="revexeformcatdbl" method="post" action="https://www.lib.kansai-u.ac.jp/webopac/revexm.do" target="Service">
					<input type="hidden" name="pkey" value="BB61184090"/>
					<input type="hidden" name="pkeyVol" value=''/>
					<input type="hidden" name="pkeyIsbn" value="9784410154638"/>
					<input type="hidden" name="loginType" value="once"/>
					<input type="hidden" name="mode" value="new"/>
				</form>
				
				<form id="revsrhformcatdbl" name="revsrhformcatdbl" action="#">
					<input type="hidden" name="pkey" value="BB61184090"/>
					<input type="hidden" name="pkeyVol" value=''/>
					<input type="hidden" name="pkeyIsbn" value="9784410154638"/>
				</form>

				<script class="nc_script" type="text/javascript">
					
					if(window.attachEvent){
						window.attachEvent("onload",catdblStart);
					}else{
						window.addEventListener("load",catdblStart,true);
					}
					
					function catdblStart(){
						
						opacSingleHit("","BB61184090","230937384hEweK39H5");
						opacSetFormkeyno("","230937384hEweK39H5");
						
						opacSetHash("","#catdbl-BB61184090");
						opacSetFormkeyno("","230937384hEweK39H5");
					}
							
					
						function opacSendBkmDBLcatdbl(){
							var bibform = document.getElementById("bkmformDBL");
					
							
							  var url = 'https://www.lib.kansai-u.ac.jp/webopac/fbmexe.do';
							  url = url.replace("http:","https:");
							  bibform.action = url;
							  bibform.target = 'Service' + '1737592659019';
							
							
							bibform.mode.value='reg';
							
							
								bibform.loginType.value='once';
							
							
							bibform.method = "post";
							
							
							opacSendBibidUse('','false','searchformDBL','bkmformDBL','bkmDBL','ja','bookmark');
							return false;
						}
						
						var screenwidth = window.innerWidth;
						if(screenwidth <= 810){
							document.getElementById("opacSendBkmIconDBL_Responsivecatdbl").onclick = opacSendBkmDBLcatdbl;
						}else{
							document.getElementById("opacSendBkmIconDBLcatdbl").onclick = opacSendBkmDBLcatdbl;
						}
						
						document.getElementById("opacSendBkmBtnDBLcatdbl").onclick = opacSendBkmDBLcatdbl;
					
					
					function editRev(autoFlg){
						opacUseFunction('','false',document.revexeformcatdbl,'revexe','ja',autoFlg);
						return false;
					}
				
				</script>
			</td>
			<td  class="opac_column_right print_none">
				




















	






	





















































	
		
		
			
			
				
				
					
					
				
			
		
	









	
	
		
		
	






	



<input type="checkbox" id="menu-toggle-opt" class="menu-checkbox_opt"/>
	<label for="menu-toggle-opt" class="menu-button_opt button-opt">関連情報<<</label>
		<div class="drawer-menu-opt">
			<ul>
				<li>
					<div class="opac_side_wrapper230">
						<div class="opac_side_ttl">
							<h3>関連情報</h3>
						</div>
						<div class="opac_side_body">
							
							
							
							












	





	<h4>関連資料</h4>
	<div class="opac_block_body_mini">
		<ul id="relation_table">
			
				
				
				<li>
					<a class="arrow_r" href="#" onclick="opacShowRelation('bib','');return false;">
						
						親書誌をみる
					   	
						
						
						
					  	
						
						
						
					</a>
				</li>
				<ul>
					
						
						
						
						
						
						
						
						<li id="bib" style="display:none">
							
							
								<a class="dot" href="#catdbl-BB60231685" onclick="opacCatdbl('','BB60231685','-1','1',null,null,null,null,'true');">
									チャート式シリーズ
								</a>
						   	
						   	
							
						  	
							
							
							
						</li>
					
				</ul>
			
				
				
				<li>
					<a class="arrow_r" href="#" onclick="opacShowRelation('aty','');return false;">
						
						
					   	
						著者からさがす
						
						
					  	
						
						
						
					</a>
				</li>
				<ul>
					
						
						
						
						
						
						
						
						<li id="aty" style="display:none">
							
							
						   	
							
								<a class="dot" href="#catdal-AU00163270" onclick="opacCatdal('','AU00163270','atyFormcatdbl','','23093737vdjgzndo0u');">
									数研出版編集部
								</a>
						   	
						  	
							
							
							
						</li>
					
						
						
						
						
						
						
						
						<li id="aty" style="display:none">
							
							
						   	
							
								<a class="dot" href="#catdal-AU00016536" onclick="opacCatdal('','AU00016536','atyFormcatdbl','','23093737vdjgzndo0u');">
									加藤, 文元
								</a>
						   	
						  	
							
							
							
						</li>
					
				</ul>
			
				
				
				<li>
					<a class="arrow_r" href="#" onclick="opacShowRelation('cls','');return false;">
						
						
					   	
						
						
						
					  	
						分類からさがす
						
						
					</a>
				</li>
				<ul>
					
						
						
						
						
						
						
						
						<li id="cls" style="display:none">
							
							
						   	
							
						  	
							
								<a class="dot" href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
								   onclick="document.opac_field_form.cls.value='NDC8:411.3';
											document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTCLS+_RESULT_SET';">
									代数学 NDC8:411.3
								</a>
						   	
							
							
						</li>
					
						
						
						
						
						
						
						
						<li id="cls" style="display:none">
							
							
						   	
							
						  	
							
								<a class="dot" href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
								   onclick="document.opac_field_form.cls.value='NDC9:411.3';
											document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTCLS+_RESULT_SET';">
									代数学 NDC9:411.3
								</a>
						   	
							
							
						</li>
					
						
						
						
						
						
						
						
						<li id="cls" style="display:none">
							
							
						   	
							
						  	
							
								<a class="dot" href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
								   onclick="document.opac_field_form.cls.value='NDC10:411.3';
											document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTCLS+_RESULT_SET';">
									代数学 NDC10:411.3
								</a>
						   	
							
							
						</li>
					
				</ul>
			
				
				
				<li>
					<a class="arrow_r" href="#" onclick="opacShowRelation('sh','');return false;">
						
						
					   	
						
						
						
					  	
						
						
						件名からさがす
					</a>
				</li>
				<ul>
					
						
						
						
						
						
						
						
						<li id="sh" style="display:none">
							
							
						   	
							
						  	
							
							
							
								<a class="dot" href="JavaScript:sendOpacSearch_Field(document.opac_field_form,'');"
								   onclick="document.opac_field_form.srhclm1.value='sh';
								   			document.opac_field_form.valclm1.value='線形代数 センケイ ダイスウ';
											document.opac_field_form.initFlg.value='_SEARCH_COLUMNS_NOTSH+_RESULT_SET';">
									線形代数
								</a>
						   	
						</li>
					
				</ul>
			
		</ul>
	</div>


							
							
							
























	<div>
		<div id="avollocal_result"></div>
		<script class="nc_script" type="text/javascript">
			//詳細画面へ直接、遷移したときに利用される
			// ブラウザのタイプの判断： IEの場合
			if(document.all) {
				window.attachEvent('onload', function (){setTimeout(opacRelbibAjaxLocal("","BB61184090","avollocal_result"),1000)});
			// IE以外の場合
			}else {
				window.addEventListener('load', function (){setTimeout(opacRelbibAjaxLocal("","BB61184090","avollocal_result"),1000)}, false);
			}
			
			//一覧から遷移したときに利用される
			setTimeout( function(){opacRelbibAjaxLocal("","BB61184090","avollocal_result");} ,1000);
		</script>
	</div>


							
							
							
							
							
							
							
							
							
							
							














	
	
	
	
	
	
		
			
				
			
		
	
		
			
				
			
		
	
		
			
				
			
		
	
		
	
		
			
		
	
		
			
				
			
		
	
		
			
				
			
		
	
		
			
				
			
		
	
		
			
				
			
		
	
		
			
				
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
	
	<h4>他の検索サイトで探す</h4>
	<div class="opac_block_body_mini">
		<ul>
			
	
			
				
				
				
					<li>
	</li>

<form name="opnurlform" method="post" action="/webopac/opnurl.do"><input type="hidden" name="sid" value="" /><input type="hidden" name="id" value="" /><input type="hidden" name="genre" value="book" /><input type="hidden" name="aulast" value="" /><input type="hidden" name="aufirst" value="" /><input type="hidden" name="auinit" value="" /><input type="hidden" name="auinit1" value="" /><input type="hidden" name="ausuffix" value="" /><input type="hidden" name="au" value="数研出版編集部" /><input type="hidden" name="aucorp" value="" /><input type="hidden" name="issn" value="" /><input type="hidden" name="eissn" value="" /><input type="hidden" name="coden" value="" /><input type="hidden" name="isbn" value="" /><input type="hidden" name="sici" value="" /><input type="hidden" name="bici" value="" /><input type="hidden" name="title" value="線形代数 : 大学教養" /><input type="hidden" name="stitle" value="" /><input type="hidden" name="jtitle" value="" /><input type="hidden" name="atitle" value="" /><input type="hidden" name="volume" value="" /><input type="hidden" name="part" value="" /><input type="hidden" name="issue" value="" /><input type="hidden" name="spage" value="" /><input type="hidden" name="epage" value="" /><input type="hidden" name="pages" value="" /><input type="hidden" name="artnum" value="" /><input type="hidden" name="date" value="" /><input type="hidden" name="chron" value="" /><input type="hidden" name="ssn" value="" /><input type="hidden" name="quarter" value="" /><input type="hidden" name="targetURL" value="" /><input type="hidden" name="url_ver" value="" /><input type="hidden" name="url_ctx_fmt" value="" /><input type="hidden" name="rfr_id" value="" /><input type="hidden" name="rft_val_fmt" value="" /><input type="hidden" name="rfr_dat" value="BB61184090" /><input type="hidden" name="btitle" value="" /><input type="hidden" name="edition" value="" /><input type="hidden" name="pub" value="" /><input type="hidden" name="place" value="" /><input type="hidden" name="series" value="" /><input type="hidden" name="tpages" value="" /><input type="hidden" name="stposHol" value="1" /><input type="hidden" name="stposTog" value="1" /><input type="hidden" name="number" value="" /></form>
				
				
				
					
				
			
			
			
			
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
			
			
			
			
		</ul>
	</div>


							
							
							













	





	<h4>各外部機関の蔵書を探す</h4>
	<div class="opac_block_body_mini">
		<ul>
			
				<li><a href="#" onclick="opacSearchNii_Cnd(document.nii_search_form,'','23093737vdjgzndo0u');return false;">他大学(NII)：同一条件検索</a></li>
			
			
				
				<li>
					<a href="JavaScript:opacSearchNii_Id(document.nii_search_form,'');"
						  onclick="document.nii_search_form.ncid.value='BB30523836';">
						他大学(NII)：同一書誌検索
					</a>
				</li>
			
			
		</ul>
	</div>
	<form name="nii_search_form" action="#">
		<input type="hidden" name="srhclm1" value="words"/>
		<input type="hidden" name="valclm1" value=""/>
		<input type="hidden" name="optclm1" value="AND"/>
		<input type="hidden" name="isbn_issn" value=""/>
		<input type="hidden" name="ncid" value=""/>
		<input type="hidden" name="reSrchCondFormkeyno" value=""/>
		<input type="hidden" name="block_id" value=""/>
		<input type="hidden" name="tab_num" value=""/>
		<input type="hidden" name="search_mode" value=""/>
	</form>




					
							
							
								<h4>資料を取り寄せる</h4>
								<div class="opac_block_body_mini">
									<ul>
										
											
















<li>
	<a href="JavaScript:" id="orderICPCopy" onclick="">
		ILL複写依頼(コピー取り寄せ)
	</a>
</li>

<form action="#" name="svcillform" id="svcillform" method="GET" target="_blank">
	<input type="hidden" name="bibnt" value="線形代数 : 大学教養 / 数研出版編集部編著. -- 数研出版, 2020. -- (チャート式シリーズ)."/>
	
		
			
				
			
		
	
</form>

<script class="nc_script" type="text/javascript">
	function orderICPCopy(autoFlg) {
		var svcillform = document.svcillformcatdbl;
		var svcillform2 = document.getElementById("svcillform");
		
		
		svcillform.system.value='1737592659077';
		
		
		  var url = 'https://www.lib.kansai-u.ac.jp/webopac/illexm.do';
		  url = url.replace("http:","https:");
		  svcillform.action = url;
		  svcillform.target = 'Service' + '1737592659066';
		
		
		
		svcillform.srvce.value='C';
		svcillform.mode.value='copy';
		svcillform.reqType.value='_NEW';
		svcillform.spvia.value='';
		svcillform.acpar.value='';
		svcillform.illbvrfy.value='wave';
		svcillform.stdno.value='ISBN=9784410154638';
		svcillform.bibnt.value=svcillform2.bibnt.value;
		svcillform.bsflg.value='B';
		svcillform.bibid.value='BB61184090';
		svcillform.dbTarget.value='LOCAL';
		
		
		
			
		
		//巻号を複数持つ場合(依頼画面で選択)
		
		//巻号を複数持たない場合(依頼画面に引渡す)
		
			svcillform.volsflg.value='false';
			//雑誌の場合はISSNを引渡す
			
			//図書の場合はISBNと巻号等を引渡す
			
				
					
						
						
							svcillform.isbn.value='9784410154638';
						
					
				
			
		
		
		
		svcillform.method = "post";
		
			svcillform.method = "get";
		
		
		opacUseFunction('','false',svcillform,'orderICPCopy','ja',autoFlg);
	}
	$('#orderICPCopy').on('click', function(){
		orderICPCopy(false);
		return false;
	});

	
	
</script>

										
										
									</ul>
								</div>
							
							
							
							























	
	
		
			
				
				
					<h4>購入依頼</h4>
					<div class="opac_block_body_mini">
						<ul>
							<li>
								<a href="JavaScript:" id="orderODRCopy" onclick="">
									追加購入依頼
								</a>
							</li>
						</ul>
					</div>
				
					<form action="#" name="svcodrform" id="svcodrform" method="GET" target="_blank">
						<input type="hidden" name="bibbr" value="線形代数 : 大学教養 / 数研出版編集部編著. -- 数研出版, 2020. -- (チャート式シリーズ)."/>
						
							<input type="hidden" name="bibpb" value="数研出版"/>
						
						
						
							
								
									
								
							
						
					</form>

					<script class="nc_script" type="text/javascript">
					
						function orderODRCopy(autoFlg) {
							var svcodrform = document.svcodrformcatdbl;
							var svcodrform2 = document.getElementById("svcodrform");
							
							
							
							
							  var url = 'https://www.lib.kansai-u.ac.jp/webopac/odrexm.do';
							  url = url.replace("http:","https:");
							  svcodrform.action = url;
							  svcodrform.target = 'Service' + '1737592659066';
							
							
							
							svcodrform.mode.value='copy';
							svcodrform.reqType.value='_NEW';
							svcodrform.dbTarget.value='LOCAL';
							svcodrform.bsflg.value='B';
							
							
								
							
							//巻号を複数持つ場合(依頼画面で選択)
							
							//巻号を複数持たない場合(依頼画面に引渡す)
							
								svcodrform.volsflg.value='false';
								//雑誌の場合はISSNを引渡す
								
								//図書の場合はISBNと巻号等を引渡す
								
									
										
											
											
												svcodrform.isbn.value='9784410154638';
											
										
									
								
							
							svcodrform.bibid.value='BB61184090';
							svcodrform.bibbr.value=svcodrform2.bibbr.value;
							svcodrform.bibtr.value='線形代数 : 大学教養 / 数研出版編集部編著'
							
													
							svcodrform.method = "post";
							
								svcodrform.method = "get";
							
							
							//購入依頼のフォームへ値を引き継ぎ
							
								svcodrform.bibpb.value=svcodrform2.bibpb.value;
							
							
							
								svcodrform.bibyr.value='2020';
							
							
							
							opacUseFunction('','false',svcodrform,'orderODRCopy','ja',autoFlg);
						}
						$('#orderODRCopy').on('click', function(){
							orderODRCopy(false);
							return false;
						});

						
	
					</script>
				
			
		
	


							
							
							
								
									<h4>この書誌のQRコード</h4>
									<div class="opac_block_body_mini">
										<ul>
											<li>
											<img src="https://www.lib.kansai-u.ac.jp/webopac/qrcode.do?bibid=BB61184090" />
											</li>
										</ul>
									</div>
								
							
						</div>
					</div>
		</li>
	</ul>
</div>
<label for="menu-toggle-opt" class="menu-background"></label>
</td>
		</tr>
	</table>
</div>
</div>
		</div>

		










<footer>

	<div class="footer_wrapper">
		<span class="print_none">Copyright c Kansai University Library. All Rights Reserved.(1)</span>
	</div>
</footer>
</body>
</html>